<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[my soul your beats]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://mzeht.com/"/>
  <updated>2016-12-13T10:44:44.000Z</updated>
  <id>http://mzeht.com/</id>
  
  <author>
    <name><![CDATA[mzeht]]></name>
    <email><![CDATA[mzeht@outlook.com]]></email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://mzeht.com/2016/12/13/2016-12-13/"/>
    <id>http://mzeht.com/2016/12/13/2016-12-13/</id>
    <published>2016-12-13T09:32:19.000Z</published>
    <updated>2016-12-13T10:44:44.000Z</updated>
    <content type="html"><![CDATA[<h1 id="ä½¿ç”¨ideaå¼€å‘å¤šæ¨¡å—å¤šgitä»“åº“é¡¹ç›®">ä½¿ç”¨ideaå¼€å‘å¤šæ¨¡å—å¤šgitä»“åº“é¡¹ç›®</h1><h2 id="é¡¹ç›®å‡†å¤‡">é¡¹ç›®å‡†å¤‡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">IntellijProject git clone http://10.50.85.192/mzeht/g-zx-wx.git</div><div class="line">Cloning into &apos;g-zx-wx&apos;...</div><div class="line">remote: Counting objects: 73, done.</div><div class="line">remote: Compressing objects: 100% (58/58), done.</div><div class="line">remote: Total 73 (delta 3), reused 0 (delta 0)</div><div class="line">Unpacking objects: 100% (73/73), done.</div><div class="line">Checking connectivity... done.</div><div class="line">âœ  IntellijProject git clone http://10.50.85.192/mzeht/g-zx-sys.git</div><div class="line">Cloning into &apos;g-zx-sys&apos;...</div><div class="line">remote: Counting objects: 1038, done.</div><div class="line">remote: Compressing objects: 100% (961/961), done.</div><div class="line">remote: Total 1038 (delta 29), reused 1038 (delta 29)</div><div class="line">Receiving objects: 100% (1038/1038), 3.26 MiB | 0 bytes/s, done.</div><div class="line">Resolving deltas: 100% (29/29), done.</div><div class="line">Checking connectivity... done.</div><div class="line">âœ  IntellijProject git clone http://10.50.85.192/mzeht/g-zx-redis.git</div><div class="line">Cloning into &apos;g-zx-redis&apos;...</div><div class="line">remote: Counting objects: 164, done.</div><div class="line">remote: Compressing objects: 100% (132/132), done.</div><div class="line">remote: Total 164 (delta 3), reused 164 (delta 3)</div><div class="line">Receiving objects: 100% (164/164), 116.70 KiB | 0 bytes/s, done.</div><div class="line">Resolving deltas: 100% (3/3), done.</div><div class="line">Checking connectivity... done.</div><div class="line">âœ  IntellijProject git clone http://10.50.85.192/mzeht/g-zx-company.git</div><div class="line">Cloning into &apos;g-zx-company&apos;...</div><div class="line">remote: Counting objects: 251, done.</div><div class="line">remote: Compressing objects: 100% (163/163), done.</div><div class="line">remote: Total 251 (delta 56), reused 251 (delta 56)</div><div class="line">Receiving objects: 100% (251/251), 231.52 KiB | 0 bytes/s, done.</div><div class="line">Resolving deltas: 100% (56/56), done.</div><div class="line">Checking connectivity... done.</div><div class="line">âœ  IntellijProject git clone http://10.50.85.192/mzeht/g-zx-business.git</div><div class="line">Cloning into &apos;g-zx-business&apos;...</div><div class="line">remote: Counting objects: 937, done.</div><div class="line">remote: Compressing objects: 100% (795/795), done.</div><div class="line">remote: Total 937 (delta 128), reused 937 (delta 128)</div><div class="line">Receiving objects: 100% (937/937), 1011.47 KiB | 0 bytes/s, done.</div><div class="line">Resolving deltas: 100% (128/128), done.</div><div class="line">Checking connectivity... done.</div><div class="line">âœ  IntellijProject git clone http://10.50.85.192/mzeht/g-rm-web-v1.0.git</div><div class="line">Cloning into &apos;g-rm-web-v1.0&apos;...</div><div class="line">remote: Counting objects: 4117, done.</div><div class="line">remote: Compressing objects: 100% (3072/3072), done.</div><div class="line">remote: Total 4117 (delta 621), reused 4117 (delta 621)</div><div class="line">Receiving objects: 100% (4117/4117), 47.41 MiB | 7.30 MiB/s, done.</div><div class="line">Resolving deltas: 100% (621/621), done.</div><div class="line">Checking connectivity... done.</div><div class="line">Checking out files: 100% (8698/8698), done.</div></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="ä½¿ç”¨ideaå¼€å‘å¤šæ¨¡å—å¤šgitä»“åº“é¡¹ç›®">ä½¿ç”¨ideaå¼€å‘å¤šæ¨¡å—å¤šgitä»“åº“é¡¹ç›®</h1><h2 id="é¡¹ç›®å‡†å¤‡">é¡¹ç›®å‡†å¤‡</h2><figure class="highlight plain"><table><tr><td class="gutter"><p]]>
    </summary>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://mzeht.com/2016/12/07/2016-12-07/"/>
    <id>http://mzeht.com/2016/12/07/2016-12-07/</id>
    <published>2016-12-07T01:49:14.000Z</published>
    <updated>2016-12-07T01:53:10.000Z</updated>
    <content type="html"><![CDATA[<h1 id="commonapi">commonapi</h1><h2 id="è¿è¡Œæ–¹æ³•">è¿è¡Œæ–¹æ³•</h2><p>1.é¡¹ç›®æ ¹ç›®å½•ä¸‹<br>mvn clean &amp;&amp; mvn package -Dmaven.test.skip<br>targetç›®å½•ä¸‹ç”Ÿæˆupg-credit-common-1.0.jar<br>2.æ‰§è¡Œupg-credit-common-1.0.jar<br>java -jar upg-credit-common-1.0.jar</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="commonapi">commonapi</h1><h2 id="è¿è¡Œæ–¹æ³•">è¿è¡Œæ–¹æ³•</h2><p>1.é¡¹ç›®æ ¹ç›®å½•ä¸‹<br>mvn clean &amp;&amp; mvn package -Dmaven.test.skip<br>targetç›®å½•ä¸‹ç”Ÿæˆupg-]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[Macä¸‹çš„æ•´å¥—ç¿»å¢™æ–¹æ¡ˆ]]></title>
    <link href="http://mzeht.com/2016/10/12/12.01mac%E4%B8%8B%E7%9A%84%E7%BF%BB%E5%A2%99%E6%96%B9%E6%A1%88/"/>
    <id>http://mzeht.com/2016/10/12/12.01macä¸‹çš„ç¿»å¢™æ–¹æ¡ˆ/</id>
    <published>2016-10-12T14:20:33.000Z</published>
    <updated>2016-12-25T12:02:32.000Z</updated>
    <content type="html"><![CDATA[<p>æœ€è¿‘brewå‡çº§ç½‘ç»œé€Ÿåº¦å¾ˆæ…¢ï¼ŒåŠ ä¸ŠMacosç³»ç»Ÿç‰ˆæœ¬çš„å˜åŒ–ï¼Œå‡çº§çš„å˜åŒ–ä¹Ÿè¾ƒå¤§ï¼Œï¼ˆæƒé™å˜åŒ–ï¼Œéœ€è¦ç”¨åˆ°brewçš„å»ºè®®å°½å¿«å‡çº§ï¼‰æ‰§è¡Œbrew updateè€åŠå¤©è¿˜å¤±è´¥ï¼Œäºæ˜¯å¯»æ‰¾å‘½ä»¤è¡Œç¿»å¢™çš„è§£å†³æ–¹æ³•ï¼ŒæœŸé—´å°è¯•äº†proxychainsï¼Œæ•ˆæœä¸å¥½ï¼Œ<code>æˆ‘å’ŒåŒå­¦osä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œä»–å¯ä»¥ï¼Œæˆ‘çš„ä¸è¡Œ</code>ï¼Œäºæ˜¯æ‰¾åˆ«çš„è§£å†³æ–¹æ³•</p>
<a id="more"></a>
<h1 id="åŸºæœ¬å‡†å¤‡">åŸºæœ¬å‡†å¤‡</h1><p>å¯ç”¨çš„shawdowsocksè´¦å·ï¼Œå›¾çœäº‹å„¿ï¼Œæˆ‘è‡ªå·±ç”¨çš„æ˜¯ä»˜è´¹çš„ï¼Œæˆ‘çš„æ¨èé“¾æ¥<a href="https://portal.shadowsocks.com/clientarea.php?action=products" target="_blank" rel="external">ç‚¹å‡»è¿™é‡Œ</a>ï¼Œè¿™æ ·å¯ä»¥å¥–åŠ±æˆ‘å‡ å—é’±ï¼Œ<code>ä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œæˆ‘åˆä¸ä¼šå»çœŸçš„å–å‡ºæ¥ã€‚ã€‚ã€‚</code><br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-12-25/60755449-file_1482665290388_14ddb.png" alt=""><br>ç‚¹å‡»ç»¿è‰²æŒ‰é’®ï¼Œå°±ä¼šçœ‹åˆ°ç»™ä½ çš„ä»£ç†ä¿¡æ¯</p>
<h1 id="å®‰è£…è½¯ä»¶">å®‰è£…è½¯ä»¶</h1><p>ä¸Šé¢ç½‘å€ä¸‹è½½èµ„æºæœ‰ssçš„macå®¢æˆ·ç«¯ï¼Œä½†æ˜¯ä¸èƒ½å¼€å¯httpä»£ç†ï¼ŒåŠŸèƒ½ä¸å¤Ÿå¼ºå¤§ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>Shadowsocks-NG</code>å®¢æˆ·ç«¯ï¼Œæ˜¯å®ƒçš„å¢å¼ºç‰ˆï¼Œ<br><a href="https://github.com/shadowsocks/ShadowsocksX-NG" target="_blank" rel="external">é¡¹ç›®githubåœ°å€</a><br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-12-25/70231903-file_1482665629085_119e8.png" alt=""><br>å¯ä»¥çœ‹åˆ°å®Œå…¨æ»¡è¶³è¾ƒæ–°Macæ“ä½œç³»ç»Ÿçš„è¦æ±‚ï¼Œä¸‹è½½ä¹‹åå®‰è£…</p>
<h1 id="è®¾ç½®è½¯ä»¶">è®¾ç½®è½¯ä»¶</h1><p>å®‰è£…å¥½çš„è½¯ä»¶ä¸Šæœ‰æ‰«æå±å¹•ä¸ŠäºŒç»´ç çš„åŠŸèƒ½ï¼Œé€ä¸€ç‚¹å¼€ç½‘ç«™çš„ä»£ç†äºŒç»´ç ä¿¡æ¯ï¼Œå®Œæˆå¯¼å…¥<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-12-25/61623448-file_1482665836110_12398.png" alt=""></p>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”äºä¸€èˆ¬çš„sså®¢æˆ·ç«¯ï¼Œæ­¤ç‰ˆæœ¬ä»£ç†ç«¯å£æœ‰å˜åŒ–ï¼Œé»˜è®¤1086</p>
</blockquote>
<h1 id="æµè§ˆå™¨ç«¯é…ç½®">æµè§ˆå™¨ç«¯é…ç½®</h1><p>googleæµè§ˆå™¨é…åˆæ’ä»¶SwitchyOmega<br>æ’ä»¶è®¾ç½®ä»£ç†åè®®ï¼Œåœ°å€ï¼Œç«¯å£ï¼Œä»¥åŠä¸ä»£ç†æœ¬åœ°çš„å¸¸ç”¨localhost</p>
<blockquote>
<p>æ³¨æ„ç«¯å£å’Œsså®¢æˆ·ç«¯ä¿æŒä¸€è‡´</p>
</blockquote>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-12-25/83024472-file_1482666059530_14152.png" alt=""></p>
<p>æ—¥å¸¸ä½¿ç”¨é€‰æ‹©æ¨¡å¼ auto switch<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-12-25/64770784-file_1482666144537_5bdf.png" alt=""></p>
<h1 id="å‘½ä»¤è¡Œé…ç½®">å‘½ä»¤è¡Œé…ç½®</h1><p>ç”±äºæ­¤å®¢æˆ·ç«¯é…ç½®äº†httpä»£ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ä¹Ÿå¾ˆæ–¹ä¾¿</p>
<p>é…ç½®ä¸€ä¸ªåˆ«åæ–¹ä¾¿å¯åŠ¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vim ~/.bash_profile</div></pre></td></tr></table></figure>
<p>æ·»åŠ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># Custom Add not System</div><div class="line">alias proxy-on=&apos;export http_proxy=127.0.0.1:1087;export https_proxy=$http_proxy&apos;</div><div class="line">alias proxy-off=&apos;unset http_proxy;unset https_proxy&apos;</div></pre></td></tr></table></figure>
<p>è¿™æ ·åœ¨å‘½ä»¤è¡Œä¸­å°±å¯ä»¥é€šè¿‡proxy-onï¼Œproxy-offæ¥å¯¹éœ€è¦ç¿»å¢™çš„æ“ä½œæä¾›ä»£ç†</p>
<p>ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">âœ  ~ proxy-on</div><div class="line">âœ  ~ brew install ffmpeg</div><div class="line">Updating Homebrew...</div><div class="line">==&gt; Auto-updated Homebrew!</div><div class="line">Updated 1 tap (homebrew/core).</div><div class="line">==&gt; Updated Formulae</div><div class="line">proxychains-ng âœ”           rmlint                     vnstat</div><div class="line">ranger                     ruby-install</div><div class="line"></div><div class="line">==&gt; Installing dependencies for ffmpeg: lame, x264, xvid</div><div class="line">==&gt; Installing ffmpeg dependency: lame</div><div class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/lame-3.99.5.sierra.bottle.1</div><div class="line">######################################################################## 100.0%</div><div class="line">==&gt; Pouring lame-3.99.5.sierra.bottle.1.tar.gz</div><div class="line">ğŸº  /usr/local/Cellar/lame/3.99.5: 26 files, 2M</div><div class="line">==&gt; Installing ffmpeg dependency: x264</div><div class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/x264-r2728.sierra.bottle.ta</div><div class="line">######################################################################## 100.0%</div><div class="line">==&gt; Pouring x264-r2728.sierra.bottle.tar.gz</div><div class="line">ğŸº  /usr/local/Cellar/x264/r2728: 11 files, 3.3M</div><div class="line">==&gt; Installing ffmpeg dependency: xvid</div><div class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/xvid-1.3.4.sierra.bottle.ta</div><div class="line">######################################################################## 100.0%</div><div class="line">==&gt; Pouring xvid-1.3.4.sierra.bottle.tar.gz</div><div class="line">ğŸº  /usr/local/Cellar/xvid/1.3.4: 9 files, 1.2M</div><div class="line">==&gt; Installing ffmpeg</div><div class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/ffmpeg-3.2.2.sierra.bottle.</div><div class="line">######################################################################## 100.0%</div><div class="line">==&gt; Pouring ffmpeg-3.2.2.sierra.bottle.tar.gz</div><div class="line">ğŸº  /usr/local/Cellar/ffmpeg/3.2.2: 239 files, 50.4M</div><div class="line">âœ  ~ youtube-dl https://www.youtube.com/watch\?v\=n98cGaLi6sQ</div><div class="line">[youtube] n98cGaLi6sQ: Downloading webpage</div><div class="line">[youtube] n98cGaLi6sQ: Downloading video info webpage</div><div class="line">[youtube] n98cGaLi6sQ: Extracting video information</div><div class="line">[youtube] n98cGaLi6sQ: Downloading MPD manifest</div><div class="line">[dashsegments] Total fragments: 55</div><div class="line">[download] Destination: ã€è€³æ©Ÿæ™‚ä»£ã€‘3Dç’°éŸ³ã€ŒSTYX HELIXã€MYTH&amp;ROID æˆ´ä¸Šè€³æ©Ÿ é€²å…¥ä¸ä¸€æ¨£çš„éŸ³æ¨‚ä¸–ç•Œï¼-n98cGaLi6sQ.f136.mp4</div><div class="line">[download] 100% of 29.54MiB in 03:03</div><div class="line">[dashsegments] Total fragments: 30</div><div class="line">[download] Destination: ã€è€³æ©Ÿæ™‚ä»£ã€‘3Dç’°éŸ³ã€ŒSTYX HELIXã€MYTH&amp;ROID æˆ´ä¸Šè€³æ©Ÿ é€²å…¥ä¸ä¸€æ¨£çš„éŸ³æ¨‚ä¸–ç•Œï¼-n98cGaLi6sQ.f140.m4a</div><div class="line">[download] 100% of 4.32MiB in 01:12</div><div class="line">[ffmpeg] Merging formats into &quot;ã€è€³æ©Ÿæ™‚ä»£ã€‘3Dç’°éŸ³ã€ŒSTYX HELIXã€MYTH&amp;ROID æˆ´ä¸Šè€³æ©Ÿ é€²å…¥ä¸ä¸€æ¨£çš„éŸ³æ¨‚ä¸–ç•Œï¼-n98cGaLi6sQ.mp4&quot;</div><div class="line">Deleting original file ã€è€³æ©Ÿæ™‚ä»£ã€‘3Dç’°éŸ³ã€ŒSTYX HELIXã€MYTH&amp;ROID æˆ´ä¸Šè€³æ©Ÿ é€²å…¥ä¸ä¸€æ¨£çš„éŸ³æ¨‚ä¸–ç•Œï¼-n98cGaLi6sQ.f136.mp4 (pass -k to keep)</div><div class="line">Deleting original file ã€è€³æ©Ÿæ™‚ä»£ã€‘3Dç’°éŸ³ã€ŒSTYX HELIXã€MYTH&amp;ROID æˆ´ä¸Šè€³æ©Ÿ é€²å…¥ä¸ä¸€æ¨£çš„éŸ³æ¨‚ä¸–ç•Œï¼-n98cGaLi6sQ.f140.m4a (pass -k to keep)</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä»£ç†ï¼Œæ›´æ–°brewï¼Œå®‰è£…ffmpegï¼Œç»™youtubeâ€”dlæ·»åŠ ä»£ç† ä»youtubeä¸Šä¸‹è½½äº†ä¸€ä¸ªmv</p>
<hr>
<p>ç›¸å…³é“¾æ¥ï¼š</p>
<ol>
<li><a href="http://www.tuicool.com/articles/zuQziir" target="_blank" rel="external">http://www.tuicool.com/articles/zuQziir</a></li>
<li><a href="https://portal.shadowsocks.com/clientarea.php?action=products" target="_blank" rel="external">https://portal.shadowsocks.com/clientarea.php?action=products</a></li>
<li><a href="https://github.com/shadowsocks/ShadowsocksX-NG" target="_blank" rel="external">https://github.com/shadowsocks/ShadowsocksX-NG</a></li>
<li><a href="https://aiguge.xyz/shadowsocksx-ng/" target="_blank" rel="external">https://aiguge.xyz/shadowsocksx-ng/</a></li>
<li>chrome-extension://padekgcemlokbadohgkifijomclgjgif/options.html#/profile/proxy</li>
</ol>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ€è¿‘brewå‡çº§ç½‘ç»œé€Ÿåº¦å¾ˆæ…¢ï¼ŒåŠ ä¸ŠMacosç³»ç»Ÿç‰ˆæœ¬çš„å˜åŒ–ï¼Œå‡çº§çš„å˜åŒ–ä¹Ÿè¾ƒå¤§ï¼Œï¼ˆæƒé™å˜åŒ–ï¼Œéœ€è¦ç”¨åˆ°brewçš„å»ºè®®å°½å¿«å‡çº§ï¼‰æ‰§è¡Œbrew updateè€åŠå¤©è¿˜å¤±è´¥ï¼Œäºæ˜¯å¯»æ‰¾å‘½ä»¤è¡Œç¿»å¢™çš„è§£å†³æ–¹æ³•ï¼ŒæœŸé—´å°è¯•äº†proxychainsï¼Œæ•ˆæœä¸å¥½ï¼Œ<code>æˆ‘å’ŒåŒå­¦osä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œä»–å¯ä»¥ï¼Œæˆ‘çš„ä¸è¡Œ</code>ï¼Œäºæ˜¯æ‰¾åˆ«çš„è§£å†³æ–¹æ³•</p>]]>
    
    </summary>
    
      <category term="Mac" scheme="http://mzeht.com/tags/Mac/"/>
    
      <category term="ç¿»å¢™" scheme="http://mzeht.com/tags/%E7%BF%BB%E5%A2%99/"/>
    
      <category term="å·¥å…·" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="å…¶ä»–" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android Scrollåˆ†æ]]></title>
    <link href="http://mzeht.com/2016/10/12/Android%20Scroll%E5%88%86%E6%9E%90/"/>
    <id>http://mzeht.com/2016/10/12/Android Scrollåˆ†æ/</id>
    <published>2016-10-12T14:20:33.000Z</published>
    <updated>2016-12-25T11:22:48.000Z</updated>
    <content type="html"><![CDATA[<h1 id="æ»‘åŠ¨æ•ˆæœçš„äº§ç”Ÿ">æ»‘åŠ¨æ•ˆæœçš„äº§ç”Ÿ</h1><p>æ»‘åŠ¨çš„æœ¬è´¨æ˜¯ç§»åŠ¨Viewï¼Œé€šè¿‡ä¸æ–­æ”¹å˜Viewçš„åæ ‡å®ç°ï¼Œä¸åŠ¨ç”»çš„åŸç†ç±»ä¼¼ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯æ»‘åŠ¨ï¼Œå°±éœ€è¦ç›‘å¬å„ç§ç‚¹å‡»ï¼Œè§¦æ‘¸äº‹ä»¶</p>
<a id="more"></a>
<h2 id="Androidåæ ‡ç³»">Androidåæ ‡ç³»</h2><p>Androidåæ ‡ç³»ä»¥å±å¹•å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼Œå¦‚å›¾<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-22/68901668.jpg" alt=""></p>
<h2 id="è§†å›¾åæ ‡ç³»">è§†å›¾åæ ‡ç³»</h2><p>å­è§†å›¾ä»¥çˆ¶è§†å›¾å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œå¦‚å›¾<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-23/13206722.jpg" alt=""><br>è§¦æ§äº‹ä»¶ä¸­ï¼Œé€šè¿‡getX(),getY()è·å¾—çš„åæ ‡å°±æ˜¯è§†å›¾ä¸­çš„åæ ‡ç³»</p>
<h2 id="è§¦æ§äº‹ä»¶">è§¦æ§äº‹ä»¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">//å•ç‚¹è§¦æ‘¸æŒ‰ä¸‹åŠ¨ä½œ</div><div class="line">   public static final int ACTION_DOWN             = 0;</div><div class="line">   </div><div class="line">   //å•ç‚¹è§¦æ‘¸ç¦»å¼€åŠ¨ä½œ</div><div class="line">   public static final int ACTION_UP               = 1;</div><div class="line">   </div><div class="line">  //è§¦æ‘¸ç‚¹ç§»åŠ¨åŠ¨ä½œ</div><div class="line">   public static final int ACTION_MOVE             = 2;</div><div class="line">   </div><div class="line">  //è§¦æ‘¸åŠ¨ä½œå–æ¶ˆ</div><div class="line">   public static final int ACTION_CANCEL           = 3;</div><div class="line">   </div><div class="line">  //è§¦æ‘¸åŠ¨ä½œè¶…å‡ºè¾¹ç•Œ</div><div class="line">   public static final int ACTION_OUTSIDE          = 4;</div><div class="line"></div><div class="line">   //å¤šç‚¹è§¦æ‘¸æŒ‰ä¸‹åŠ¨ä½œ</div><div class="line">   public static final int ACTION_POINTER_DOWN     = 5;</div><div class="line">   </div><div class="line">   //å¤šç‚¹ç¦»å¼€åŠ¨ä½œ</div><div class="line">   public static final int ACTION_POINTER_UP       = 6;</div><div class="line"></div><div class="line">   public static final int ACTION_HOVER_MOVE       = 7;</div><div class="line"></div><div class="line">   </div><div class="line">   public static final int ACTION_SCROLL           = 8;</div><div class="line"></div><div class="line">  </div><div class="line">   public static final int ACTION_HOVER_ENTER      = 9;</div><div class="line"></div><div class="line">  </div><div class="line">   public static final int ACTION_HOVER_EXIT       = 10;</div><div class="line"></div><div class="line"></div><div class="line">   public static final int ACTION_BUTTON_PRESS   = 11;</div><div class="line"></div><div class="line">  </div><div class="line">   public static final int ACTION_BUTTON_RELEASE  = 12;</div></pre></td></tr></table></figure>
<p>ä¸€èˆ¬åœ¨Viewçš„onTouchEventæ–¹æ³•ä¸­å¯¹event.getAction()è¿›è¡Œç­›é€‰æ§åˆ¶ï¼Œï¼ˆä¸æ¶‰åŠå¤šç‚¹è§¦æ§çš„æƒ…å†µä¸‹ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">@Override</div><div class="line">public boolean onTouchEvent(MotionEvent event) &#123;</div><div class="line">    int x = (int) event.getX();</div><div class="line">    int y = (int) event.getY();</div><div class="line">    switch (event.getAction()) &#123;</div><div class="line">        case MotionEvent.ACTION_DOWN:</div><div class="line">            lastX = (int) event.getX();</div><div class="line">            lastY = (int) event.getY();</div><div class="line">            break;</div><div class="line">        case MotionEvent.ACTION_MOVE:</div><div class="line">            int offsetX = x - lastX;</div><div class="line">            int offsetY = y - lastY;</div><div class="line">            ((View) getParent()).scrollBy(-offsetX, -offsetY);</div><div class="line">            break;</div><div class="line">        case MotionEvent.ACTION_UP:</div><div class="line">            // æ‰‹æŒ‡ç¦»å¼€æ—¶ï¼Œæ‰§è¡Œæ»‘åŠ¨è¿‡ç¨‹</div><div class="line">            View viewGroup = ((View) getParent());</div><div class="line">            mScroller.startScroll(</div><div class="line">                    viewGroup.getScrollX(),</div><div class="line">                    viewGroup.getScrollY(),</div><div class="line">                    -viewGroup.getScrollX(),</div><div class="line">                    -viewGroup.getScrollY());</div><div class="line">            invalidate();</div><div class="line">            break;</div><div class="line">    &#125;</div><div class="line">    return true;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç³»ç»Ÿæä¾›äº†å¾ˆå¤šè·å–åæ ‡å€¼ï¼Œç›¸å¯¹è·ç¦»çš„åæ ‡å€¼çš„æ–¹æ³•ï¼Œå¦‚å›¾<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-23/82371833.jpg" alt=""></p>
<p>å¤§æ¦‚åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<hr>
<p>Viewæä¾›çš„è·å–åæ ‡çš„æ–¹æ³•<br>getTop(): è·å–åˆ°Viewè‡ªèº«é¡¶è¾¹åˆ°å…¶çˆ¶å¸ƒå±€é¡¶éƒ¨çš„è·ç¦»<br>getLeft() : è·å–åˆ°Viewè‡ªèº«å·¦è¾¹åˆ°å…¶çˆ¶å¸ƒå±€å·¦è¾¹çš„è·ç¦»<br>getRight():<br>getBottom();</p>
<hr>
<p>MotionEventæä¾›çš„æ–¹æ³•<br>getX():    è·å–ç‚¹å‡»äº‹ä»¶è·ç¦»æ§ä»¶å·¦è¾¹çš„è·ç¦»ï¼Œå³è§†å›¾åæ ‡<br>getY():è·å–ç‚¹å‡»äº‹ä»¶è·ç¦»æ§ä»¶é¡¶éƒ¨çš„è·ç¦»ï¼Œå³è§†å›¾åæ ‡<br>getRawX():è·å–ç‚¹å‡»äº‹ä»¶è·ç¦»æ•´ä¸ªå±å¹•å·¦è¾¹çš„è·ç¦»ï¼Œå³ç»å¯¹åæ ‡<br>getRawY():â€¦.</p>
<h1 id="å®ç°æ»‘åŠ¨çš„ä¸ƒç§æ–¹æ³•">å®ç°æ»‘åŠ¨çš„ä¸ƒç§æ–¹æ³•</h1><h2 id="layoutæ–¹æ³•">layoutæ–¹æ³•</h2>]]></content>
    <summary type="html">
    <![CDATA[<h1 id="æ»‘åŠ¨æ•ˆæœçš„äº§ç”Ÿ">æ»‘åŠ¨æ•ˆæœçš„äº§ç”Ÿ</h1><p>æ»‘åŠ¨çš„æœ¬è´¨æ˜¯ç§»åŠ¨Viewï¼Œé€šè¿‡ä¸æ–­æ”¹å˜Viewçš„åæ ‡å®ç°ï¼Œä¸åŠ¨ç”»çš„åŸç†ç±»ä¼¼ï¼Œä¸è¿‡æ—¢ç„¶æ˜¯æ»‘åŠ¨ï¼Œå°±éœ€è¦ç›‘å¬å„ç§ç‚¹å‡»ï¼Œè§¦æ‘¸äº‹ä»¶</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://mzeht.com/tags/Android/"/>
    
      <category term="Scroll" scheme="http://mzeht.com/tags/Scroll/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="AndroidHero" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/AndroidHero/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ListViewä½¿ç”¨æŠ€å·§]]></title>
    <link href="http://mzeht.com/2016/10/10/ListView%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    <id>http://mzeht.com/2016/10/10/ListViewä½¿ç”¨æŠ€å·§/</id>
    <published>2016-10-10T14:20:33.000Z</published>
    <updated>2016-12-25T11:22:43.000Z</updated>
    <content type="html"><![CDATA[<p>æœ¬æ¥æƒ³è·³è¿‡çš„ï¼Œçœ‹äº†ä¸‹ä¹¦ï¼Œå®åœ¨æ˜¯å¤ªç†Ÿæ‚‰äº†ï¼Œå¾…åŠï¼Œå…ˆå ä¸ªå‘<br><a id="more"></a></p>
<h1 id="å¸¸ç”¨ä¼˜åŒ–æŠ€å·§">å¸¸ç”¨ä¼˜åŒ–æŠ€å·§</h1><h2 id="ä½¿ç”¨ViewHolder">ä½¿ç”¨ViewHolder</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">public class NotifyAdapter extends BaseAdapter &#123;</div><div class="line"></div><div class="line">    private List&lt;String&gt; mData;</div><div class="line">    private LayoutInflater mInflater;</div><div class="line"></div><div class="line">    public NotifyAdapter(Context context, List&lt;String&gt; data) &#123;</div><div class="line">        this.mData = data;</div><div class="line">        mInflater = LayoutInflater.from(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public int getCount() &#123;</div><div class="line">        return mData.size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public Object getItem(int position) &#123;</div><div class="line">        return mData.get(position);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public long getItemId(int position) &#123;</div><div class="line">        return position;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public View getView(int position, View convertView, ViewGroup parent) &#123;</div><div class="line">        ViewHolder holder = null;</div><div class="line">        // åˆ¤æ–­æ˜¯å¦ç¼“å­˜</div><div class="line">        if (convertView == null) &#123;</div><div class="line">            holder = new ViewHolder();</div><div class="line">            // é€šè¿‡LayoutInflaterå®ä¾‹åŒ–å¸ƒå±€</div><div class="line">            convertView = mInflater.inflate(R.layout.notify_item, null);</div><div class="line">            holder.img = (ImageView) convertView.findViewById(R.id.imageView);</div><div class="line">            holder.title = (TextView) convertView.findViewById(R.id.textView);</div><div class="line">            convertView.setTag(holder);</div><div class="line">        &#125; else &#123;</div><div class="line">            // é€šè¿‡tagæ‰¾åˆ°ç¼“å­˜çš„å¸ƒå±€</div><div class="line">            holder = (ViewHolder) convertView.getTag();</div><div class="line">        &#125;</div><div class="line">        // è®¾ç½®å¸ƒå±€ä¸­æ§ä»¶è¦æ˜¾ç¤ºçš„è§†å›¾</div><div class="line">        holder.img.setBackgroundResource(R.mipmap.ic_launcher);</div><div class="line">        holder.title.setText(mData.get(position));</div><div class="line">        return convertView;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public final class ViewHolder &#123;</div><div class="line">        public ImageView img;</div><div class="line">        public TextView title;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="UIè®¾ç½®">UIè®¾ç½®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//åˆ†å‰²çº¿</div><div class="line">android:divider=&quot;@android:color/darker_gray&quot;</div><div class="line">android:dividerHeight=&quot;10dp&quot;</div><div class="line">//è®¾ç½®ä¸ºé€æ˜</div><div class="line">android:divider=&quot;@null&quot;</div><div class="line">//å–æ¶ˆæ»šåŠ¨æ¡</div><div class="line">android:scrollbars=&quot;none&quot;</div><div class="line">å–æ¶ˆitemç‚¹å‡»æ•ˆæœ</div><div class="line">android:listSelector=&quot;@android:color/transparent&quot;</div></pre></td></tr></table></figure>
<h2 id="è®¾ç½®éœ€è¦æ˜¾ç¤ºçš„Item">è®¾ç½®éœ€è¦æ˜¾ç¤ºçš„Item</h2><hr>
<p>ç¬¬å‡ é¡¹ç½®é¡¶æ˜¾ç¤º<br>ListView.setSelection(n);<br>//ç‰¹æ®Šç”¨æ³•,æ˜¾ç¤ºå‡ºæ•°æ®çš„æœ€åä¸€é¡¹<br> mListView.setSelection(mData.size() - 1);<br> <a href="http://blog.csdn.net/szyangzhen/article/details/47972509" target="_blank" rel="external">å‚è€ƒ</a></p>
<hr>
<p>å¹³æ»‘ç§»åŠ¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//        mListView.smoothScrollBy(1000,1000);</div><div class="line">//        mListView.smoothScrollByOffset(15);</div><div class="line">//        mListView.smoothScrollToPosition(15);</div></pre></td></tr></table></figure>
<h2 id="åŠ¨æ€ä¿®æ”¹æ•°æ®">åŠ¨æ€ä¿®æ”¹æ•°æ®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class NotifyTest extends Activity &#123;</div><div class="line"></div><div class="line">    private List&lt;String&gt; mData;</div><div class="line">    private ListView mListView;</div><div class="line">    private NotifyAdapter mAdapter;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.notify);</div><div class="line">        mData = new ArrayList&lt;String&gt;();</div><div class="line">        for (int i = 0; i &lt; 20; i++) &#123;</div><div class="line">            mData.add(&quot;&quot; + i);</div><div class="line">        &#125;</div><div class="line">        mListView = (ListView) findViewById(R.id.listView);</div><div class="line">        mAdapter = new NotifyAdapter(this, mData);</div><div class="line">        mListView.setAdapter(mAdapter);</div><div class="line">        for (int i = 0; i &lt; mListView.getChildCount(); i++) &#123;</div><div class="line">            View view = mListView.getChildAt(i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void btnAdd(View view) &#123;</div><div class="line">        mData.add(&quot;new&quot;);</div><div class="line">        mAdapter.notifyDataSetChanged();</div><div class="line">        mListView.setSelection(mData.size() - 1);</div><div class="line">//        mListView.smoothScrollBy(1000,1000);</div><div class="line">//        mListView.smoothScrollByOffset(15);</div><div class="line">//        mListView.smoothScrollToPosition(15);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ä¼ å…¥çš„Listå¯¹è±¡è¦ä¸€è‡´</strong></p>
<h2 id="éå†æ‰€æœ‰Item">éå†æ‰€æœ‰Item</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">for (int i = 0; i &lt; mListView.getChildCount(); i++) &#123;</div><div class="line">            View view = mListView.getChildAt(i);</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<h2 id="å¤„ç†ç©ºListView">å¤„ç†ç©ºListView</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">listView.setEmptyView(findViewById(R.id.empty_view))</div></pre></td></tr></table></figure>
<h2 id="ListViewæ»‘åŠ¨ç›‘å¬">ListViewæ»‘åŠ¨ç›‘å¬</h2><h3 id="OnTouchListener">OnTouchListener</h3><p>æœ‰å¾ˆå¤šäº‹ä»¶ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">mListView.setOnTouchListener(new View.OnTouchListener() &#123;</div><div class="line">            @Override</div><div class="line">            public boolean onTouch(View v, MotionEvent event) &#123;</div><div class="line"></div><div class="line">                switch (event.getAction()) &#123;</div><div class="line">                    case MotionEvent.ACTION_DOWN:</div><div class="line">                        //è§¦æ‘¸æ—¶æ“ä½œ</div><div class="line"></div><div class="line">                        break;</div><div class="line"></div><div class="line">                    case MotionEvent.ACTION_MOVE:</div><div class="line">                        //ç§»åŠ¨æ—¶æ“ä½œ</div><div class="line">                        break;</div><div class="line"></div><div class="line">                    case MotionEvent.ACTION_UP:</div><div class="line">                        //ç§»åŠ¨æ—¶æ“ä½œ</div><div class="line">                        break;</div><div class="line">                &#125;</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<h3 id="OnScrollListener">OnScrollListener</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">mListView.setOnScrollListener(new AbsListView.OnScrollListener() &#123;</div><div class="line">           @Override</div><div class="line">           public void onScrollStateChanged(AbsListView view, int scrollState) &#123;</div><div class="line"></div><div class="line">               switch (scrollState)&#123;</div><div class="line">                   case SCROLL_STATE_IDLE:</div><div class="line">                       //æ»‘åŠ¨åœæ­¢æ—¶</div><div class="line">                       Log.d(&quot;test&quot;,&quot;SCROLL_STATE_IDLE&quot;);</div><div class="line">                       break;</div><div class="line">                   case SCROLL_STATE_TOUCH_SCROLL:</div><div class="line">                       // æ­£åœ¨æ»šåŠ¨</div><div class="line">                       Log.d(&quot;test&quot;,&quot;SCROLL_STATE_TOUCH_SCROLL&quot;);</div><div class="line">                       break;</div><div class="line">                   case SCROLL_STATE_FLING:</div><div class="line">                       //æ‰‹æŒ‡æŠ›åŠ¨æ—¶ï¼Œå³æ‰‹æŒ‡ç”¨åŠ›æ»‘åŠ¨</div><div class="line">                       Log.d(&quot;test&quot;,&quot;SCROLL_STATE_FLING&quot;);</div><div class="line">                       break;</div><div class="line">               &#125;</div><div class="line"></div><div class="line">           &#125;</div><div class="line"></div><div class="line">           /**</div><div class="line">            *</div><div class="line">            * @param view</div><div class="line">            * @param firstVisibleItem å½“å‰èƒ½çœ‹è§çš„ç¬¬ä¸€ä¸ªitemçš„idï¼ˆä»0å¼€å§‹ï¼‰ï¼ŒåŒ…æ‹¬æ²¡æœ‰å®Œæ•´æ˜¾ç¤ºçš„item</div><div class="line">            * @param visibleItemCount å½“å‰èƒ½çœ‹è§çš„itemæ€»æ•°</div><div class="line">            * @param totalItemCount æ•´ä¸ªlistviewçš„itemæ€»æ•°</div><div class="line">            */</div><div class="line">           @Override</div><div class="line">           public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) &#123;</div><div class="line">                   //æ»šåŠ¨æ—¶ä¸€ç›´è°ƒç”¨</div><div class="line">               Log.d(&quot;test&quot;,&quot;onScroll&quot;);</div><div class="line"></div><div class="line">               /**</div><div class="line">                * ç”¨æ³•1 å½“å‰å¯è§†çš„ç¬¬ä¸€ä¸ªitemçš„idåŠ ä¸Šå½“å‰å¯è§†çš„itemæ•°é‡ç­‰äºlistviewæ€»æ•°çš„æ—¶å€™ï¼Œå¯ä»¥åˆ¤æ–­æ»šåŠ¨åˆ°äº†æœ€åä¸€è¡Œ</div><div class="line">                *</div><div class="line">                */</div><div class="line">               if (firstVisibleItem+visibleItemCount==totalItemCount&amp;&amp;totalItemCount&gt;0)&#123;</div><div class="line">                   //æ»šåŠ¨åˆ°äº†æœ€åä¸€è¡Œ</div><div class="line">               &#125;</div><div class="line"></div><div class="line">               /**</div><div class="line">                * åˆ¤æ–­æ»šåŠ¨çš„æ–¹å‘</div><div class="line">                */</div><div class="line">               Log.d(&quot;åˆ¤æ–­å‰&quot;,firstVisibleItem+&quot;/&quot;+lastVisableItemPostion);</div><div class="line">               if (firstVisibleItem&gt;lastVisableItemPostion)&#123;</div><div class="line">                   //ä¸Šæ»‘</div><div class="line">                   Log.d(&quot;test&quot;, &quot;ä¸Šæ»‘&quot;);</div><div class="line">               &#125;else if (firstVisibleItem&lt;lastVisableItemPostion)&#123;</div><div class="line">                   //ä¸‹æ»‘</div><div class="line">                   Log.d(&quot;test&quot;, &quot;ä¸‹æ»‘&quot;);</div><div class="line">               &#125;</div><div class="line"></div><div class="line">               lastVisableItemPostion=firstVisibleItem;</div><div class="line">               Log.d(&quot;åˆ¤æ–­å&quot;,firstVisibleItem+&quot;/&quot;+lastVisableItemPostion);</div><div class="line">           &#125;</div><div class="line">       &#125;);</div></pre></td></tr></table></figure>
<h3 id="å…¶ä»–æ–¹æ³•">å…¶ä»–æ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">       * è·å¾—å¯è§çš„itemçš„ä½ç½®</div><div class="line">       */</div><div class="line"></div><div class="line">      mListView.getFirstVisiblePosition();</div><div class="line">      mListView.getLastVisiblePosition();</div></pre></td></tr></table></figure>
<h2 id="ListViewå¸¸ç”¨æ‹“å±•">ListViewå¸¸ç”¨æ‹“å±•</h2><hr>
<h3 id="è®©ListViewå…·æœ‰å¼¹æ€§">è®©ListViewå…·æœ‰å¼¹æ€§</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">public class FlexibleListView extends ListView &#123;</div><div class="line"></div><div class="line">    private static int mMaxOverDistance = 50;</div><div class="line">    private Context mContext;</div><div class="line"></div><div class="line">    public FlexibleListView(Context context, AttributeSet attrs,</div><div class="line">                            int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">        this.mContext = context;</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public FlexibleListView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        this.mContext = context;</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public FlexibleListView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">        this.mContext = context;</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void initView() &#123;</div><div class="line">        DisplayMetrics metrics = mContext.getResources().getDisplayMetrics();</div><div class="line">        float density = metrics.density;</div><div class="line">        mMaxOverDistance = (int) (density * mMaxOverDistance);</div><div class="line">    &#125;</div><div class="line">	</div><div class="line">	</div><div class="line">	 /**</div><div class="line">     * æ»‘åŠ¨åˆ°è¾¹ç¼˜æ—¶è°ƒç”¨çš„æ–¹æ³•</div><div class="line">     * @param deltaX</div><div class="line">     * @param deltaY</div><div class="line">     * @param scrollX</div><div class="line">     * @param scrollY</div><div class="line">     * @param scrollRangeX</div><div class="line">     * @param scrollRangeY</div><div class="line">     * @param maxOverScrollX</div><div class="line">     * @param maxOverScrollY</div><div class="line">     * Number of pixels to overscroll by in either direction</div><div class="line">     *          along the Y axis.</div><div class="line">     * @param isTouchEvent</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    protected boolean overScrollBy(int deltaX, int deltaY,</div><div class="line">                                   int scrollX, int scrollY,</div><div class="line">                                   int scrollRangeX, int scrollRangeY,</div><div class="line">                                   int maxOverScrollX, int maxOverScrollY,</div><div class="line">                                   boolean isTouchEvent) &#123;</div><div class="line">        return super.overScrollBy(deltaX, deltaY,</div><div class="line">                scrollX, scrollY,</div><div class="line">                scrollRangeX, scrollRangeY,</div><div class="line">                maxOverScrollX, mMaxOverDistance,</div><div class="line">                isTouchEvent);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="è‡ªåŠ¨æ˜¾ç¤ºï¼Œéšè—çš„ListView">è‡ªåŠ¨æ˜¾ç¤ºï¼Œéšè—çš„ListView</h3><p>åˆå§‹åŒ–æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">/è·å–ç³»ç»Ÿè®¤ä¸ºçš„æœ€ä½æ»‘åŠ¨è·ç¦»</div><div class="line">        mTouchSlop = ViewConfiguration.get(this).getScaledTouchSlop();</div><div class="line">        mToolbar = (Toolbar) findViewById(R.id.toolbar);</div><div class="line">        mListView = (ListView) findViewById(R.id.listview);</div><div class="line">        for (int i = 0; i &lt; mStr.length; i++) &#123;</div><div class="line">            mStr[i] = &quot;Item &quot; + i;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //Listviewæ·»åŠ å¤´éƒ¨View</div><div class="line">        View header = new View(this);</div><div class="line">        header.setLayoutParams(new AbsListView.LayoutParams(</div><div class="line">                AbsListView.LayoutParams.MATCH_PARENT,</div><div class="line">                (int) getResources().getDimension(</div><div class="line">                        R.dimen.abc_action_bar_default_height_material)));</div><div class="line">        mListView.addHeaderView(header);</div><div class="line">        mListView.setAdapter(new ArrayAdapter&lt;String&gt;(</div><div class="line">                ScrollHideListView.this,</div><div class="line">                android.R.layout.simple_expandable_list_item_1,</div><div class="line">                mStr));</div><div class="line">        mListView.setOnTouchListener(myTouchListener);</div></pre></td></tr></table></figure>
<p>è®¾ç½®ç›‘å¬å™¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">View.OnTouchListener myTouchListener = new View.OnTouchListener() &#123;</div><div class="line">        @Override</div><div class="line">        public boolean onTouch(View v, MotionEvent event) &#123;</div><div class="line">            switch (event.getAction()) &#123;</div><div class="line">                case MotionEvent.ACTION_DOWN:</div><div class="line">                    mFirstY = event.getY();</div><div class="line">                    break;</div><div class="line">                case MotionEvent.ACTION_MOVE:</div><div class="line">                    mCurrentY = event.getY();</div><div class="line">                    if (mCurrentY - mFirstY &gt; mTouchSlop) &#123;</div><div class="line">                        direction = 0;// down</div><div class="line">                    &#125; else if (mFirstY - mCurrentY &gt; mTouchSlop) &#123;</div><div class="line">                        direction = 1;// up</div><div class="line">                    &#125;</div><div class="line">                    if (direction == 1) &#123;</div><div class="line">                        if (mShow) &#123;</div><div class="line">                            toolbarAnim(1);//hide</div><div class="line">                            mShow = !mShow;</div><div class="line">                        &#125;</div><div class="line">                    &#125; else if (direction == 0) &#123;</div><div class="line">                        if (!mShow) &#123;</div><div class="line">                            toolbarAnim(0);//show</div><div class="line">                            mShow = !mShow;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    break;</div><div class="line">                case MotionEvent.ACTION_UP:</div><div class="line">                    break;</div><div class="line">            &#125;</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div></pre></td></tr></table></figure>
<p>åŠ¨ç”»æ§åˆ¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">private ObjectAnimator mAnimator;</div><div class="line"></div><div class="line">private void toolbarAnim(int flag) &#123;</div><div class="line">        if (mAnimator != null &amp;&amp; mAnimator.isRunning()) &#123;</div><div class="line">            mAnimator.cancel();</div><div class="line">        &#125;</div><div class="line">        if (flag == 0) &#123;</div><div class="line">            mAnimator = ObjectAnimator.ofFloat(mToolbar,</div><div class="line">                    &quot;translationY&quot;, mToolbar.getTranslationY(), 0);</div><div class="line">        &#125; else &#123;</div><div class="line">            mAnimator = ObjectAnimator.ofFloat(mToolbar,</div><div class="line">                    &quot;translationY&quot;, mToolbar.getTranslationY(),</div><div class="line">                    -mToolbar.getHeight());</div><div class="line">        &#125;</div><div class="line">        mAnimator.start();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="åŠ¨æ€æ”¹å˜Listviewå¸ƒå±€">åŠ¨æ€æ”¹å˜Listviewå¸ƒå±€</h3><p>è¿™é‡Œä»¥ç‚¹å‡»æŸä¸€é¡¹listviewä¸ºä¾‹å­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line">public class FocusListViewAdapter extends BaseAdapter &#123;</div><div class="line"></div><div class="line">    private List&lt;String&gt; mData;</div><div class="line">    private Context mContext;</div><div class="line">    private int mCurrentItem = 0;</div><div class="line"></div><div class="line">    public FocusListViewAdapter(Context context, List&lt;String&gt; data) &#123;</div><div class="line">        this.mContext = context;</div><div class="line">        this.mData = data;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public int getCount() &#123;</div><div class="line">        return mData.size();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public Object getItem(int position) &#123;</div><div class="line">        return mData.get(position);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public long getItemId(int position) &#123;</div><div class="line">        return position;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     *</div><div class="line">     * @param position</div><div class="line">     * @param convertView</div><div class="line">     * @param parent</div><div class="line">     * @return</div><div class="line">     * ç»˜åˆ¶Viewçš„æ–¹æ³•ä¸­å¯¹è®°å½•çš„positionè¿›è¡ŒåŒºåˆ«å¤„ç†</div><div class="line">     * åˆæ¬¡ç»˜åˆ¶æ—¶è°ƒç”¨</div><div class="line">     */</div><div class="line">    public View getView(int position, View convertView, ViewGroup parent) &#123;</div><div class="line">        LinearLayout layout = new LinearLayout(mContext);</div><div class="line">        layout.setOrientation(LinearLayout.VERTICAL);</div><div class="line">        if (mCurrentItem == position) &#123;</div><div class="line">            layout.addView(addFocusView(position));</div><div class="line">        &#125; else &#123;</div><div class="line">            layout.addView(addNormalView(position));</div><div class="line">        &#125;</div><div class="line">        return layout;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    //æš´éœ²åŠ¨æ€æ”¹å˜è®°å½•positionçš„æ–¹æ³•</div><div class="line">    public void setCurrentItem(int currentItem) &#123;</div><div class="line">        this.mCurrentItem = currentItem;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    //åŠ è½½å¸ƒå±€1</div><div class="line">    private View addFocusView(int i) &#123;</div><div class="line">        ImageView iv = new ImageView(mContext);</div><div class="line">        iv.setImageResource(R.mipmap.ic_launcher);</div><div class="line">        return iv;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //åŠ è½½å¸ƒå±€2</div><div class="line">    private View addNormalView(int i) &#123;</div><div class="line">        LinearLayout layout = new LinearLayout(mContext);</div><div class="line">        layout.setOrientation(LinearLayout.HORIZONTAL);</div><div class="line">        ImageView iv = new ImageView(mContext);</div><div class="line">        iv.setImageResource(R.drawable.in_icon);</div><div class="line">        layout.addView(iv, new LinearLayout.LayoutParams(</div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT,</div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT));</div><div class="line">        TextView tv = new TextView(mContext);</div><div class="line">        tv.setText(mData.get(i));</div><div class="line">        layout.addView(tv, new LinearLayout.LayoutParams(</div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT,</div><div class="line">                LinearLayout.LayoutParams.WRAP_CONTENT));</div><div class="line">        layout.setGravity(Gravity.CENTER);</div><div class="line">        return layout;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>control</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">public class FocusListViewTest extends Activity &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line">        setContentView(R.layout.focus);</div><div class="line">        ListView listView = (ListView) findViewById(R.id.focus_listView);</div><div class="line">        List&lt;String&gt; data = new ArrayList&lt;String&gt;();</div><div class="line">        data.add(&quot;I am item 1&quot;);</div><div class="line">        data.add(&quot;I am item 2&quot;);</div><div class="line">        data.add(&quot;I am item 3&quot;);</div><div class="line">        data.add(&quot;I am item 4&quot;);</div><div class="line">        data.add(&quot;I am item 5&quot;);</div><div class="line">        final FocusListViewAdapter adapter = new FocusListViewAdapter(this, data);</div><div class="line">        listView.setAdapter(adapter);</div><div class="line">        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onItemClick(AdapterView&lt;?&gt; parent, View view,</div><div class="line">                                    int position, long id) &#123;</div><div class="line">                adapter.setCurrentItem(position);</div><div class="line">                /**</div><div class="line">                 * listView åˆæ¬¡ç»˜åˆ¶æŸä¸€é¡¹æ•°æ®æ—¶è°ƒç”¨geiviewæ–¹æ³•</div><div class="line">                 * ä¹‹åéœ€è¦notifyDataSetChangedæ‰èƒ½é‡ç»˜View</div><div class="line">                 */</div><div class="line">                adapter.notifyDataSetChanged();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>æœ¬æ¥æƒ³è·³è¿‡çš„ï¼Œçœ‹äº†ä¸‹ä¹¦ï¼Œå®åœ¨æ˜¯å¤ªç†Ÿæ‚‰äº†ï¼Œå¾…åŠï¼Œå…ˆå ä¸ªå‘<br>]]>
    
    </summary>
    
      <category term="Android" scheme="http://mzeht.com/tags/Android/"/>
    
      <category term="ListView" scheme="http://mzeht.com/tags/ListView/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="AndroidHero" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/AndroidHero/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Androidæ§ä»¶æ¶æ„ä¸è‡ªå®šä¹‰æ§ä»¶è¯¦è§£]]></title>
    <link href="http://mzeht.com/2016/10/08/Android%E6%8E%A7%E4%BB%B6%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%E8%AF%A6%E8%A7%A3/"/>
    <id>http://mzeht.com/2016/10/08/Androidæ§ä»¶æ¶æ„ä¸è‡ªå®šä¹‰æ§ä»¶è¯¦è§£/</id>
    <published>2016-10-08T11:18:29.000Z</published>
    <updated>2016-12-25T11:22:37.000Z</updated>
    <content type="html"><![CDATA[<h1 id="Viewçš„æµ‹é‡">Viewçš„æµ‹é‡</h1><p>Androidå¸®åŠ©æµ‹é‡Viewçš„ç±»â€”<code>MeasureSpec</code>ç±»<br>MeasureSpecæ˜¯ä¸€ä¸ª32ä½çš„intå€¼ï¼Œé«˜ä¸¤ä½ä¸ºæµ‹é‡çš„æ¨¡å¼ï¼Œä½30ä½ä¸ºæµ‹é‡çš„å¤§å°<br>ä½¿ç”¨ä½è¿ç®—æé«˜å¹¶ä¼˜åŒ–æ•ˆç‡</p>
<a id="more"></a>
<h2 id="æµ‹é‡çš„æ¨¡å¼">æµ‹é‡çš„æ¨¡å¼</h2><ul>
<li><p><code>EXACTLY</code> ç²¾ç¡®å€¼æ¨¡å¼<br>æ§ä»¶layout_width,layout_heightå±æ€§æŒ‡å®šä¸ºå…·ä½“æ•°å€¼æ—¶ï¼Œæˆ–è€…æ˜¯match_parentå±æ€§æ—¶</p>
</li>
<li><p><code>AT_MOST</code> æœ€å¤§å€¼æ¨¡å¼<br>æ§ä»¶layout_width,layout_heightå±æ€§ä½¿ç”¨warp_contentï¼Œæ§ä»¶çš„å¤§å°å–ä¸è¶…è¿‡çˆ¶çº§æ§ä»¶çš„æœ€å¤§å€¼</p>
</li>
<li><p><code>UNSPECIFIED</code><br>ä¸æŒ‡å®šæµ‹é‡æ¨¡å¼ï¼Œå¯ä»¥ä»»æ„å¤§å°ï¼Œé€šå¸¸è‡ªå®šä¹‰Viewç»˜åˆ¶æ—¶æ‰ç”¨åˆ°</p>
</li>
</ul>
<h2 id="Demo">Demo</h2><ul>
<li><p>Viewç±»é»˜è®¤çš„<code>onMeasure()</code>æ–¹æ³•åªæ”¯æŒEXACTLYæ¨¡å¼ï¼Œå¦‚æœè¯¥Viewè¦æ”¯æŒwarp_contentå±æ€§<br>   å°±å¿…é¡»è¦é‡å†™onMeasure()æ–¹æ³• æŒ‡å®šAT_MOSTæ¨¡å¼ä¸‹warp_contentæ—¶çš„å¤§å°</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> @Override</div><div class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line">    super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<pre><code>è¿›å…¥`onMeasure`æ–¹æ³•,çœ‹æºç 
å¯ä»¥å‘ç°æœ€ç»ˆè°ƒç”¨



<span class="comment"><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec),getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec));</div></pre></td></tr></table></figure></span>
</code></pre><ul>
<li><p>setMeasuredDimension(int measuredWidth, int measuredHeight)é‡Œé¢çš„å‚æ•°ç›¸å½“äºpxå•ä½   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">public class MyView extends View &#123;</div><div class="line">    public MyView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     *</div><div class="line">     * @param widthMeasureSpec</div><div class="line">     * @param heightMeasureSpec</div><div class="line">     * Viewç±»é»˜è®¤çš„onMeasure()æ–¹æ³•åªæ”¯æŒEXACTLYæ¨¡å¼ï¼Œå¦‚æœè¯¥Viewè¦æ”¯æŒwarp_contentå±æ€§</div><div class="line">     * å°±å¿…é¡»è¦é‡å†™onMeasure()æ–¹æ³• æŒ‡å®šAT_MOStæ¨¡å¼ä¸‹warp_contentæ—¶çš„å¤§å°</div><div class="line">     */</div><div class="line">    @Override</div><div class="line">    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line">        super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">        setMeasuredDimension(measure(widthMeasureSpec), measure(heightMeasureSpec));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private int measure(int measureSpec) &#123;</div><div class="line">        int result = 0;</div><div class="line">        int specMode = MeasureSpec.getMode(measureSpec);</div><div class="line">        int specSize = MeasureSpec.getSize(measureSpec);</div><div class="line"></div><div class="line">        //ç²¾ç¡®å€¼æ¨¡å¼ï¼Œå‚æ•°ç›´æ¥ä½¿ç”¨</div><div class="line">        if (specMode == MeasureSpec.EXACTLY) &#123;</div><div class="line">            result = specSize;</div><div class="line"></div><div class="line">            //æœ€å¤§å€¼æ¨¡å¼ï¼Œwrap_contentæ—¶å–ä¸è¶…è¿‡çˆ¶çº§ç©ºé—´çš„æœ€å¤§å€¼</div><div class="line">        &#125; else if (specMode == MeasureSpec.AT_MOST) &#123;</div><div class="line">            result = 200;</div><div class="line">            result = Math.min(result, specSize);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        /**</div><div class="line">         * 200PX</div><div class="line">         * setMeasuredDimension(int measuredWidth, int measuredHeight)é‡Œé¢çš„å‚æ•°ç›¸å½“äºpxå•ä½</div><div class="line">         */</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        canvas.drawColor(Color.GRAY);</div><div class="line">        int width = getWidth();</div><div class="line">        int height = getHeight();</div><div class="line">        Log.d(&quot;xys&quot;, &quot;width : &quot; + width + &quot; height : &quot; + height);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="ViewGroupçš„æµ‹é‡">ViewGroupçš„æµ‹é‡</h1><p>ViewGroupå¤§å°ä¸ºwarp_contentæ—¶ï¼Œéœ€è¦éå†å­Viewï¼Œè°ƒç”¨å…¶Measureæ–¹æ³•ï¼Œè·å¾—æ‰€æœ‰å­Viewçš„å¤§å°ï¼Œä»¥ä¾¿ç¡®å®šè‡ªå·±çš„å¤§å°;<br>æµ‹é‡å®Œæ¯•åï¼Œå°†å­Viewæ”¾åˆ°åˆé€‚çš„ä½ç½®ï¼Œéå†ä½¿ç”¨å­Viewçš„Layoutæ–¹æ³•ï¼ŒæŒ‡å®šå…¶æ˜¾ç¤ºçš„å…·ä½“ä½ç½®ï¼Œä»è€Œå†³å®šå…¶å¸ƒå±€çš„ä½ç½®ï¼›<br>è‡ªå®šä¹‰ViewGroupæ—¶ï¼Œé€šå¸¸ä¼šé‡å†™onLayout()æ–¹æ³•æ¥æ§åˆ¶å­Viewæ˜¾ç¤ºä½ç½®çš„é€»è¾‘ï¼›<br>å¦‚æœè¿˜è¦æ”¯æŒwarp_contentå±æ€§ï¼Œå¿…é¡»é‡å†™onMeasure()æ–¹æ³•ï¼Œè¿™ç‚¹ä¸Viewç›¸åŒ</p>
<h1 id="ViewGroupçš„ç»˜åˆ¶">ViewGroupçš„ç»˜åˆ¶</h1><p>ViewGroupé€šå¸¸ä¸éœ€è¦ç»˜åˆ¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šViewGroupçš„èƒŒæ™¯é¢œè‰²ï¼ŒViewGroupçš„onDarw()æ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼›<br>ViewGroupä¼šè°ƒç”¨dispathchDarw()æ–¹æ³•ç»˜åˆ¶å­Viewï¼ŒåŒæ ·éå†å­Viewï¼Œè°ƒç”¨å­Viewçš„ç»˜åˆ¶æ–¹æ³•å®Œæˆç»˜åˆ¶ï¼›</p>
<h1 id="è‡ªå®šä¹‰View">è‡ªå®šä¹‰View</h1><ul>
<li>é€šå¸¸é‡å†™onDarwæ–¹æ³•æ¥ç»˜åˆ¶Viewçš„æ˜¾ç¤ºå†…å®¹ï¼›</li>
<li>ä½¿ç”¨warp_contentå±æ€§ï¼Œå¿…é¡»é‡å†™onMeasureæ–¹æ³•</li>
<li>è‡ªå®šä¹‰attrså±æ€§ï¼Œå¯ä»¥è®¾ç½®æ–°çš„é…ç½®å±æ€§</li>
</ul>
<h2 id="ä¸€äº›é‡è¦çš„å›è°ƒæ–¹æ³•">ä¸€äº›é‡è¦çš„å›è°ƒæ–¹æ³•</h2><ul>
<li>onFinishInflate ä»xmlåŠ è½½ç»„ä»¶å</li>
<li>onSizeChanged ç»„ä»¶å¤§å°æ”¹å˜å</li>
<li>onMeasure å›è°ƒæ­¤æ–¹æ³•è¿›è¡Œæµ‹é‡</li>
<li>onLayout å›è°ƒæ­¤æ–¹æ³•ç¡®å®šæ˜¾ç¤ºä½ç½®</li>
<li>onTouchEvent è§¦æ‘¸äº‹ä»¶æ—¶å›è°ƒ</li>
</ul>
<p><a href="http://www.jianshu.com/p/744550c02cf1s" target="_blank" rel="external">è‡ªå®šä¹‰æ§ä»¶å¸¸ç”¨api</a></p>
<h2 id="è‡ªå®šä¹‰Viewçš„ä¸‰ç§æ–¹æ³•">è‡ªå®šä¹‰Viewçš„ä¸‰ç§æ–¹æ³•</h2><ul>
<li>æ‹“å±•ç°æœ‰æ§ä»¶</li>
<li>ç»„åˆæ§ä»¶</li>
<li>é‡å†™Viewå®ç°å…¨æ–°æ§ä»¶</li>
</ul>
<h3 id="æ‹“å±•ç°æœ‰æ§ä»¶">æ‹“å±•ç°æœ‰æ§ä»¶</h3><p>æ‹“å±•TextView</p>
<blockquote>
<p>Demo1</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">public class MyTextView extends TextView &#123;</div><div class="line"></div><div class="line">    private Paint mPaint1,mPaint2;</div><div class="line">    public MyTextView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyTextView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyTextView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        // ç»˜åˆ¶å¤–å±‚çŸ©å½¢</div><div class="line">        canvas.drawRect(</div><div class="line">                0, 0,</div><div class="line">                getMeasuredWidth(),</div><div class="line">                getMeasuredHeight(),</div><div class="line">                mPaint1);</div><div class="line">        // ç»˜åˆ¶å†…å±‚çŸ©å½¢</div><div class="line">        canvas.drawRect(</div><div class="line">                10,</div><div class="line">                10,</div><div class="line">                getMeasuredWidth() - 10,</div><div class="line">                getMeasuredHeight() - 10,</div><div class="line">                mPaint2);</div><div class="line">        canvas.save();</div><div class="line">        // ç»˜åˆ¶æ–‡å­—å‰å¹³ç§»10åƒç´ </div><div class="line">        canvas.translate(10, 0);</div><div class="line">        // çˆ¶ç±»å®Œæˆçš„æ–¹æ³•ï¼Œå³ç»˜åˆ¶æ–‡æœ¬</div><div class="line">        super.onDraw(canvas);</div><div class="line">        canvas.restore();</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private  void initView()&#123;</div><div class="line">        mPaint1=new Paint();</div><div class="line">        mPaint1.setColor(getResources().getColor(android.R.color.holo_blue_light));</div><div class="line">        mPaint1.setStyle(Paint.Style.FILL);</div><div class="line">        mPaint2=new Paint();</div><div class="line">        mPaint2.setColor(Color.YELLOW);</div><div class="line">        mPaint2.setStyle(Paint.Style.FILL);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</div><div class="line">        super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;com.wpmac.androidhero.unit3.view.MyTextView android:layout_width=&quot;match_parent&quot;</div><div class="line">                                                 android:layout_height=&quot;wrap_content&quot;</div><div class="line">                                                 android:textSize=&quot;20sp&quot;</div><div class="line">                                                 android:text=&quot;Android hero&quot;/&gt;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-9/63189918.jpg" alt=""></p>
<blockquote>
<p>Demo2</p>
</blockquote>
<p>æ–‡å­—æ·»åŠ çº¿æ€§å˜æ¢æ•ˆæœ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">public class ShineTextView extends TextView &#123;</div><div class="line"></div><div class="line">    private LinearGradient mLinearGradient;</div><div class="line">    private Matrix mGradientMatrix;</div><div class="line">    private Paint mPaint;</div><div class="line">    private int mViewWidth = 0;</div><div class="line">    private int mTranslate = 0;</div><div class="line"></div><div class="line">    public ShineTextView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ShineTextView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ShineTextView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onSizeChanged(int w, int h, int oldw, int oldh) &#123;</div><div class="line">        super.onSizeChanged(w, h, oldw, oldh);</div><div class="line">        if (mViewWidth == 0) &#123;</div><div class="line">            mViewWidth = getMeasuredWidth();</div><div class="line">            if (mViewWidth &gt; 0) &#123;</div><div class="line">                mPaint = getPaint();</div><div class="line">                mLinearGradient = new LinearGradient(</div><div class="line">                        0,</div><div class="line">                        0,</div><div class="line">                        mViewWidth,</div><div class="line">                        0,</div><div class="line">                        new int[]&#123;</div><div class="line">                                Color.BLUE, 0xffffffff,</div><div class="line">                                Color.BLUE&#125;,</div><div class="line">                        null,</div><div class="line">                        Shader.TileMode.CLAMP);</div><div class="line">                mPaint.setShader(mLinearGradient);</div><div class="line">                mGradientMatrix = new Matrix();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        if (mGradientMatrix != null) &#123;</div><div class="line">            mTranslate += mViewWidth / 5;</div><div class="line">            if (mTranslate &gt; 2 * mViewWidth) &#123;</div><div class="line">                mTranslate = -mViewWidth;</div><div class="line">            &#125;</div><div class="line">            mGradientMatrix.setTranslate(mTranslate, 0);</div><div class="line">            mLinearGradient.setLocalMatrix(mGradientMatrix);</div><div class="line">            postInvalidateDelayed(100);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å¤åˆæ§ä»¶">å¤åˆæ§ä»¶</h3><ul>
<li>å®šä¹‰è‡ªå®šä¹‰å±æ€§</li>
</ul>
<p>æ–°å»ºæˆ–ä¿®æ”¹attrs.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;resources&gt;</div><div class="line"></div><div class="line">    &lt;declare-styleable name=&quot;TopBar&quot;&gt;</div><div class="line"></div><div class="line">        &lt;attr name=&quot;mtitle&quot; format=&quot;string&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mtitleTextSize&quot; format=&quot;dimension&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mtitleTextColor&quot; format=&quot;color&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mleftTextColor&quot; format=&quot;color&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mleftBackground&quot; format=&quot;reference|color&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mleftText&quot; format=&quot;string&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mrightTextColor&quot; format=&quot;color&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mrightBackground&quot; format=&quot;reference|color&quot;/&gt;</div><div class="line">        &lt;attr name=&quot;mrightText&quot; format=&quot;string&quot;/&gt;</div><div class="line">    &lt;/declare-styleable&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
<p><a href="http://www.cnblogs.com/jisheng/archive/2013/01/10/2854891.html" target="_blank" rel="external">å…³äºformatç±»å‹</a></p>
<ul>
<li>å¼•å…¥å‘½åç©ºé—´</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">                xmlns:custom=&quot;http://schemas.android.com/apk/res-auto&quot;</div><div class="line">                xmlns:tools=&quot;http://schemas.android.com/tools&quot;</div><div class="line">                android:layout_width=&quot;match_parent&quot;</div><div class="line">                android:layout_height=&quot;match_parent&quot;</div><div class="line">                android:padding=&quot;5dp&quot;</div><div class="line">                tools:context=&quot;.MainActivity&quot;&gt;</div><div class="line">    &lt;com.wpmac.androidhero.unit3.view.TopBar</div><div class="line">        android:id=&quot;@+id/topBar&quot;</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;40dp&quot;</div><div class="line">        custom:mleftBackground=&quot;@drawable/blue_button&quot;</div><div class="line">        custom:mleftText=&quot;Back&quot;</div><div class="line">        custom:mleftTextColor=&quot;#FFFFFF&quot;</div><div class="line">        custom:mrightBackground=&quot;@drawable/blue_button&quot;</div><div class="line">        custom:mrightText=&quot;More&quot;</div><div class="line">        custom:mrightTextColor=&quot;#FFFFFF&quot;</div><div class="line">        custom:mtitle=&quot;è‡ªå®šä¹‰æ ‡é¢˜&quot;</div><div class="line">        custom:mtitleTextColor=&quot;#FFFFFF&quot;</div><div class="line">        custom:mtitleTextSize=&quot;10sp&quot; /&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;/RelativeLayout&gt;</div></pre></td></tr></table></figure>
<ul>
<li>è·å¾—è‡ªå®šä¹‰çš„å±æ€§å€¼</li>
</ul>
<p>æ³¨æ„ <code>ta.recycle()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå°†ä½ åœ¨atts.xmlä¸­å®šä¹‰çš„declare-styleable</div><div class="line">        // çš„æ‰€æœ‰å±æ€§çš„å€¼å­˜å‚¨åˆ°TypedArrayä¸­</div><div class="line">        TypedArray ta = context.obtainStyledAttributes(attrs,</div><div class="line">                R.styleable.TopBar);</div><div class="line">        // ä»TypedArrayä¸­å–å‡ºå¯¹åº”çš„å€¼æ¥ä¸ºè¦è®¾ç½®çš„å±æ€§èµ‹å€¼</div><div class="line">        mLeftTextColor = ta.getColor(</div><div class="line">                R.styleable.TopBar_mleftTextColor, 0);</div><div class="line">        mLeftBackground = ta.getDrawable(</div><div class="line">                R.styleable.TopBar_mleftBackground);</div><div class="line">        mLeftText = ta.getString(R.styleable.TopBar_mleftText);</div><div class="line">....</div><div class="line"></div><div class="line">// è·å–å®ŒTypedArrayçš„å€¼åï¼Œä¸€èˆ¬è¦è°ƒç”¨</div><div class="line">        // recyleæ–¹æ³•æ¥é¿å…é‡æ–°åˆ›å»ºçš„æ—¶å€™çš„é”™è¯¯</div><div class="line">        ta.recycle();</div></pre></td></tr></table></figure>
<ul>
<li>ç»„åˆæ§ä»¶</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// ä¸ºç»„ä»¶å…ƒç´ è®¾ç½®ç›¸åº”çš„å¸ƒå±€å…ƒç´ </div><div class="line">        mLeftParams = new RelativeLayout.LayoutParams(</div><div class="line">                RelativeLayout.LayoutParams.WRAP_CONTENT,</div><div class="line">                RelativeLayout.LayoutParams.MATCH_PARENT);</div><div class="line">        mLeftParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT, TRUE);</div><div class="line">        // æ·»åŠ åˆ°ViewGroup</div><div class="line">        addView(mLeftButton, mLeftParams);</div></pre></td></tr></table></figure>
<ul>
<li>å®šä¹‰å›è°ƒå€Ÿå£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// æ¥å£å¯¹è±¡ï¼Œå®ç°å›è°ƒæœºåˆ¶ï¼Œåœ¨å›è°ƒæ–¹æ³•ä¸­</div><div class="line">    // é€šè¿‡æ˜ å°„çš„æ¥å£å¯¹è±¡è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•</div><div class="line">    // è€Œä¸ç”¨å»è€ƒè™‘å¦‚ä½•å®ç°ï¼Œå…·ä½“çš„å®ç°ç”±è°ƒç”¨è€…å»åˆ›å»º</div><div class="line">    public interface topbarClickListener &#123;</div><div class="line">        // å·¦æŒ‰é’®ç‚¹å‡»äº‹ä»¶</div><div class="line">        void leftClick();</div><div class="line">        // å³æŒ‰é’®ç‚¹å‡»äº‹ä»¶</div><div class="line">        void rightClick();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>æš´éœ²æ¥å£ï¼Œç»‘å®šæ¥å£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// æ˜ å°„ä¼ å…¥çš„æ¥å£å¯¹è±¡</div><div class="line">    private topbarClickListener mListener;</div><div class="line">    </div><div class="line">    // æš´éœ²ä¸€ä¸ªæ–¹æ³•ç»™è°ƒç”¨è€…æ¥æ³¨å†Œæ¥å£å›è°ƒ</div><div class="line">    // é€šè¿‡æ¥å£æ¥è·å¾—å›è°ƒè€…å¯¹æ¥å£æ–¹æ³•çš„å®ç°</div><div class="line">    public void setOnTopbarClickListener(topbarClickListener mListener) &#123;</div><div class="line">        this.mListener = mListener;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">// æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œä¸éœ€è¦å…·ä½“çš„å®ç°ï¼Œ</div><div class="line">        // åªéœ€è°ƒç”¨æ¥å£çš„æ–¹æ³•ï¼Œå›è°ƒçš„æ—¶å€™ï¼Œä¼šæœ‰å…·ä½“çš„å®ç°</div><div class="line">        mRightButton.setOnClickListener(new OnClickListener() &#123;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                mListener.rightClick();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        mLeftButton.setOnClickListener(new OnClickListener() &#123;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onClick(View v) &#123;</div><div class="line">                mListener.leftClick();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<ul>
<li>å®ç°æ¥å£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">@BindView(R.id.topBar)</div><div class="line">   TopBar mTopBar;</div><div class="line">  ......</div><div class="line"></div><div class="line">mTopBar.setOnTopbarClickListener(new TopBar.topbarClickListener() &#123;</div><div class="line">           @Override</div><div class="line">           public void leftClick() &#123;</div><div class="line">               Toast.makeText(TopBarTestActivity.this,</div><div class="line">                       &quot;left&quot;, Toast.LENGTH_SHORT)</div><div class="line">                       .show();</div><div class="line">           &#125;</div><div class="line"></div><div class="line">           @Override</div><div class="line">           public void rightClick() &#123;</div><div class="line">               Toast.makeText(TopBarTestActivity.this,</div><div class="line">                       &quot;right&quot;, Toast.LENGTH_SHORT)</div><div class="line">                       .show();</div><div class="line">           &#125;</div><div class="line">       &#125;);</div></pre></td></tr></table></figure>
<h3 id="é‡å†™Viewå®ç°æ§ä»¶">é‡å†™Viewå®ç°æ§ä»¶</h3><ul>
<li>å¼§çº¿åœˆ<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/55565089.jpg" alt=""></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line">public class CircleProgressView extends View &#123;</div><div class="line"></div><div class="line">    private int mMeasureHeigth;</div><div class="line">    private int mMeasureWidth;</div><div class="line"></div><div class="line">    private Paint mCirclePaint;</div><div class="line">    private float mCircleXY;</div><div class="line">    private float mRadius;</div><div class="line"></div><div class="line">    private Paint mArcPaint;</div><div class="line">    private RectF mArcRectF;</div><div class="line">    private float mSweepAngle;</div><div class="line">    private float mSweepValue = 66;</div><div class="line"></div><div class="line">    private Paint mTextPaint;</div><div class="line">    private String mShowText;</div><div class="line">    private float mShowTextSize;</div><div class="line"></div><div class="line">    public CircleProgressView(Context context, AttributeSet attrs,</div><div class="line">                              int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public CircleProgressView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public CircleProgressView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onMeasure(int widthMeasureSpec,</div><div class="line">                             int heightMeasureSpec) &#123;</div><div class="line">        mMeasureWidth = MeasureSpec.getSize(widthMeasureSpec);</div><div class="line">        mMeasureHeigth = MeasureSpec.getSize(heightMeasureSpec);</div><div class="line">        setMeasuredDimension(mMeasureWidth, mMeasureHeigth);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        // ç»˜åˆ¶åœ†</div><div class="line">        canvas.drawCircle(mCircleXY, mCircleXY, mRadius, mCirclePaint);</div><div class="line">        // ç»˜åˆ¶å¼§çº¿</div><div class="line">        canvas.drawArc(mArcRectF, 270, mSweepAngle, false, mArcPaint);</div><div class="line">        // ç»˜åˆ¶æ–‡å­—</div><div class="line">        canvas.drawText(mShowText, 0, mShowText.length(),</div><div class="line">                mCircleXY, mCircleXY + (mShowTextSize / 4), mTextPaint);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void initView() &#123;</div><div class="line">        float length = 0;</div><div class="line">        if (mMeasureHeigth &gt;= mMeasureWidth) &#123;</div><div class="line">            length = mMeasureWidth;</div><div class="line">        &#125; else &#123;</div><div class="line">            length = mMeasureHeigth;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        mCircleXY = length / 2;</div><div class="line">        mRadius = (float) (length * 0.5 / 2);</div><div class="line">        mCirclePaint = new Paint();</div><div class="line">        //è®¾ç½®é˜²é”¯é½¿</div><div class="line">        mCirclePaint.setAntiAlias(true);</div><div class="line">        mCirclePaint.setColor(getResources().getColor(</div><div class="line">                android.R.color.holo_blue_bright));</div><div class="line"></div><div class="line">        mArcRectF = new RectF(</div><div class="line">                (float) (length * 0.1),</div><div class="line">                (float) (length * 0.1),</div><div class="line">                (float) (length * 0.9),</div><div class="line">                (float) (length * 0.9));</div><div class="line">        mSweepAngle = (mSweepValue / 100f) * 360f;</div><div class="line">        mArcPaint = new Paint();</div><div class="line">        mArcPaint.setAntiAlias(true);</div><div class="line">        mArcPaint.setColor(getResources().getColor(</div><div class="line">                android.R.color.holo_blue_bright));</div><div class="line">        mArcPaint.setStrokeWidth((float) (length * 0.1));</div><div class="line">        mArcPaint.setStyle(Style.STROKE);</div><div class="line"></div><div class="line">        mShowText = setShowText();</div><div class="line">        mShowTextSize = setShowTextSize();</div><div class="line">        mTextPaint = new Paint();</div><div class="line">        mTextPaint.setTextSize(mShowTextSize);</div><div class="line">        mTextPaint.setTextAlign(Paint.Align.CENTER);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private float setShowTextSize() &#123;</div><div class="line">        this.invalidate();</div><div class="line">        return 50;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private String setShowText() &#123;</div><div class="line">        this.invalidate();</div><div class="line">        return &quot;Android Skill&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void forceInvalidate() &#123;</div><div class="line">        this.invalidate();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setSweepValue(float sweepValue) &#123;</div><div class="line">        if (sweepValue != 0) &#123;</div><div class="line">            mSweepValue = sweepValue;</div><div class="line">        &#125; else &#123;</div><div class="line">            mSweepValue = 25;</div><div class="line">        &#125;</div><div class="line">        this.invalidate();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>åŠ¨æ€æ¡å½¢å›¾</li>
</ul>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/97709616.jpg" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class VolumeView extends View &#123;</div><div class="line"></div><div class="line">    private int mWidth;</div><div class="line">    private int mRectWidth;</div><div class="line">    private int mRectHeight;</div><div class="line">    private Paint mPaint;</div><div class="line">    private int mRectCount;</div><div class="line">    private int offset = 5;</div><div class="line">    private double mRandom;</div><div class="line">    private LinearGradient mLinearGradient;</div><div class="line"></div><div class="line">    public VolumeView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public VolumeView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public VolumeView(Context context, AttributeSet attrs,</div><div class="line">                      int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">        initView();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void initView() &#123;</div><div class="line">        mPaint = new Paint();</div><div class="line">        mPaint.setColor(Color.BLUE);</div><div class="line">        mPaint.setStyle(Paint.Style.FILL);</div><div class="line">        mRectCount = 12;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onSizeChanged(int w, int h, int oldw, int oldh) &#123;</div><div class="line">        super.onSizeChanged(w, h, oldw, oldh);</div><div class="line">        Log.d(&quot;onSizeChanged&quot;,w+&quot;/&quot;+h+&quot;/&quot;+oldw+&quot;/&quot;+oldh+&quot;/&quot;);</div><div class="line">        mWidth = getWidth();</div><div class="line">        mRectHeight = getHeight();</div><div class="line">        mRectWidth = (int) (mWidth * 0.6 / mRectCount);</div><div class="line">        mLinearGradient = new LinearGradient(</div><div class="line">                0,</div><div class="line">                0,</div><div class="line">                mRectWidth,</div><div class="line">                mRectHeight,</div><div class="line">                Color.YELLOW,</div><div class="line">                Color.BLUE,</div><div class="line">                Shader.TileMode.CLAMP);</div><div class="line">        mPaint.setShader(mLinearGradient);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onDraw(Canvas canvas) &#123;</div><div class="line">        super.onDraw(canvas);</div><div class="line">        for (int i = 0; i &lt; mRectCount; i++) &#123;</div><div class="line">            mRandom = Math.random();</div><div class="line">            float currentHeight = (float) (mRectHeight * mRandom);</div><div class="line">            canvas.drawRect(</div><div class="line">                    (float) (mWidth * 0.4 / 2 + mRectWidth * i + offset),</div><div class="line">                    currentHeight,</div><div class="line">                    (float) (mWidth * 0.4 / 2 + mRectWidth * (i + 1)),</div><div class="line">                    mRectHeight,</div><div class="line">                    mPaint);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        //é‡ç»˜å»¶è¿Ÿ300ms</div><div class="line">        postInvalidateDelayed(300);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="è‡ªå®šä¹‰ViewGroup">è‡ªå®šä¹‰ViewGroup</h1><p>é‡å†™onMeasure()æµ‹é‡å­Viewï¼›<br>é‡å†™onLayout()ç¡®å®šå­Viewçš„ä½ç½®ï¼›<br>é‡å†™onTouchEvent()ç­‰å¢åŠ å“åº”äº‹ä»¶ï¼›</p>
<h2 id="å®ç°ç±»ä¼¼ScrollViewçš„åŠŸèƒ½">å®ç°ç±»ä¼¼ScrollViewçš„åŠŸèƒ½</h2><figure class="highlight plain"><figcaption><span>class ScrollView extends ViewGroup &#123;</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div></pre></td><td class="code"><pre><div class="line">    private int mScreenHeight;</div><div class="line">    private Scroller mScroller;</div><div class="line">    private int mLastY;</div><div class="line">    private int mStart;</div><div class="line">    private int mEnd;</div><div class="line"></div><div class="line">    public ScrollView(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">        initView(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ScrollView(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">        initView(context);</div><div class="line"></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public ScrollView(Context context, AttributeSet attrs,</div><div class="line">                        int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">        initView(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private void initView(Context context) &#123;</div><div class="line">        WindowManager wm = (WindowManager) context.getSystemService(</div><div class="line">                Context.WINDOW_SERVICE);</div><div class="line">        DisplayMetrics dm = new DisplayMetrics();</div><div class="line">        wm.getDefaultDisplay().getMetrics(dm);</div><div class="line">        mScreenHeight = dm.heightPixels;</div><div class="line">        mScroller = new Scroller(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onLayout(boolean changed,</div><div class="line">                            int l, int t, int r, int b) &#123;</div><div class="line">        int childCount = getChildCount();</div><div class="line">        // è®¾ç½®ViewGroupçš„é«˜åº¦</div><div class="line">        MarginLayoutParams mlp = (MarginLayoutParams) getLayoutParams();</div><div class="line">        mlp.height = mScreenHeight * childCount;</div><div class="line">        setLayoutParams(mlp);</div><div class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</div><div class="line">            View child = getChildAt(i);</div><div class="line">            if (child.getVisibility() != View.GONE) &#123;</div><div class="line">                child.layout(l, i * mScreenHeight,</div><div class="line">                        r, (i + 1) * mScreenHeight);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected void onMeasure(int widthMeasureSpec,</div><div class="line">                             int heightMeasureSpec) &#123;</div><div class="line">        super.onMeasure(widthMeasureSpec, heightMeasureSpec);</div><div class="line">        int count = getChildCount();</div><div class="line">        for (int i = 0; i &lt; count; ++i) &#123;</div><div class="line">            View childView = getChildAt(i);</div><div class="line">            measureChild(childView,</div><div class="line">                    widthMeasureSpec, heightMeasureSpec);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</div><div class="line">        int y = (int) event.getY();</div><div class="line">        switch (event.getAction()) &#123;</div><div class="line">            case MotionEvent.ACTION_DOWN:</div><div class="line">                mLastY = y;</div><div class="line">                mStart = getScrollY();</div><div class="line">                break;</div><div class="line">            case MotionEvent.ACTION_MOVE:</div><div class="line">                if (!mScroller.isFinished()) &#123;</div><div class="line">                    mScroller.abortAnimation();</div><div class="line">                &#125;</div><div class="line">                int dy = mLastY - y;</div><div class="line">                if (getScrollY() &lt; 0) &#123;</div><div class="line">                    dy = 0;</div><div class="line">                &#125;</div><div class="line">                if (getScrollY() &gt; getHeight() - mScreenHeight) &#123;</div><div class="line">                    dy = 0;</div><div class="line">                &#125;</div><div class="line">                scrollBy(0, dy);</div><div class="line">                mLastY = y;</div><div class="line">                break;</div><div class="line">            case MotionEvent.ACTION_UP:</div><div class="line">                int dScrollY = checkAlignment();</div><div class="line">                if (dScrollY &gt; 0) &#123;</div><div class="line">                    if (dScrollY &lt; mScreenHeight / 3) &#123;</div><div class="line">                        mScroller.startScroll(</div><div class="line">                                0, getScrollY(),</div><div class="line">                                0, -dScrollY);</div><div class="line">                    &#125; else &#123;</div><div class="line">                        mScroller.startScroll(</div><div class="line">                                0, getScrollY(),</div><div class="line">                                0, mScreenHeight - dScrollY);</div><div class="line">                    &#125;</div><div class="line">                &#125; else &#123;</div><div class="line">                    if (-dScrollY &lt; mScreenHeight / 3) &#123;</div><div class="line">                        mScroller.startScroll(</div><div class="line">                                0, getScrollY(),</div><div class="line">                                0, -dScrollY);</div><div class="line">                    &#125; else &#123;</div><div class="line">                        mScroller.startScroll(</div><div class="line">                                0, getScrollY(),</div><div class="line">                                0, -mScreenHeight - dScrollY);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                break;</div><div class="line">        &#125;</div><div class="line">        postInvalidate();</div><div class="line">        return true;</div><div class="line">    &#125;</div><div class="line">    private int checkAlignment() &#123;</div><div class="line">        int mEnd = getScrollY();</div><div class="line">        boolean isUp = ((mEnd - mStart) &gt; 0) ? true : false;</div><div class="line">        int lastPrev = mEnd % mScreenHeight;</div><div class="line">        int lastNext = mScreenHeight - lastPrev;</div><div class="line">        if (isUp) &#123;</div><div class="line">            //å‘ä¸Šçš„</div><div class="line">            return lastPrev;</div><div class="line">        &#125; else &#123;</div><div class="line">            return -lastNext;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    @Override</div><div class="line">    public void computeScroll() &#123;</div><div class="line">        super.computeScroll();</div><div class="line">        if (mScroller.computeScrollOffset()) &#123;</div><div class="line">            scrollTo(0, mScroller.getCurrY());</div><div class="line">            postInvalidate();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="äº‹ä»¶æ‹¦æˆªæœºåˆ¶åˆ†æ">äº‹ä»¶æ‹¦æˆªæœºåˆ¶åˆ†æ</h1><p>xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;RelativeLayout</div><div class="line">    android:id=&quot;@+id/activity_view_group&quot;</div><div class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;</div><div class="line">    android:paddingBottom=&quot;@dimen/activity_vertical_margin&quot;</div><div class="line">    android:paddingLeft=&quot;@dimen/activity_horizontal_margin&quot;</div><div class="line">    android:paddingRight=&quot;@dimen/activity_horizontal_margin&quot;</div><div class="line">    android:paddingTop=&quot;@dimen/activity_vertical_margin&quot;</div><div class="line">    tools:context=&quot;com.wpmac.androidhero.unit3.ViewGroupActivity&quot;&gt;</div><div class="line">    &lt;com.wpmac.androidhero.unit3.viewgroup.MyViewGroupA</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;match_parent&quot;</div><div class="line">        android:background=&quot;@android:color/holo_blue_bright&quot;&gt;</div><div class="line"></div><div class="line">        &lt;com.wpmac.androidhero.unit3.viewgroup.MyViewGroupB</div><div class="line">            android:layout_width=&quot;300dp&quot;</div><div class="line">            android:layout_height=&quot;300dp&quot;</div><div class="line">            android:background=&quot;@android:color/holo_green_dark&quot;&gt;</div><div class="line"></div><div class="line">            &lt;com.wpmac.androidhero.unit3.viewgroup.MyView</div><div class="line">                android:layout_width=&quot;150dp&quot;</div><div class="line">                android:layout_height=&quot;150dp&quot;</div><div class="line">                android:background=&quot;@android:color/darker_gray&quot; /&gt;</div><div class="line"></div><div class="line">        &lt;/com.wpmac.androidhero.unit3.viewgroup.MyViewGroupB&gt;</div><div class="line"></div><div class="line">    &lt;/com.wpmac.androidhero.unit3.viewgroup.MyViewGroupA&gt;</div><div class="line">&lt;/RelativeLayout&gt;</div></pre></td></tr></table></figure>
<p>ViewGroupB-ViewGroupA-View ä¾æ¬¡åµŒå¥—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">public class MyViewGroupA extends LinearLayout &#123;</div><div class="line"></div><div class="line">    public MyViewGroupA(Context context) &#123;</div><div class="line">        super(context);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyViewGroupA(Context context, AttributeSet attrs) &#123;</div><div class="line">        super(context, attrs);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public MyViewGroupA(Context context, AttributeSet attrs,</div><div class="line">                        int defStyleAttr) &#123;</div><div class="line">        super(context, attrs, defStyleAttr);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</div><div class="line">        Log.d(&quot;xys&quot;, &quot;ViewGroupA dispatchTouchEvent&quot; + ev.getAction());</div><div class="line">        return super.dispatchTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public boolean onInterceptTouchEvent(MotionEvent ev) &#123;</div><div class="line">        Log.d(&quot;xys&quot;, &quot;ViewGroupA onInterceptTouchEvent&quot; + ev.getAction());</div><div class="line">        return super.onInterceptTouchEvent(ev);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</div><div class="line">        Log.d(&quot;xys&quot;, &quot;ViewGroupA onTouchEvent&quot; + event.getAction());</div><div class="line">        return super.onTouchEvent(event);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>ViewGroupç›‘å¬dispatchTouchEventï¼ŒonTouchEventï¼ŒonInterceptTouchEventæ–¹æ³•</li>
<li>Viewæ‰“å°dispatchTouchEventï¼ŒonTouchEventæ–¹æ³•</li>
<li>ViewGroupæ¯”Viewå¤šä¸€ä¸ªonInterceptTouchEventæ–¹æ³•</li>
</ul>
<h2 id="ä¸€èˆ¬æƒ…å†µï¼Œç‚¹å‡»View">ä¸€èˆ¬æƒ…å†µï¼Œç‚¹å‡»View</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: ViewGroupB onInterceptTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: View dispatchTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: View onTouchEvent0</div><div class="line">11-10 14:17:38.782 27002-27002/com.wpmac.androidhero D/xys: ViewGroupB onTouchEvent0</div><div class="line">11-10 14:17:38.783 27002-27002/com.wpmac.androidhero D/xys: ViewGroupA onTouchEvent0</div></pre></td></tr></table></figure>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/86008071.jpg" alt=""><br><a href="https://github.com/mzeht/AndroidHero" target="_blank" rel="external">æ‰€æœ‰Demoåœ°å€</a></p>
<hr>
<p>ViewGroupAæ‹¦æˆª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public boolean onInterceptTouchEvent(MotionEvent ev) &#123;</div><div class="line">    Log.d(&quot;xys&quot;, &quot;ViewGroupA onInterceptTouchEvent&quot; + ev.getAction());</div><div class="line">    return true;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ—¥å¿—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">11-10 16:08:24.717 23761-23761/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent0</div><div class="line">11-10 16:08:24.717 23761-23761/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent0</div><div class="line">11-10 16:08:24.717 23761-23761/com.wpmac.androidhero D/xys: ViewGroupA onTouchEvent0</div></pre></td></tr></table></figure>
<h2 id=""><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/6102134.jpg" alt=""></h2><p>ViewGroupAä¸æ‹¦æˆªï¼ŒViewGroupBæ‹¦æˆª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent0![]()</div><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent0</div><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent0</div><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupB onInterceptTouchEvent0</div><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupB onTouchEvent0</div><div class="line">11-10 16:15:49.484 28880-28880/com.wpmac.androidhero D/xys: ViewGroupA onTouchEvent0</div></pre></td></tr></table></figure>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/954580.jpg" alt=""></p>
<hr>
<p>View onTouchEvenè®¾ç½®ä¸ºtrue</p>
<p>event.getAction() è·å¾—çš„è¿”å›å€¼ï¼š</p>
<p>//è§¦æ‘¸å±å¹•æ—¶åˆ»<br>case MotionEvent.ACTION_DOWN:  // = 0</p>
<p>break;<br>//è§¦æ‘¸å¹¶ç§»åŠ¨æ—¶åˆ»<br>case MotionEvent.ACTION_MOVE:  // = 2</p>
<p>break;</p>
<p>//ç»ˆæ­¢è§¦æ‘¸æ—¶åˆ»<br>case MotionEvent.ACTION_UP:  // = 1<br>break;</p>
<hr>
<p>ä»…ä»…View onTouchEventè®¾ç½®return true</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">11-10 17:13:44.984 27187-27187/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent0</div><div class="line">11-10 17:13:44.984 27187-27187/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent0</div><div class="line">11-10 17:13:44.984 27187-27187/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent0</div><div class="line">11-10 17:13:44.984 27187-27187/com.wpmac.androidhero D/xys: ViewGroupB onInterceptTouchEvent0</div><div class="line">11-10 17:13:44.984 27187-27187/com.wpmac.androidhero D/xys: View dispatchTouchEvent0</div><div class="line">11-10 17:13:44.985 27187-27187/com.wpmac.androidhero D/xys: View onTouchEvent0</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent1</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent1</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent1</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: ViewGroupB onInterceptTouchEvent1</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: View dispatchTouchEvent1</div><div class="line">11-10 17:13:45.012 27187-27187/com.wpmac.androidhero D/xys: View onTouchEvent1</div></pre></td></tr></table></figure>
<p>ViewGroupB onTouchEvent è®¾ç½®ä¸ºtrue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: ViewGroupB onInterceptTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: View dispatchTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: View onTouchEvent0</div><div class="line">11-10 17:33:53.022 5387-5387/com.wpmac.androidhero D/xys: ViewGroupB onTouchEvent0</div><div class="line">11-10 17:33:53.096 5387-5387/com.wpmac.androidhero D/xys: ViewGroupA dispatchTouchEvent1</div><div class="line">11-10 17:33:53.096 5387-5387/com.wpmac.androidhero D/xys: ViewGroupA onInterceptTouchEvent1</div><div class="line">11-10 17:33:53.096 5387-5387/com.wpmac.androidhero D/xys: ViewGroupB dispatchTouchEvent1</div><div class="line">11-10 17:33:53.096 5387-5387/com.wpmac.androidhero D/xys: ViewGroupB onTouchEvent1</div></pre></td></tr></table></figure>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/public/16-11-10/470111.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="Viewçš„æµ‹é‡">Viewçš„æµ‹é‡</h1><p>Androidå¸®åŠ©æµ‹é‡Viewçš„ç±»â€”<code>MeasureSpec</code>ç±»<br>MeasureSpecæ˜¯ä¸€ä¸ª32ä½çš„intå€¼ï¼Œé«˜ä¸¤ä½ä¸ºæµ‹é‡çš„æ¨¡å¼ï¼Œä½30ä½ä¸ºæµ‹é‡çš„å¤§å°<br>ä½¿ç”¨ä½è¿ç®—æé«˜å¹¶ä¼˜åŒ–æ•ˆç‡</p>]]>
    
    </summary>
    
      <category term="Android" scheme="http://mzeht.com/tags/Android/"/>
    
      <category term="è‡ªå®šä¹‰æ§ä»¶" scheme="http://mzeht.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="AndroidHero" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/AndroidHero/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[butterknife 8.0.1 AndroidStudio peizhi]]></title>
    <link href="http://mzeht.com/2016/09/08/butterknife-8-0-1-AndroidStudio-%E9%85%8D%E7%BD%AE/"/>
    <id>http://mzeht.com/2016/09/08/butterknife-8-0-1-AndroidStudio-é…ç½®/</id>
    <published>2016-09-08T11:18:29.000Z</published>
    <updated>2016-11-27T10:20:44.000Z</updated>
    <content type="html"><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1><p>butterknifeæ˜¯ä¸€ä¸ªandroidä¸Šçš„æ³¨è§£åº“ï¼Œå‡çº§çš„å¾ˆå¿«ï¼Œåœ¨7.0.1ç‰ˆæœ¬ä¸­åªè¦æ·»åŠ ä¾èµ–å°±å¯ä»¥äº†ï¼Œä½†æ˜¯8.0.1ç‰ˆæœ¬ä¸­é…ç½®ç¨æœ‰ä¸åŒ</p>
<a id="more"></a>
<h2 id="åœ¨project_ä¸‹çš„build-gradleæ–‡ä»¶ä¸‹é…ç½®classpath">åœ¨project ä¸‹çš„build.gradleæ–‡ä»¶ä¸‹é…ç½®classpath</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">    dependencies &#123;</div><div class="line"></div><div class="line">        classpath &apos;com.android.tools.build:gradle:2.1.3&apos;</div><div class="line">        classpath &apos;com.neenbedankt.gradle.plugins:android-apt:1.8&apos;</div><div class="line"></div><div class="line">        // NOTE: Do not place your application dependencies here; they belong</div><div class="line">        // in the individual module build.gradle files</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="åœ¨moudleä¸‹çš„builde-gradleæ–‡ä»¶ä¸­é…ç½®plugin">åœ¨moudleä¸‹çš„builde.gradleæ–‡ä»¶ä¸­é…ç½®plugin</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;com.android.application&apos;</div><div class="line">apply plugin: &apos;com.neenbedankt.android-apt&apos;</div></pre></td></tr></table></figure>
<h2 id="åœ¨moudleä¸‹çš„builde-gradleæ–‡ä»¶ä¸­é…ç½®dependencies">åœ¨moudleä¸‹çš„builde.gradleæ–‡ä»¶ä¸­é…ç½®dependencies</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;]</div><div class="line">    compile &apos;com.jakewharton:butterknife:8.0.1&apos;</div><div class="line">    apt &apos;com.jakewharton:butterknife-compiler:8.0.1&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>butterknifeä¹‹æ‰€ä»¥é…ç½®å˜åŒ–è¿™ä¹ˆå¤§ï¼Œä¸»è¦æ˜¯åœ¨äºaptï¼Œå–ä»£äº†ä¹‹å‰çš„æ³¨è§£å®ç°æ–¹æ³•</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1><p>butterknifeæ˜¯ä¸€ä¸ªandroidä¸Šçš„æ³¨è§£åº“ï¼Œå‡çº§çš„å¾ˆå¿«ï¼Œåœ¨7.0.1ç‰ˆæœ¬ä¸­åªè¦æ·»åŠ ä¾èµ–å°±å¯ä»¥äº†ï¼Œä½†æ˜¯8.0.1ç‰ˆæœ¬ä¸­é…ç½®ç¨æœ‰ä¸åŒ</p>]]>
    
    </summary>
    
      <category term="AndroidStudio" scheme="http://mzeht.com/tags/AndroidStudio/"/>
    
      <category term="Butterknife" scheme="http://mzeht.com/tags/Butterknife/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="Android" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Intellij IDEA Mac OS X KeyMap ä¸­æ–‡ç‰ˆ]]></title>
    <link href="http://mzeht.com/2016/09/07/Intellij-IDEA-Mac-OS-X-KeyMap-%E4%B8%AD%E6%96%87%E7%89%88/"/>
    <id>http://mzeht.com/2016/09/07/Intellij-IDEA-Mac-OS-X-KeyMap-ä¸­æ–‡ç‰ˆ/</id>
    <published>2016-09-07T10:52:50.000Z</published>
    <updated>2016-11-27T10:20:55.000Z</updated>
    <content type="html"><![CDATA[<h1 id="å®˜æ–¹ç‰ˆæœ¬">å®˜æ–¹ç‰ˆæœ¬</h1><p><a href="https://resources.jetbrains.com/assets/products/intellij-idea/IntelliJIDEA_ReferenceCard_mac.pdf" target="_blank" rel="external">å®˜æ–¹ç‰ˆæœ¬</a></p>
<h1 id="ç¿»è¯‘ç‰ˆæœ¬é¢„è§ˆ">ç¿»è¯‘ç‰ˆæœ¬é¢„è§ˆ</h1><p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-9-7/44368370.jpg" alt=""></p>
<h1 id="ç¿»è¯‘ç‰ˆæœ¬ä¸‹è½½">ç¿»è¯‘ç‰ˆæœ¬ä¸‹è½½</h1><p><a href="https://www.jianguoyun.com/p/DSblRVAQpN36BRi7jBs" target="_blank" rel="external">Wordç‰ˆæœ¬ä¸‹è½½</a></p>
<p><a href="https://www.jianguoyun.com/p/DSMleAUQpN36BRi9jBs" target="_blank" rel="external">PDFç‰ˆæœ¬ä¸‹è½½</a></p>
<p><a href="https://www.jianguoyun.com/p/DQuCALMQpN36BRi-jBs" target="_blank" rel="external">JPGç‰ˆæœ¬ä¸‹è½½</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="å®˜æ–¹ç‰ˆæœ¬">å®˜æ–¹ç‰ˆæœ¬</h1><p><a href="https://resources.jetbrains.com/assets/products/intellij-idea/IntelliJIDEA_ReferenceCard_mac.pdf" target=]]>
    </summary>
    
      <category term="Mac" scheme="http://mzeht.com/tags/Mac/"/>
    
      <category term="Intellij IDEA" scheme="http://mzeht.com/tags/Intellij-IDEA/"/>
    
      <category term="å·¥å…·" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="IDE" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/IDE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android Studio Gradle è¿›é˜¶è®¾ç½®]]></title>
    <link href="http://mzeht.com/2016/09/07/Android-Studio-Gradle-%E8%BF%9B%E9%98%B6%E8%AE%BE%E7%BD%AE/"/>
    <id>http://mzeht.com/2016/09/07/Android-Studio-Gradle-è¿›é˜¶è®¾ç½®/</id>
    <published>2016-09-06T17:10:55.000Z</published>
    <updated>2016-11-27T10:21:04.000Z</updated>
    <content type="html"><![CDATA[<h2 id="é…ç½®ç‹¬ç«‹çš„ç­¾åä¿¡æ¯">é…ç½®ç‹¬ç«‹çš„ç­¾åä¿¡æ¯</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠç­¾åçš„ä¿¡æ¯æ˜æ–‡å†™åœ¨gradleé…ç½®æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åœ¨å¤šäººåä½œæˆ–è€…å¼€æºä»£ç çš„æ—¶å€™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå‰è€…å¯èƒ½å­˜æ”¾ç­¾åæ–‡ä»¶çš„ä½ç½®éœ€è¦ä¿®æ”¹ï¼Œåè€…åˆ™å¸Œæœ›éšè—ç­¾åä¿¡æ¯ï¼Œåœ¨çœ‹ä¸å°‘å¼€æºé¡¹ç›®çš„æ—¶å€™ï¼Œå‘ç°å¾ˆå¤šæ˜¯è¿™æ ·åšçš„</p>
<a id="more"></a>
<p>signingConfigsä½ç½®ï¼Œ <code>androidçš„ä¸‹ä¸€çº§</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">signingConfigs &#123;</div><div class="line">        release &#123;</div><div class="line">            storeFile file(RELEASE_STORE_FILE)</div><div class="line">            storePassword RELEASE_STORE_PASSWORD</div><div class="line">            keyAlias RELEASE_KEY_ALIAS</div><div class="line">            keyPassword RELEASE_KEY_PASSWORD</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>åœ¨å¯¹åº”ä½ç½®å¼•ç”¨å¸¸é‡ï¼Œåœ¨propertiesä¸­å†è¿›è¡Œå…·ä½“èµ‹å€¼<br>åœ¨gradle.propertiesä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">RELEASE_KEY_PASSWORD=xxxx</div><div class="line">RELEASE_KEY_ALIAS=xxx</div><div class="line">RELEASE_STORE_PASSWORD=xxx</div><div class="line">RELEASE_STORE_FILE=../.keystore/xxx.jks</div></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸ä¼šç›´æ¥æš´éœ²ç­¾åä¿¡æ¯ï¼Œä¹Ÿæ–¹ä¾¿é…ç½®</p>
<h2 id="å¤šæ¸ é“æ‰“åŒ…">å¤šæ¸ é“æ‰“åŒ…</h2><p>åœ¨product flavorä¸‹å®šä¹‰ä¸åŒç±»å‹, æŠŠAndroiManifestä¸­çš„channelæ›¿æ¢</p>
<p>productFlavorsä½ç½®ï¼š <code>androidçš„ä¸‹ä¸€çº§</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">      productFlavors &#123;</div><div class="line">        fir &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;fir&quot;]</div><div class="line">        &#125;</div><div class="line">        GooglePlay &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;GooglePlay&quot;]</div><div class="line">        &#125;</div><div class="line">        Umeng &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;Umeng&quot;]</div><div class="line">        &#125;</div><div class="line">       </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœflavoræ ‡è¯†æ˜¯æ•°å­—å¼€å¤´ï¼Œè¦åŠ ä»¥å¤„ç†ï¼Œæ·»åŠ â€â€</p>
<p>æ›¿æ¢AndroiManifestä¸­çš„å­—æ®µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;meta-data</div><div class="line">    android:name=&quot;UMENG_CHANNEL&quot;</div><div class="line">    android:value=&quot;$&#123;UMENG_CHANNEL_VALUE&#125;&quot;/&gt;</div></pre></td></tr></table></figure>
<h2 id="å®šåˆ¶ç”Ÿæˆapkæ–‡ä»¶åç§°">å®šåˆ¶ç”Ÿæˆapkæ–‡ä»¶åç§°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">def buildTime() &#123;</div><div class="line">    return new Date().format(&quot;yyyy-MM-dd HH:mm:ss&quot;)</div><div class="line">&#125;</div><div class="line">def hostName() &#123;</div><div class="line">    return System.getProperty(&quot;user.name&quot;) + &quot;@&quot; + InetAddress.localHost.hostName</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">android &#123;</div><div class="line"></div><div class="line">   //...</div><div class="line">   </div><div class="line">    productFlavors &#123;</div><div class="line">        fir &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;fir&quot;]</div><div class="line">        &#125;</div><div class="line">        GooglePlay &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;GooglePlay&quot;]</div><div class="line">        &#125;</div><div class="line">        Umeng &#123;</div><div class="line">            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &quot;Umeng&quot;]</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">   buildTypes &#123;</div><div class="line">        release &#123;</div><div class="line">            minifyEnabled true</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">            signingConfig signingConfigs.app1</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    applicationVariants.all &#123; variant -&gt;</div><div class="line">        variant.outputs.each &#123; output -&gt;</div><div class="line">            def outputFile = output.outputFile</div><div class="line">            if (outputFile != null &amp;&amp; outputFile.name.endsWith(&apos;.apk&apos;)) &#123;</div><div class="line"></div><div class="line">                def fileName = &quot;mzeht_v$&#123;defaultConfig.versionName&#125;_$&#123;hostName()&#125;_$&#123;buildTime()&#125;_$&#123;variant.productFlavors[0].name&#125;.apk&quot;</div><div class="line">                output.outputFile = new File(outputFile.parent, fileName)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åŒæ ·æ³¨æ„å±‚çº§å…³ç³»,åœ¨androidåŒçº§ä¸‹å®šä¹‰ä¸€ä¸ªæ—¶é—´å‡½æ•°å’Œä¸€ä¸ªhostå‡½æ•°å¹¶å¼•ç”¨ï¼Œç”Ÿæˆçš„apkåŒ…å¦‚ä¸‹ï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-9-7/53721167.jpg" alt=""></p>
<h2 id="é…ç½®ä¾èµ–ç‰ˆæœ¬å·">é…ç½®ä¾èµ–ç‰ˆæœ¬å·</h2><p>åœ¨Mavenä¸­æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„å®šä¹‰springç­‰æ ¸å¿ƒä¾èµ–çš„ç‰ˆæœ¬å·ï¼Œä¾¿äºç»Ÿä¸€ç®¡ç†ï¼Œåœ¨Gradleä¸­æˆ‘ä»¬åŒæ ·å¯ä»¥åšåˆ°</p>
<p>åœ¨çœ‹googleçš„æ¶æ„ç»¼åˆé¡¹ç›®æ—¶<a href="https://github.com/googlesamples/android-architecture/tree/todo-mvp/" target="_blank" rel="external">todo-mvp</a>,çœ‹è§äº†ä¸€ç§å†™æ³•</p>
<p>åœ¨æ ¹ç›®å½•ä¸‹çš„build.gradleæ–‡ä»¶ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">    dependencies &#123;</div><div class="line">        classpath &apos;com.android.tools.build:gradle:2.1.2&apos;</div><div class="line"></div><div class="line">        // NOTE: Do not place your application dependencies here; they belong</div><div class="line">        // in the individual module build.gradle files</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">allprojects &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">task clean(type: Delete) &#123;</div><div class="line">    delete rootProject.buildDir</div><div class="line">&#125;</div><div class="line"></div><div class="line">// Define versions in a single place</div><div class="line">ext &#123;</div><div class="line">    // Sdk and tools</div><div class="line">    minSdkVersion = 10</div><div class="line">    targetSdkVersion = 22</div><div class="line">    compileSdkVersion = 23</div><div class="line">    buildToolsVersion = &apos;23.0.2&apos;</div><div class="line"></div><div class="line">    // App dependencies</div><div class="line">    supportLibraryVersion = &apos;23.4.0&apos;</div><div class="line">    guavaVersion = &apos;18.0&apos;</div><div class="line">    junitVersion = &apos;4.12&apos;</div><div class="line">    mockitoVersion = &apos;1.10.19&apos;</div><div class="line">    powerMockito = &apos;1.6.2&apos;</div><div class="line">    hamcrestVersion = &apos;1.3&apos;</div><div class="line">    runnerVersion = &apos;0.4.1&apos;</div><div class="line">    rulesVersion = &apos;0.4.1&apos;</div><div class="line">    espressoVersion = &apos;2.2.1&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨appçš„build.gradleä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;com.android.application&apos;</div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion rootProject.ext.compileSdkVersion</div><div class="line">    buildToolsVersion rootProject.ext.buildToolsVersion</div><div class="line"></div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId &quot;com.example.android.architecture.blueprints.todomvp&quot;</div><div class="line">        minSdkVersion rootProject.ext.minSdkVersion</div><div class="line">        targetSdkVersion rootProject.ext.targetSdkVersion</div><div class="line">        versionCode 1</div><div class="line">        versionName &quot;1.0&quot;</div><div class="line"></div><div class="line">        testInstrumentationRunner &apos;android.support.test.runner.AndroidJUnitRunner&apos;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    buildTypes &#123;</div><div class="line">        debug &#123;</div><div class="line">            minifyEnabled true</div><div class="line">            // Uses new built-in shrinker http://tools.android.com/tech-docs/new-build-system/built-in-shrinker</div><div class="line">            useProguard false</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">            testProguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguardTest-rules.pro&apos;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        release &#123;</div><div class="line">            minifyEnabled true</div><div class="line">            useProguard true</div><div class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</div><div class="line">            testProguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguardTest-rules.pro&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // If you need to add more flavors, consider using flavor dimensions.</div><div class="line">    productFlavors &#123;</div><div class="line">        mock &#123;</div><div class="line">            applicationIdSuffix = &quot;.mock&quot;</div><div class="line">        &#125;</div><div class="line">        prod &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Remove mockRelease as it&apos;s not needed.</div><div class="line">    android.variantFilter &#123; variant -&gt;</div><div class="line">        if(variant.buildType.name.equals(&apos;release&apos;)</div><div class="line">                &amp;&amp; variant.getFlavors().get(0).name.equals(&apos;mock&apos;)) &#123;</div><div class="line">            variant.setIgnore(true);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Always show the result of every unit test, even if it passes.</div><div class="line">    testOptions.unitTests.all &#123;</div><div class="line">        testLogging &#123;</div><div class="line">            events &apos;passed&apos;, &apos;skipped&apos;, &apos;failed&apos;, &apos;standardOut&apos;, &apos;standardError&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> Dependency versions are defined in the top level build.gradle file. This helps keeping track of</div><div class="line"> all versions in a single place. This improves readability and helps managing project complexity.</div><div class="line"> */</div><div class="line">dependencies &#123;</div><div class="line">    // App&apos;s dependencies, including test</div><div class="line">    compile &quot;com.android.support:appcompat-v7:$rootProject.supportLibraryVersion&quot;</div><div class="line">    compile &quot;com.android.support:cardview-v7:$rootProject.supportLibraryVersion&quot;</div><div class="line">    compile &quot;com.android.support:design:$rootProject.supportLibraryVersion&quot;</div><div class="line">    compile &quot;com.android.support:recyclerview-v7:$rootProject.supportLibraryVersion&quot;</div><div class="line">    compile &quot;com.android.support:support-v4:$rootProject.supportLibraryVersion&quot;</div><div class="line">    compile &quot;com.android.support.test.espresso:espresso-idling-resource:$rootProject.espressoVersion&quot;</div><div class="line">    compile &quot;com.google.guava:guava:$rootProject.guavaVersion&quot;</div><div class="line"></div><div class="line">    // Dependencies for local unit tests</div><div class="line">    testCompile &quot;junit:junit:$rootProject.ext.junitVersion&quot;</div><div class="line">    testCompile &quot;org.mockito:mockito-all:$rootProject.ext.mockitoVersion&quot;</div><div class="line">    testCompile &quot;org.hamcrest:hamcrest-all:$rootProject.ext.hamcrestVersion&quot;</div><div class="line"></div><div class="line">    // Android Testing Support Library&apos;s runner and rules</div><div class="line">    androidTestCompile &quot;com.android.support.test:runner:$rootProject.ext.runnerVersion&quot;</div><div class="line">    androidTestCompile &quot;com.android.support.test:rules:$rootProject.ext.runnerVersion&quot;</div><div class="line"></div><div class="line">    // Dependencies for Android unit tests</div><div class="line">    androidTestCompile &quot;junit:junit:$rootProject.ext.junitVersion&quot;</div><div class="line">    androidTestCompile &quot;org.mockito:mockito-core:$rootProject.ext.mockitoVersion&quot;</div><div class="line">    androidTestCompile &apos;com.google.dexmaker:dexmaker:1.2&apos;</div><div class="line">    androidTestCompile &apos;com.google.dexmaker:dexmaker-mockito:1.2&apos;</div><div class="line"></div><div class="line">    // Espresso UI Testing</div><div class="line">    androidTestCompile &quot;com.android.support.test.espresso:espresso-core:$rootProject.espressoVersion&quot;</div><div class="line">    androidTestCompile (&quot;com.android.support.test.espresso:espresso-contrib:$rootProject.espressoVersion&quot;)</div><div class="line">    androidTestCompile &quot;com.android.support.test.espresso:espresso-intents:$rootProject.espressoVersion&quot;</div><div class="line"></div><div class="line">    // Resolve conflicts between main and test APK:</div><div class="line">    androidTestCompile &quot;com.android.support:support-annotations:$rootProject.supportLibraryVersion&quot;</div><div class="line">    androidTestCompile &quot;com.android.support:support-v4:$rootProject.supportLibraryVersion&quot;</div><div class="line">    androidTestCompile &quot;com.android.support:recyclerview-v7:$rootProject.supportLibraryVersion&quot;</div></pre></td></tr></table></figure>
<h2 id="å‡å°‘ç¼–è¯‘é”™è¯¯å’Œå¿½ç•¥lintæ£€æŸ¥">å‡å°‘ç¼–è¯‘é”™è¯¯å’Œå¿½ç•¥lintæ£€æŸ¥</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">packagingOptions &#123;</div><div class="line">        exclude &apos;META-INF/DEPENDENCIES.txt&apos;</div><div class="line">        exclude &apos;META-INF/LICENSE.txt&apos;</div><div class="line">        exclude &apos;META-INF/NOTICE.txt&apos;</div><div class="line">        exclude &apos;META-INF/NOTICE&apos;</div><div class="line">        exclude &apos;META-INF/LICENSE&apos;</div><div class="line">        exclude &apos;META-INF/DEPENDENCIES&apos;</div><div class="line">        exclude &apos;META-INF/notice.txt&apos;</div><div class="line">        exclude &apos;META-INF/license.txt&apos;</div><div class="line">        exclude &apos;META-INF/dependencies.txt&apos;</div><div class="line">        exclude &apos;META-INF/LGPL2.1&apos;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line">    lintOptions &#123;</div><div class="line">        abortOnError false</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="ç»“è¯­">ç»“è¯­</h2><p>graldeè®¾ç½®ç»“åˆAndroidStudioæä¾›çš„å›¾å½¢ç•Œé¢è®¾ç½®ï¼Œç†è§£ä¼šæ›´å¿«æ›´é€å½»</p>
<p>File-Project Structure-Modules-app</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-9-7/37008097.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="é…ç½®ç‹¬ç«‹çš„ç­¾åä¿¡æ¯">é…ç½®ç‹¬ç«‹çš„ç­¾åä¿¡æ¯</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠç­¾åçš„ä¿¡æ¯æ˜æ–‡å†™åœ¨gradleé…ç½®æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åœ¨å¤šäººåä½œæˆ–è€…å¼€æºä»£ç çš„æ—¶å€™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå‰è€…å¯èƒ½å­˜æ”¾ç­¾åæ–‡ä»¶çš„ä½ç½®éœ€è¦ä¿®æ”¹ï¼Œåè€…åˆ™å¸Œæœ›éšè—ç­¾åä¿¡æ¯ï¼Œåœ¨çœ‹ä¸å°‘å¼€æºé¡¹ç›®çš„æ—¶å€™ï¼Œå‘ç°å¾ˆå¤šæ˜¯è¿™æ ·åšçš„</p>]]>
    
    </summary>
    
      <category term="Android Studio" scheme="http://mzeht.com/tags/Android-Studio/"/>
    
      <category term="Gradle" scheme="http://mzeht.com/tags/Gradle/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="Android" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Data Binding Guide]]></title>
    <link href="http://mzeht.com/2016/09/04/Data-Binding-Guide/"/>
    <id>http://mzeht.com/2016/09/04/Data-Binding-Guide/</id>
    <published>2016-09-04T06:37:50.000Z</published>
    <updated>2016-11-27T10:21:15.000Z</updated>
    <content type="html"><![CDATA[<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-9-4/6040336.jpg" alt=""></p>
<h2 id="å‰è¨€">å‰è¨€</h2><p>2016çš„Google IO å¤§ä¼šä¸Šï¼ŒAndroid å›¢é˜Ÿå‘å¸ƒäº†ä¸€ä¸ªæ•°æ®ç»‘å®šæ¡†æ¶ï¼ˆData Binding Libraryï¼‰ã€‚ä»¥åå¯ä»¥ç›´æ¥åœ¨ layout å¸ƒå±€ xml æ–‡ä»¶ä¸­ç»‘å®šæ•°æ®äº†ï¼Œæ— éœ€å† findViewById ç„¶åæ‰‹å·¥è®¾ç½®æ•°æ®äº†ã€‚å…¶è¯­æ³•å’Œä½¿ç”¨æ–¹å¼å’Œ JSP ä¸­çš„ EL è¡¨è¾¾å¼éå¸¸ç±»ä¼¼ã€‚</p>
<p>çœ‹åˆ°googleå‡ºå“çš„<a href="https://developer.android.com/topic/libraries/data-binding/index.html" target="_blank" rel="external">Data Binding Library</a>æœ¬æ¥æ˜¯æƒ³è¾¹ç¿»è¯‘è¾¹å†™å†™demoï¼Œä½†æ˜¯csdnä¸Šå·²ç»æœ‰äººç¿»è¯‘äº†ï¼Œæ²¡å¿…è¦é‡å¤åŠ³åŠ¨ï¼Œç›´æ¥æ‹¿æ¥é“¾æ¥ï¼š<br><a id="more"></a></p>
<h1 id="Data_Binding_Guideâ€”â€”googleå®˜æ–¹æ–‡æ¡£ç¿»è¯‘ï¼ˆä¸Šï¼‰"><a href="http://blog.csdn.net/u014486880/article/details/50508133" target="_blank" rel="external">Data Binding Guideâ€”â€”googleå®˜æ–¹æ–‡æ¡£ç¿»è¯‘ï¼ˆä¸Šï¼‰</a></h1><h1 id="Data_Binding_Guideâ€”â€”googleå®˜æ–¹æ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‹ï¼‰"><a href="http://blog.csdn.net/u014486880/article/details/50531110" target="_blank" rel="external"> Data Binding Guideâ€”â€”googleå®˜æ–¹æ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‹ï¼‰</a></h1><h2 id="é˜²å‘æŒ‡å—">é˜²å‘æŒ‡å—</h2><p>å¼•å…¥DataBindingLibraryä»æœ€åˆå‘å¸ƒå¼€å§‹ï¼Œå·²ç»æœ‰äº†å˜åŒ–ï¼Œèµ·åˆæ˜¯</p>
<p>åœ¨é¡¹ç›®çš„ gradle é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–é¡¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dependencies &#123; classpath &quot;com.android.tools.build:gradle:1.2.3&quot; classpath &quot;com.android.databinding:dataBinder:1.0-rc0&quot; &#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾èµ–é¡¹ç›®å‰åœ¨ jcenter æœåŠ¡å™¨ä¸­ï¼Œæ‰€ä»¥ç¡®ä¿ repositories ä¸­åŒ…å« jcenterã€‚<br>allprojects { repositories { jcenter() }}</p>
<p>åœ¨æ¯ä¸ªéœ€è¦ä½¿ç”¨ Data Binding åŠŸèƒ½çš„æ¨¡å—çš„ gradle é…ç½®æ–‡ä»¶ä¸­å¯ç”¨è¯¥æ’ä»¶ï¼ˆæ·»åŠ åœ¨ android æ’ä»¶ä¹‹åï¼‰ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply plugin: â€˜com.android.application&apos;apply plugin: &apos;com.android.databinding&apos;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ç°åœ¨çš„googleæ–‡æ¡£ä¸­ åªè¦</p>
<ul>
<li><p>To get started with Data Binding, download the library from the Support repository in the Android SDK manager.</p>
</li>
<li><p>To configure your app to use data binding, add the dataBinding element to your build.gradle file in the app module.</p>
</li>
<li><p>Use the following code snippet to configure data binding:</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">android &#123;</div><div class="line">    ....</div><div class="line">    dataBinding &#123;</div><div class="line">        enabled = true</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="https://github.com/jingle1267/DataDindingSample" target="_blank" rel="external">demo github åœ°å€</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-9-4/6040336.jpg" alt=""></p>
<h2 id="å‰è¨€">å‰è¨€</h2><p>2016çš„Google IO å¤§ä¼šä¸Šï¼ŒAndroid å›¢é˜Ÿå‘å¸ƒäº†ä¸€ä¸ªæ•°æ®ç»‘å®šæ¡†æ¶ï¼ˆData Binding Libraryï¼‰ã€‚ä»¥åå¯ä»¥ç›´æ¥åœ¨ layout å¸ƒå±€ xml æ–‡ä»¶ä¸­ç»‘å®šæ•°æ®äº†ï¼Œæ— éœ€å† findViewById ç„¶åæ‰‹å·¥è®¾ç½®æ•°æ®äº†ã€‚å…¶è¯­æ³•å’Œä½¿ç”¨æ–¹å¼å’Œ JSP ä¸­çš„ EL è¡¨è¾¾å¼éå¸¸ç±»ä¼¼ã€‚</p>
<p>çœ‹åˆ°googleå‡ºå“çš„<a href="https://developer.android.com/topic/libraries/data-binding/index.html">Data Binding Library</a>æœ¬æ¥æ˜¯æƒ³è¾¹ç¿»è¯‘è¾¹å†™å†™demoï¼Œä½†æ˜¯csdnä¸Šå·²ç»æœ‰äººç¿»è¯‘äº†ï¼Œæ²¡å¿…è¦é‡å¤åŠ³åŠ¨ï¼Œç›´æ¥æ‹¿æ¥é“¾æ¥ï¼š<br>]]>
    
    </summary>
    
      <category term="Data Binding" scheme="http://mzeht.com/tags/Data-Binding/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="Android" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/Android/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Mac/windowsä¸‹nexusç³»åˆ—äº§å“çš„åˆ·æœºå®˜æ–¹æŒ‡å—]]></title>
    <link href="http://mzeht.com/2016/07/30/Mac:windows%E4%B8%8Bnexus%E7%B3%BB%E5%88%97%E4%BA%A7%E5%93%81%E7%9A%84%E5%88%B7%E6%9C%BA%E5%AE%98%E6%96%B9%E6%8C%87%E5%8D%97/"/>
    <id>http://mzeht.com/2016/07/30/Mac:windowsä¸‹nexusç³»åˆ—äº§å“çš„åˆ·æœºå®˜æ–¹æŒ‡å—/</id>
    <published>2016-07-30T07:26:44.000Z</published>
    <updated>2016-11-27T10:22:20.000Z</updated>
    <content type="html"><![CDATA[<h1 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h1><p>1.ä»…é’ˆå¯¹å®˜æ–¹é•œåƒ<br>2.éœ€è¦ä¸‹è½½å®˜æ–¹é•œåƒï¼Œéœ€è¦ç¿»å¢™æˆ–è€…å›½å†…å¯»æ‰¾æ¬è¿èµ„æº<br>3.nexusåˆ·å…¥æ–°ç³»ç»Ÿåï¼Œå¼€æœºéœ€è¦ç½‘ç»œéªŒè¯æ¿€æ´»ï¼ˆéƒ¨åˆ†å¯ä»¥è·³è¿‡ï¼‰ï¼Œéœ€è¦ç½‘ç»œç¯å¢ƒèƒ½å¤Ÿç¿»å¢™ï¼Œè¯·è‡ªè¡Œè§£å†³  </p>
<a id="more"></a>
<h1 id="é•œåƒ">é•œåƒ</h1><p>1.å‰å¾€<a href="https://developers.google.com/android/nexus/images" target="_blank" rel="external">é•œåƒå®˜ç½‘</a><br>2.<img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-7-30/11576201.jpg" alt=""><br>å³ä¾§é€‰æ‹©å¯¹åº”çš„è®¾å¤‡,åŒæ„ç›¸å…³åè®®ï¼Œé€‰æ‹©ä¸‹è½½é•œåƒ<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-7-30/27674143.jpg" alt=""><br>è¿™é‡Œä»¥6pä¸ºä¾‹å­ï¼Œé•œåƒåˆ—è¡¨ä»ä¸Šåˆ°ä¸‹ï¼Œä»æ—§åˆ°æ–°</p>
<h1 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h1><p>1.fastbootå·¥å…·  </p>
<p>To flash a device using one of the system images below (or one of your own), you need the latest fastboot tool. You can get it from one of the sources below.</p>
<ul>
<li><p>From a compiled version of the <a href="https://source.android.com/" target="_blank" rel="external">Android Open Source Project</a>.  </p>
</li>
<li><p>From the <code>platform-tools/</code> directory in the Android SDK. Be sure that you have the latest version of the <code>Android SDK Platform-tools</code> from the <a href="https://developer.android.com/studio/intro/update.html" target="_blank" rel="external">SDK Manager</a>.  </p>
</li>
</ul>
<p>Once you have the <code>fastboot tool</code>, add it to your <code>PATH</code> environment variable (the flash-all script below must be able to find it). Also be certain that youâ€™ve set up USB access for your device, as described in the Using <a href="https://developer.android.com/studio/run/device.html" target="_blank" rel="external">Hardware Devices guide</a>.  </p>
<p>Caution: Flashing a new system image deletes all user data. Be certain to first backup any personal data such as photos.</p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ä¸‹è½½fastbootå·¥å…· å¹¶ä¸”æ·»åŠ åˆ°ç³»ç»Ÿå˜é‡ï¼Œæ³¨æ„ç”¨æˆ·æ•°æ®ä¼šè¢«æ¸…ç©º</p>
<h1 id="åˆ·å…¥æ­¥éª¤">åˆ·å…¥æ­¥éª¤</h1><ol>
<li><p>Download the appropriate system image for your device below, then unzip it to a safe directory.  </p>
</li>
<li><p>Connect your device to your computer over USB.  </p>
</li>
<li><p>Start the device in fastboot mode with one of the following methods:</p>
<ul>
<li><p>Using the <code>adb tool</code>: With the device powered on, execute:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb reboot bootloader</div></pre></td></tr></table></figure>
</li>
<li><p>Using a key combo: Turn the device off, then turn it on and immediately hold down the relevant<code>key combination</code> for your device. For example, to put a Nexus 5 (â€œhammerheadâ€) into fastboot mode, press and hold Volume Up + Volume Down + Power as the device begins booting up.  </p>
</li>
</ul>
</li>
<li><p>If necessary, unlock the deviceâ€™s bootloader by running:</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastboot flashing unlock</div></pre></td></tr></table></figure>
<p>or, for older devices, running:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastboot oem unlock</div></pre></td></tr></table></figure>
<p>The target device will show you a confirmation screen. (This erases all data on the target device.)  </p>
<ol>
<li><p>Open a terminal and navigate to the unzipped system image directory.  </p>
</li>
<li><p>Execute the flash-all script. This script installs the necessary bootloader, baseband firmware(s), and operating system.  </p>
</li>
</ol>
<p>Once the script finishes, your device reboots. You should now lock the bootloader for security:</p>
<ol>
<li>Start the device in fastboot mode again, as described above.</li>
<li>Execute:<br>fastboot flashing lock<br>or, for older devices, running:<br>fastboot oem lock</li>
</ol>
<p>Locking bootloader will wipe the data on some devices. After locking the bootloader, if you want to flash the device again, you must run <code>fastboot oem unlock again</code>, which will wipe the data.</p>
<h1 id="ç»“è¯­">ç»“è¯­</h1><p>å·æ‡’ï¼Œç›´æ¥ä¸Šå®˜æ–¹æŒ‡å—äº†ï¼Œä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œï¼ˆæ¯”å¦‚æ€ä¹ˆä¸‹è½½fastbootï¼Œæ€ä¹ˆé…ç½®ç³»ç»Ÿå˜é‡ï¼‰,ç›¸ä¿¡èƒ½çœ‹åˆ°è¿™ç¯‡æ–‡ç« å’Œæœ‰è¿™ä¸ªæ„å‘çš„äººéƒ½èƒ½è§£å†³ã€‚  </p>
<p>é€šè¿‡æ­¤æ–¹æ³•å®Œç¾åˆ©ç”¨macç»™nexus5æ‰‹æœºå’Œnexus7wifiåˆ·å¥½ç³»ç»Ÿ,å‰è€…ç½‘ç»œéªŒè¯å¯ä»¥è·³è¿‡ï¼Œåè€…ä¸è¡Œï¼Œé‡‡ç”¨å¯ä»¥åˆ·å…¥å¼€æºå›ºä»¶çš„è·¯ç”±å™¨ï¼Œåˆ·å…¥openwrtï¼Œè®¾ç½®å¥½socksä»£ç†ï¼ˆä»˜è´¹ç‰ˆï¼‰ï¼Œå³å¯æ— çº¿ç¿»å¢™ï¼Œé¡ºåˆ©æ¿€æ´»ï¼Œwindowsä¸Šå¯ä»¥ç”µè„‘ç¿»å¢™åå…±äº«çƒ­ç‚¹ï¼ŒæœŸé—´è¿˜å°è¯•äº†<code>Privoxy</code>å°†shadowsocksçš„socks5ä»£ç†è½¬ä¸ºhttpä»£ç†,ç„¶åéªŒè¯é˜¶æ®µï¼Œè¿æ¥æ™®é€šwifi,è®¾å¤‡å’Œmacå¤„åœ¨åŒä¸€å±€åŸŸç½‘ä¸‹ï¼Œè®¾ç½®ä»£ç†åœ°å€ä¸ºmacä¸Šçš„socksä»£ç†ï¼Œä½†æ˜¯ä¸æ˜¯å¾ˆç†æƒ³ï¼Œè¿˜æ˜¯ç¡¬ä»¶ç¿»å¢™æ¥çš„ç²—æš´</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h1><p>1.ä»…é’ˆå¯¹å®˜æ–¹é•œåƒ<br>2.éœ€è¦ä¸‹è½½å®˜æ–¹é•œåƒï¼Œéœ€è¦ç¿»å¢™æˆ–è€…å›½å†…å¯»æ‰¾æ¬è¿èµ„æº<br>3.nexusåˆ·å…¥æ–°ç³»ç»Ÿåï¼Œå¼€æœºéœ€è¦ç½‘ç»œéªŒè¯æ¿€æ´»ï¼ˆéƒ¨åˆ†å¯ä»¥è·³è¿‡ï¼‰ï¼Œéœ€è¦ç½‘ç»œç¯å¢ƒèƒ½å¤Ÿç¿»å¢™ï¼Œè¯·è‡ªè¡Œè§£å†³  </p>]]>
    
    </summary>
    
      <category term="Mac" scheme="http://mzeht.com/tags/Mac/"/>
    
      <category term="Nexus" scheme="http://mzeht.com/tags/Nexus/"/>
    
      <category term="ç»¼åˆ" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/"/>
    
      <category term="å…¶ä»–" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Synchronize files from ftpserver]]></title>
    <link href="http://mzeht.com/2016/06/30/Synchronize-files-from-ftpserver/"/>
    <id>http://mzeht.com/2016/06/30/Synchronize-files-from-ftpserver/</id>
    <published>2016-06-30T13:10:57.000Z</published>
    <updated>2016-11-27T10:21:53.000Z</updated>
    <content type="html"><![CDATA[<h1 id="é¡¹ç›®åŠŸèƒ½">é¡¹ç›®åŠŸèƒ½</h1><ol>
<li>è½¯ä»¶ä¸ºè¿è¡Œäºå®‰å“å¹³å°çš„å®¢æˆ·ç«¯è½¯ä»¶ã€‚</li>
<li>å®¢æˆ·ç«¯è½¯ä»¶è¿è¡Œäºä¸€å°19å¯¸å±çš„å®‰å“åª’ä½“æœºä¸Šã€‚</li>
<li>è¯¥å®¢æˆ·ç«¯è½¯ä»¶æœ‰æ’­æ”¾å¹¿å‘Šè§†é¢‘çš„åŠŸèƒ½ï¼Œå¹¿å‘Šè§†é¢‘ä»FTPæœåŠ¡å™¨ä¸‹è½½ï¼Œæœ¬åœ°çš„è§†é¢‘æ–‡ä»¶æ¯éš”ä¸‰åˆ†é’Ÿä¸FTPæœåŠ¡å™¨åŒæ­¥ä¸€æ¬¡ï¼Œä¿æŒæœ¬åœ°è§†é¢‘å’ŒæœåŠ¡å™¨è§†é¢‘çš„åŒæ­¥ã€‚</li>
<li>FTPæœåŠ¡å™¨çš„ä¸‹è½½ç›®å½•è¦æ±‚å¯é…ç½®ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œè¯¥è½¯ä»¶æ—¶å¼¹å‡ºé…ç½®çª—å£ï¼Œè¦æ±‚è¾“å…¥æœåŠ¡å™¨IPåœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠæœåŠ¡å™¨è§†é¢‘æ‰€åœ¨çš„ç›®å½•è·¯å¾„ã€‚é…ç½®å®Œæˆåï¼Œä»¥åè¿è¡Œä¸å†éœ€è¦é‡æ–°é…ç½®ã€‚</li>
<li>åª’ä½“æœºä¸»æ¿é€šè¿‡ä¸²å£å¤–æ¥äº†ä¸€å—STM32å•ç‰‡æœºï¼ŒSTM32å•ç‰‡æœºä¼šå°†é‡‡é›†åˆ°çš„PM2.5æŒ‡æ•°ï¼Œæ¸©æ¹¿åº¦ä¿¡æ¯ä¸Šä¼ ï¼Œåª’ä½“æ¿é€šè¿‡ä¸²å£æ¥æ”¶ï¼Œå¹¶å°†æ•°æ®æ˜¾ç¤ºåœ¨å±å¹•çš„æœ€ä¸Šæ–¹ã€‚é€šä¿¡åè®®è§â€œåª’ä½“æ¿å’Œå•ç‰‡æœºé€šä¿¡åè®®.docxâ€æ–‡æ¡£ã€‚</li>
<li>å¼€æœºæ’­æ”¾ä¸€æ®µæ¬¢è¿è§†é¢‘ï¼Œè§†é¢‘æ‰“åŒ…åœ¨Androidç¨‹åºå†…éƒ¨</li>
</ol>
<a id="more"></a>
<h1 id="åŠŸèƒ½åˆ†æ">åŠŸèƒ½åˆ†æ</h1><p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/16-6-30/89255535.jpg" alt=""></p>
<p>å·¥ç¨‹éƒ¨åˆ†ç»“æ„å›¾</p>
<p>LaunchActivity:æ’­æ”¾æ¬¢è¿è§†é¢‘</p>
<p>LoginActivityï¼šç™»å½•FTPæœåŠ¡å™¨å¹¶ä¸”ä¸‹è½½æ‰€æœ‰çš„è§†é¢‘æ–‡ä»¶</p>
<p>DisplayActivity:æ’­æ”¾æœåŠ¡å™¨ä¸Šæœ€æ–°çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æ¯ä¸ªä¸‰åˆ†é’Ÿæ£€æŸ¥è§†é¢‘çš„æ›´æ–°å’ŒåºŸé™¤ï¼Œè‹¥æœ‰æ›´æ–°ï¼Œåˆ™ä¸‹è½½ä¸‹æ¥ï¼Œä¸åœ¨æœåŠ¡å™¨ç›®å½•çš„æ–‡ä»¶åˆ é™¤æ‰ï¼Œå¦åˆ™å­˜å‚¨ç©ºé—´å ç”¨ä¸æ–­å¢åŠ </p>
<blockquote>
<ul>
<li>ç”±äºè®¾å¤‡çš„ç½‘ç»œé—®é¢˜å’ŒæœåŠ¡å™¨ç­‰é€ æˆä¸‹è½½ä¸­æ–­ï¼Œä¸å®Œæ•´ç­‰ï¼Œå¿…é¡»è¦æœ‰é‡è¯•ä¸‹è½½å’Œæ£€æŸ¥ä¸‹è½½å®Œæ•´çš„æœºåˆ¶</li>
<li>æ¯æ’­æ”¾å®Œä¸€ç»„è§†é¢‘ï¼Œè‹¥æœ‰æ›´æ–°ï¼Œåˆ·æ–°æ’­æ”¾é˜Ÿåˆ—ï¼Œè‹¥æ— æ›´æ–°ï¼Œå¾ªç¯æ’­æ”¾è¯¥ç»„è§†é¢‘</li>
<li>æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ä¿¡æ¯è¦å®æ—¶ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä»¥ä¾›å¯¹æ¯”</li>
<li>éœ€è¦ä¸‹è½½æœåŠ¡å™¨æŒ‡å®šç›®å½•ä¸‹çš„ä¸€ç±»æ–‡ä»¶</li>
</ul>
</blockquote>
<h1 id="ä¾èµ–åŒ…">ä¾èµ–åŒ…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)</div><div class="line">    compile &apos;com.android.support:recyclerview-v7:23.4.0&apos;</div><div class="line">    compile &apos;com.android.support:leanback-v17:23.4.0&apos;</div><div class="line">//    compile files(&apos;libs/commons-net-3.0.1.jar&apos;)</div><div class="line">    compile &apos;com.jakewharton:butterknife:7.0.0&apos;</div><div class="line">    compile &apos;org.xutils:xutils:3.3.26&apos;</div><div class="line">    compile files(&apos;libs/commons-net-3.3.jar&apos;)</div></pre></td></tr></table></figure>
<h2 id="v17_Leanback_Library">v17 Leanback Library</h2><p><a href="https://developer.android.com/topic/libraries/support-library/features.html#v17-leanback" target="_blank" rel="external">https://developer.android.com/topic/libraries/support-library/features.html#v17-leanback</a><br>å†…ç½®äº†å¯¹TVè®¾å¤‡çš„æ”¯æŒ</p>
<h2 id="org-xutils:xutils:3-3-26">org.xutils:xutils:3.3.26</h2><p>å¼€æºæ¡†æ¶ è¿™é‡Œä¸»è¦æ˜¯ç”¨åˆ°æ•°æ®åº“æ¨¡å—</p>
<h2 id="commons-net-3-3-jar">commons-net-3.3.jar</h2><p>apacheå‡ºå“çš„ä¸FTPæœåŠ¡å™¨äº¤äº’çš„jaråŒ…</p>
<h1 id="æŠ€æœ¯å®ç°">æŠ€æœ¯å®ç°</h1><h2 id="æ•°æ®åº“çš„å®æ—¶æ›´æ–°">æ•°æ®åº“çš„å®æ—¶æ›´æ–°</h2><p>åˆ›å»º:åœ¨LoginActivity</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">    public static DbManager.DaoConfig daoConfig = new DbManager.DaoConfig()</div><div class="line">            .setDbName(&quot;addisplay.db&quot;)</div><div class="line">            .setTableCreateListener(new DbManager.TableCreateListener() &#123;</div><div class="line">                @Override</div><div class="line">                public void onTableCreated(DbManager db, TableEntity&lt;?&gt; table) &#123;</div><div class="line">                    Log.i(&quot;mzeht&quot;, &quot;onTableCreated&lt;&lt;&quot; + table.getName());</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">//            .setAllowTransaction(true)</div><div class="line">//            .setDbDir(new File(&quot;/mnt/sdcard/&quot;))</div><div class="line">//            .setDbVersion(1)</div><div class="line">            .setDbUpgradeListener(new DbManager.DbUpgradeListener() &#123;</div><div class="line">                @Override</div><div class="line">                public void onUpgrade(DbManager db, int oldVersion, int newVersion) &#123;</div><div class="line"></div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .setDbOpenListener(new DbManager.DbOpenListener() &#123;</div><div class="line">                @Override</div><div class="line">                public void onDbOpened(DbManager db) &#123;</div><div class="line">                    db.getDatabase().enableWriteAheadLogging();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">    DbManager db = x.getDb(daoConfig);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªNewFile</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">@Table(name=&quot;mp4file_info&quot;)</div><div class="line">public class NewFile &#123;</div><div class="line">    @Column(name=&quot;id&quot;,isId = true,autoGen = true,property = &quot;&quot;)</div><div class="line">    private int id;</div><div class="line">    @Column(name = &quot;file_Name&quot;)</div><div class="line">    private String fileName;</div><div class="line">    @Column(name = &quot;file_Size&quot;)</div><div class="line">    private long fileSize;</div><div class="line">    @Column(name = &quot;file_Path&quot;)</div><div class="line">    private String filePath;</div><div class="line"></div><div class="line">    public NewFile(String fileName, long fileSize, String filePath) &#123;</div><div class="line">        this.fileName = fileName;</div><div class="line">        this.fileSize = fileSize;</div><div class="line">        this.filePath = filePath;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public NewFile() &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public int getId() &#123;</div><div class="line">        return id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setId(int id) &#123;</div><div class="line">        this.id = id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public String getFileName() &#123;</div><div class="line">        return fileName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setFileName(String fileName) &#123;</div><div class="line">        this.fileName = fileName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public long getFileSize() &#123;</div><div class="line">        return fileSize;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setFileSize(long fileSize) &#123;</div><div class="line">        this.fileSize = fileSize;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public String getFilePath() &#123;</div><div class="line">        return filePath;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public void setFilePath(String filePath) &#123;</div><div class="line">        this.filePath = filePath;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String toString() &#123;</div><div class="line">        return &quot;NewFile&#123;&quot; +</div><div class="line">                &quot;fileName=&apos;&quot; + fileName + &apos;\&apos;&apos; +</div><div class="line">                &quot;, fileSize=&quot; + fileSize +&apos;\&apos;&apos; +</div><div class="line">                &quot;, filePath=&quot; + filePath +</div><div class="line">                &apos;&#125;&apos;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ä¸‹è½½å·¥å…·ç±»ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">NewFile newFile = new NewFile(file.getName(), file.getSize(), LocalSavePath + fileName);</div><div class="line">                           newFiles.add(newFile);</div><div class="line">                       &#125;</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">           //é€€å‡ºç™»é™†FTPï¼Œå…³é—­ftpCLientçš„è¿æ¥</div><div class="line">           ftpClient.logout();</div><div class="line">           ftpClient.disconnect();</div><div class="line"></div><div class="line"></div><div class="line">           DbManager db = x.getDb(LoginActivity.daoConfig);</div><div class="line">           db.delete(NewFile.class);</div><div class="line">           db.save(newFiles);</div><div class="line">           Log.i(&quot;æ•°æ®åº“ä¿å­˜å®æ—¶æœåŠ¡å™¨æ–‡ä»¶ä¿¡æ¯&quot;, newFiles.toString());</div></pre></td></tr></table></figure>
<h2 id="è§†é¢‘çš„å¾ªç¯æ’­æ”¾">è§†é¢‘çš„å¾ªç¯æ’­æ”¾</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"> public void loadView(String path) &#123;</div><div class="line"></div><div class="line">        Uri uri = Uri.parse(path);</div><div class="line">        final String fileinfo = path + &quot;&quot;;</div><div class="line">        mVideoView.setVideoURI(uri);</div><div class="line">        mVideoView.start();</div><div class="line"></div><div class="line">        mVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() &#123;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onPrepared(MediaPlayer mp) &#123;</div><div class="line"></div><div class="line">                mp.start();// æ’­æ”¾</div><div class="line">                Log.i(&quot;å¼€å§‹æ’­æ”¾&quot;, &quot;æœåŠ¡å™¨çš„ç¬¬&quot; + count + &quot;ä¸ªæ–‡ä»¶&gt;&gt;&gt;&gt;&gt;&gt;&quot; + playFile.getName());</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        mVideoView.setOnCompletionListener(new MediaPlayer.OnCompletionListener() &#123;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onCompletion(MediaPlayer mp) &#123;</div><div class="line">                android.util.Log.i(&quot;æ’­æ”¾å®Œæˆ&quot;, &quot;æœåŠ¡å™¨çš„ç¬¬&quot; + count + &quot;ä¸ªæ–‡ä»¶&gt;&gt;&gt;&gt;&gt;&gt;&quot; + playFile.getName());</div><div class="line">                count++;</div><div class="line">                if (count &lt; displaySize) &#123;</div><div class="line">                &#125; else &#123;</div><div class="line">                    count = 0;</div><div class="line">                    playendFlag = true;</div><div class="line">                &#125;</div><div class="line">                Log.i(&quot;&quot;, &quot;count:&quot; + count + &quot;dispalysize:&quot; + displaySize);</div><div class="line">                playFile = mp4Files.get(count);</div><div class="line">                Uri uri = Uri.parse(playFile.getAbsolutePath());</div><div class="line">//                Log.i(&quot;setOnCompletionListener&quot;,playFile.getAbsolutePath());</div><div class="line">                mVideoView.setVideoURI(uri);</div><div class="line">                mVideoView.start();// æ’­æ”¾</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯å¯¹mVideoViewçš„ä¸¤ä¸ªç›‘å¬</p>
<h2 id="ä»æ•°æ®åº“åˆ·æ–°æ’­æ”¾åˆ—è¡¨">ä»æ•°æ®åº“åˆ·æ–°æ’­æ”¾åˆ—è¡¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">private void initData() &#123;</div><div class="line"></div><div class="line">        boolean sdCardExist = Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED);</div><div class="line">        String pathdir;</div><div class="line">        if (!sdCardExist) &#123;</div><div class="line">            pathdir = getFilesDir().getAbsolutePath();//æ–°å»ºä¸€çº§ä¸»ç›®å½•</div><div class="line">        &#125; else &#123;</div><div class="line">            pathdir = FileUtils.CacheDir[3];//æ–°å»ºä¸€çº§ä¸»ç›®å½•</div><div class="line">        &#125;</div><div class="line">        DbManager db = x.getDb(LoginActivity.daoConfig);</div><div class="line">        String sql = &quot;select id,file_Name,file_Size,file_Path from mp4file_info &quot;;</div><div class="line">        List&lt;DbModel&gt; dbModelAll = null;</div><div class="line">        try &#123;</div><div class="line">            dbModelAll = db.findDbModelAll(new SqlInfo(sql));</div><div class="line">        &#125; catch (DbException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125;</div><div class="line">        List&lt;String&gt; pathList = new ArrayList&lt;String&gt;();</div><div class="line">        for (DbModel dbmodel : dbModelAll) &#123;</div><div class="line">            String id = dbmodel.getString(&quot;id&quot;);</div><div class="line">            String file_Nanme = dbmodel.getString(&quot;file_Name&quot;);</div><div class="line">            String file_path = dbmodel.getString(&quot;file_Path&quot;);</div><div class="line">            long file_Size = dbmodel.getLong(&quot;file_Size&quot;);</div><div class="line">            pathList.add(file_path);</div><div class="line">            Log.i(&quot;éœ€è¦æ’­æ”¾:&quot;, &quot; file_Nanme&lt;&lt;&quot; + file_Nanme + &quot; file_Size&lt;&lt;&quot; + file_Size + &quot; file_path&lt;&lt;&quot; + file_path);</div><div class="line">        &#125;</div><div class="line">        mp4Files.clear();</div><div class="line">        for (String path : pathList) &#123;</div><div class="line">            File file = new File(path);</div><div class="line">            mp4Files.add(file);</div><div class="line">        &#125;</div><div class="line">        DeletediscardedFile();</div><div class="line">//        File file = new File(pathdir);</div><div class="line">//        mp4Files = file.listFiles(getFileExtensionFilter(&quot;.mp4&quot;));</div><div class="line">        displaySize = mp4Files.size();</div><div class="line">        initFlag = true;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="åˆ é™¤æ— ç”¨çš„æ–‡ä»¶">åˆ é™¤æ— ç”¨çš„æ–‡ä»¶</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">private void DeletediscardedFile() &#123;</div><div class="line"></div><div class="line">        String loaclpath = getVideoFilePathStr();</div><div class="line">        File localfiles = new File(loaclpath);</div><div class="line">        File[] localfile = localfiles.listFiles();</div><div class="line">        boolean flag = false;</div><div class="line">        for (int i = 0; i &lt; localfile.length; i++) &#123;</div><div class="line">            flag = false;</div><div class="line">            for (int j = 0; j &lt; mp4Files.size(); j++) &#123;</div><div class="line">                //å¦‚æœæ–‡ä»¶åç§°ç›¸åŒåˆ™ä¸åˆ é™¤</div><div class="line">                String name1 = localfile[i].getAbsolutePath();</div><div class="line">                String name2 = mp4Files.get(j).getAbsolutePath();</div><div class="line">                if (name1.equals(name2)) &#123;</div><div class="line">                    flag = true;</div><div class="line">                &#125; else &#123;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if (flag == false) &#123;</div><div class="line">                File deletefile = new File(localfile[i].getAbsolutePath());</div><div class="line">                deletefile.delete();</div><div class="line">                Log.i(&quot;deletefile:&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&quot;, localfile[i].getName());</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="Threadå’ŒHanlerå®ç°å¾ªç¯çº¿ç¨‹">Threadå’ŒHanlerå®ç°å¾ªç¯çº¿ç¨‹</h1><p>åœ¨LoginActivityä¸­æœ‰networkå’Œdownloadä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè¿æ¥ï¼Œä¸€ä¸ªä¸‹è½½ï¼Œè¿æ¥å¤±è´¥åˆ™ä¼šé‡è¯•è¿æ¥ï¼ŒæˆåŠŸåˆ™å¼€å¯ä¸‹è½½ï¼Œä¸‹è½½æˆåŠŸåˆ™è·³è½¬å±•ç¤ºé¡µé¢ï¼Œå¤±è´¥åˆ™é‡æ–°è¿æ¥</p>
<p>åœ¨DisplayActivityä¸­æœ‰ä¸‰ä¸ªçº¿ç¨‹ï¼Œnetworkï¼Œdownloadï¼Œinitdataï¼Œå¤šå‡ºä¸€ä¸ªåˆ·æ–°æ’­æ”¾é˜Ÿåˆ—çš„çº¿ç¨‹</p>
<p>éƒ½æ˜¯é€šè¿‡Theradå’ŒHanlerå®ç°ï¼Œå¾ªç¯çº¿ç¨‹ï¼Œç¡®ä¿ä¸‹è½½æˆåŠŸ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line">Runnable initDataTask = new Runnable() &#123;</div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            initData();</div><div class="line">            Message msg = new Message();</div><div class="line">            Bundle data = new Bundle();</div><div class="line">            data.putBoolean(&quot;value&quot;, initFlag);</div><div class="line">            msg.setData(data);</div><div class="line">            ihandler.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    Handler ihandler = new Handler() &#123;</div><div class="line">        @Override</div><div class="line">        public void handleMessage(Message msg) &#123;</div><div class="line">            super.handleMessage(msg);</div><div class="line">            Bundle data = msg.getData();</div><div class="line">            flag = data.getBoolean(&quot;value&quot;);</div><div class="line">            if (flag &amp;&amp; playendFlag) &#123;</div><div class="line">                playFile = mp4Files.get(count);</div><div class="line">                playendFlag = false;</div><div class="line">                loadView(playFile.getAbsolutePath());</div><div class="line">            &#125;</div><div class="line">            // TODO</div><div class="line">            // UIç•Œé¢çš„æ›´æ–°ç­‰ç›¸å…³æ“ä½œ</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line"></div><div class="line">    Runnable networkTask = new Runnable() &#123;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            // TODO</div><div class="line">            // åœ¨è¿™é‡Œè¿›è¡Œ http request.ç½‘ç»œè¯·æ±‚ç›¸å…³æ“ä½œ</div><div class="line">            ftpUtils = FTPUtils.getInstance();</div><div class="line">            flag = ftpUtils.initFTPSetting(ip, Integer.valueOf(port), name, password);</div><div class="line">            Message msg = new Message();</div><div class="line">            Bundle data = new Bundle();</div><div class="line">            data.putBoolean(&quot;value&quot;, flag);</div><div class="line">            msg.setData(data);</div><div class="line">            chandler.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    Handler chandler = new Handler() &#123;</div><div class="line">        @Override</div><div class="line">        public void handleMessage(Message msg) &#123;</div><div class="line">            super.handleMessage(msg);</div><div class="line">            Bundle data = msg.getData();</div><div class="line">            flag = data.getBoolean(&quot;value&quot;);</div><div class="line">            if (flag) &#123;</div><div class="line">                new Thread(downloadTask).start();</div><div class="line">            &#125;</div><div class="line">            // TODO</div><div class="line">            // UIç•Œé¢çš„æ›´æ–°ç­‰ç›¸å…³æ“ä½œ</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    Runnable downloadTask = new Runnable() &#123;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            // TODO</div><div class="line">            // åœ¨è¿™é‡Œè¿›è¡Œ http request.ç½‘ç»œè¯·æ±‚ç›¸å…³æ“ä½œ</div><div class="line">            String savePath = getVideoFilePathStr();</div><div class="line">                downlodFlag = ftpUtils.downLoadTypeFile(dir, savePath, &quot;mp4&quot;);</div><div class="line"></div><div class="line">            Message msg = new Message();</div><div class="line">            Bundle data = new Bundle();</div><div class="line">            data.putBoolean(&quot;value&quot;, downlodFlag);</div><div class="line">            msg.setData(data);</div><div class="line">            dhandler.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    Handler dhandler = new Handler() &#123;</div><div class="line">        @Override</div><div class="line">        public void handleMessage(Message msg) &#123;</div><div class="line">            super.handleMessage(msg);</div><div class="line">            Bundle data = msg.getData();</div><div class="line">            flag = data.getBoolean(&quot;value&quot;);</div><div class="line">            if (flag) &#123;</div><div class="line">                new Thread(initDataTask).run();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line"></div><div class="line">    private void checkUpdateVideo() &#123;</div><div class="line"></div><div class="line">//        Intent intent= new Intent(this, UpdateService.class);</div><div class="line">//        startService(intent);</div><div class="line">        mHandler = new Handler();</div><div class="line"></div><div class="line">        mHandler.post(new Runnable() &#123;</div><div class="line">            @Override</div><div class="line">            public void run() &#123;</div><div class="line">                new Thread(networkTask).start();</div><div class="line">                mHandler.postDelayed(this, Constants.checkViedoTime);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="é¡¹ç›®åŠŸèƒ½">é¡¹ç›®åŠŸèƒ½</h1><ol>
<li>è½¯ä»¶ä¸ºè¿è¡Œäºå®‰å“å¹³å°çš„å®¢æˆ·ç«¯è½¯ä»¶ã€‚</li>
<li>å®¢æˆ·ç«¯è½¯ä»¶è¿è¡Œäºä¸€å°19å¯¸å±çš„å®‰å“åª’ä½“æœºä¸Šã€‚</li>
<li>è¯¥å®¢æˆ·ç«¯è½¯ä»¶æœ‰æ’­æ”¾å¹¿å‘Šè§†é¢‘çš„åŠŸèƒ½ï¼Œå¹¿å‘Šè§†é¢‘ä»FTPæœåŠ¡å™¨ä¸‹è½½ï¼Œæœ¬åœ°çš„è§†é¢‘æ–‡ä»¶æ¯éš”ä¸‰åˆ†é’Ÿä¸FTPæœåŠ¡å™¨åŒæ­¥ä¸€æ¬¡ï¼Œä¿æŒæœ¬åœ°è§†é¢‘å’ŒæœåŠ¡å™¨è§†é¢‘çš„åŒæ­¥ã€‚</li>
<li>FTPæœåŠ¡å™¨çš„ä¸‹è½½ç›®å½•è¦æ±‚å¯é…ç½®ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œè¯¥è½¯ä»¶æ—¶å¼¹å‡ºé…ç½®çª—å£ï¼Œè¦æ±‚è¾“å…¥æœåŠ¡å™¨IPåœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç ï¼Œä»¥åŠæœåŠ¡å™¨è§†é¢‘æ‰€åœ¨çš„ç›®å½•è·¯å¾„ã€‚é…ç½®å®Œæˆåï¼Œä»¥åè¿è¡Œä¸å†éœ€è¦é‡æ–°é…ç½®ã€‚</li>
<li>åª’ä½“æœºä¸»æ¿é€šè¿‡ä¸²å£å¤–æ¥äº†ä¸€å—STM32å•ç‰‡æœºï¼ŒSTM32å•ç‰‡æœºä¼šå°†é‡‡é›†åˆ°çš„PM2.5æŒ‡æ•°ï¼Œæ¸©æ¹¿åº¦ä¿¡æ¯ä¸Šä¼ ï¼Œåª’ä½“æ¿é€šè¿‡ä¸²å£æ¥æ”¶ï¼Œå¹¶å°†æ•°æ®æ˜¾ç¤ºåœ¨å±å¹•çš„æœ€ä¸Šæ–¹ã€‚é€šä¿¡åè®®è§â€œåª’ä½“æ¿å’Œå•ç‰‡æœºé€šä¿¡åè®®.docxâ€æ–‡æ¡£ã€‚</li>
<li>å¼€æœºæ’­æ”¾ä¸€æ®µæ¬¢è¿è§†é¢‘ï¼Œè§†é¢‘æ‰“åŒ…åœ¨Androidç¨‹åºå†…éƒ¨</li>
</ol>]]>
    
    </summary>
    
      <category term="Android" scheme="http://mzeht.com/tags/Android/"/>
    
      <category term="FTP" scheme="http://mzeht.com/tags/FTP/"/>
    
      <category term="çº¿ç¨‹" scheme="http://mzeht.com/tags/%E7%BA%BF%E7%A8%8B/"/>
    
      <category term="åŒæ­¥æ–‡ä»¶" scheme="http://mzeht.com/tags/%E5%90%8C%E6%AD%A5%E6%96%87%E4%BB%B6/"/>
    
      <category term="ç»¼åˆ" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/"/>
    
      <category term="é¡¹ç›®" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ä¼ä¸šå¾ä¿¡ç§»åŠ¨å®¢æˆ·ç«¯ç«å“åˆ†æ]]></title>
    <link href="http://mzeht.com/2016/04/13/%E4%BC%81%E4%B8%9A%E5%BE%81%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%AB%9E%E4%BA%89%E5%93%81%E5%88%86%E6%9E%90/"/>
    <id>http://mzeht.com/2016/04/13/ä¼ä¸šå¾ä¿¡å®¢æˆ·ç«¯ç«äº‰å“åˆ†æ/</id>
    <published>2016-04-13T09:12:31.000Z</published>
    <updated>2016-11-27T10:28:52.000Z</updated>
    <content type="html"><![CDATA[<h1 id="ä¼åŠ ">ä¼åŠ </h1><h2 id="å›¾ä¾‹">å›¾ä¾‹</h2><p><img src="http://7xsxyu.com2.z0.glb.clouddn.com/gif/jiaohuqjiahome.gif" alt=""></p>
<h2 id="å¸ƒå±€">å¸ƒå±€</h2><p>1.é¦–é¡µæ˜¯ä¼ ç»Ÿçš„tab å’Œviewçš„åˆ‡æ¢æ¨¡å¼ï¼Œä¸­é—´çš„æŒ‰é’®â€œä¼ä¸šæŸ¥è¯¢â€é‡ç‚¹çªå‡º<br>2ï¼Œè¿›å…¥appç¬¬ä¸€ä¸ªæ¨¡å—æ˜¯ä¼ä¸šå¤´æ¡ï¼Œåˆ†ä¸ºæ¨èå’Œæˆ‘çš„å…³æ³¨ï¼Œæ¨èæ˜¯æ‰€æœ‰ä¼ä¸šçš„æ–°é—»ï¼Œæˆ‘çš„å…³æ³¨æ˜¯å…³æ³¨çš„ä¼ä¸šç›¸å…³å¤´æ¡ã€‚</p>
<h2 id="é¢œè‰²">é¢œè‰²</h2><p>ä»¥è“ç™½é»‘ç°ä¸ºä¸»ï¼Œç™½è‰²èƒŒæ™¯ï¼Œè“è‰²ä¸»é¢˜</p>
<h2 id="äº¤äº’ç»†èŠ‚">äº¤äº’ç»†èŠ‚</h2><p>ä¸‹æ‹‰åˆ·æ–°è‡ªå®šä¹‰çš„â€ä¼â€œå­—è®¾è®¡çš„è¾ƒå¥½ï¼Œå‘¨å›´è¾¹æ¡†æœ‰loaddingæ•ˆæœï¼Œè¾“å‡ºå¤„ç†ç»“æœä¼šä»¥åŠ¨æ€æ·»åŠ è¯•å›¾çš„å½¢å¼é€šçŸ¥å®¢æˆ·ï¼Œç‚¹å‡»è¿›å…¥webviewåœ¨å·¥å…·æ çš„ä¸‹æ–¹æœ‰progressbaræŒ‡ç¤ºè¿›åº¦ã€‚</p>
<h2 id="å°ç»“">å°ç»“</h2><p>åˆ·æ–°çš„äº¤äº’å’Œä¸­é—´æŒ‰é’®çš„å¼ºè°ƒè®¾è®¡</p>
<h1 id="ä¼æŸ¥æŸ¥">ä¼æŸ¥æŸ¥</h1><h2 id="å›¾ä¾‹-1">å›¾ä¾‹</h2><p><img src="http://7xsxyu.com2.z0.glb.clouddn.com/gif/jiaohuqcchome.gif" alt=""></p>
<h2 id="å¸ƒå±€-1">å¸ƒå±€</h2><p>1.ä¾§æ»‘å¼é¦–é¡µè®¾è®¡ï¼Œæ²¡æœ‰ä¸‹ä¾§çš„åˆ‡æ¢æŒ‰é’®<br>2ï¼Œç³»ç»Ÿæ é¢œè‰²é…åˆå·¥å…·æ <br>2ï¼Œä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯æœç´¢åŒºåŸŸï¼ŒåŠŸèƒ½å¼•å¯¼åŒºåŸŸï¼Œçƒ­æœåŒºåŸŸï¼Œå…³æ³¨åŒºåŸŸï¼Œæ–°é—»åŒºåŸŸ</p>
<h2 id="é¢œè‰²-1">é¢œè‰²</h2><p>ä»¥çº¢è‰²ä¸ºä¸»é¢˜ï¼Œç™½è‰²èƒŒæ™¯ï¼Œå›¾æ ‡é¢œè‰²å¾ˆå¤š</p>
<h2 id="äº¤äº’ç»†èŠ‚-1">äº¤äº’ç»†èŠ‚</h2><p>æœç´¢åŒºåŸŸä¸‹æ•´ä½“æ»‘åŠ¨ï¼Œä¿æŒæœç´¢åŒºåŸŸå§‹ç»ˆå¯è§ï¼Œæ–°é—»åŒºåŸŸä¸è§¦å‘ä¸‹æ‹‰åˆ·æ–°ï¼Œç‚¹å‡»åˆ·æ–°çš„æ–¹å¼</p>
<h2 id="å°ç»“-1">å°ç»“</h2><p>ç³»ç»ŸçŠ¶æ€æ çš„è®¾ç½®æ•´ä½“æ„Ÿè¾ƒå¼º</p>
<p><a href="https://www.jianguoyun.com/p/DftAlPkQpN36BRjD1BQ" target="_blank" rel="external">Excelåˆ†ææ–‡æ¡£ä¸‹è½½</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="ä¼åŠ ">ä¼åŠ </h1><h2 id="å›¾ä¾‹">å›¾ä¾‹</h2><p><img src="http://7xsxyu.com2.z0.glb.clouddn.com/gif/jiaohuqjiahome.gif" alt=""></p>
<h2 id="å¸ƒå±€">å¸ƒå±€<]]>
    </summary>
    
      <category term="äº¤äº’è®¾è®¡" scheme="http://mzeht.com/tags/%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1/"/>
    
      <category term="æ–‡æ¡£" scheme="http://mzeht.com/categories/%E6%96%87%E6%A1%A3/"/>
    
      <category term="å…¶ä»–" scheme="http://mzeht.com/categories/%E6%96%87%E6%A1%A3/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[MongoDB]]></title>
    <link href="http://mzeht.com/2016/03/22/MongoDB/"/>
    <id>http://mzeht.com/2016/03/22/MongoDB/</id>
    <published>2016-03-22T12:55:47.000Z</published>
    <updated>2016-11-27T10:22:50.000Z</updated>
    <content type="html"><![CDATA[<h1 id="ç®€å•ä»‹ç»">ç®€å•ä»‹ç»</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>MongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ï¼Œç”±C++è¯­è¨€ç¼–å†™ï¼Œæ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p>
<p>MongoDBæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œå¼€æºï¼Œæ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“ï¼Œå®˜æ–¹ç»™è‡ªå·±çš„å®šä¹‰æ˜¯Key-valueå­˜å‚¨(é«˜æ€§èƒ½å’Œé«˜æ‰©å±•)å’Œä¼ ç»ŸRDBMS(ä¸°å¯Œçš„æŸ¥è¯¢å’ŒåŠŸèƒ½)ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢</p>
<a id="more"></a>
<h2 id="Documentå’ŒBSON">Documentå’ŒBSON</h2><p>MongoDBä¸­ä¿å­˜çš„æ•°æ®æ ¼å¼ä¸ºBSONï¼Œå¦‚ï¼šã€‚<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/bson.jpg" alt=""></p>
<p>MongoDBä¸­æ•°æ®çš„åŸºæœ¬å•å…ƒç§°ä¸ºæ–‡æ¡£(Document)ï¼Œå®ƒæ˜¯MongoDBçš„æ ¸å¿ƒæ¦‚å¿µï¼Œç”±å¤šä¸ªé”®æå…¶å…³è”çš„å€¼æœ‰åºçš„æ”¾ç½®åœ¨ä¸€èµ·ç»„æˆï¼Œæ•°æ®åº“ä¸­å®ƒå¯¹åº”äºå…³ç³»å‹æ•°æ®åº“çš„è¡Œã€‚</p>
<p>æ•°æ®åœ¨MongoDBä¸­ä»¥BSONï¼ˆBinary-JSONï¼‰æ–‡æ¡£çš„æ ¼å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚</p>
<p>BSONï¼ˆBinary Serialized Document Formatï¼‰æ˜¯ä¸€ç§ç±»jsonçš„ä¸€ç§äºŒè¿›åˆ¶å½¢å¼çš„å­˜å‚¨æ ¼å¼ï¼Œç®€ç§°Binary JSONï¼ŒBSONå’ŒJSONä¸€æ ·ï¼Œæ”¯æŒå†…åµŒçš„æ–‡æ¡£å¯¹è±¡å’Œæ•°ç»„å¯¹è±¡ï¼Œä½†æ˜¯BSONæœ‰JSONæ²¡æœ‰çš„ä¸€äº›æ•°æ®ç±»å‹ï¼Œå¦‚Dateå’ŒBinDataç±»å‹ã€‚</p>
<p>BSONçš„ä¼˜ç‚¹æ˜¯çµæ´»æ€§é«˜ï¼Œä½†å®ƒçš„ç¼ºç‚¹æ˜¯ç©ºé—´åˆ©ç”¨ç‡ä¸æ˜¯å¾ˆç†æƒ³ï¼ŒBSONæœ‰ä¸‰ä¸ªç‰¹ç‚¹ï¼šè½»é‡æ€§ã€å¯éå†æ€§ã€é«˜æ•ˆæ€§ã€‚</p>
<h1 id="æ–‡æ¡£çš„å¢åˆ æŸ¥æ”¹">æ–‡æ¡£çš„å¢åˆ æŸ¥æ”¹</h1><h2 id="ç®€å•æ’å…¥æ–‡æ¡£">ç®€å•æ’å…¥æ–‡æ¡£</h2><p>åœ¨æ•°æ®åº“ä¸­ï¼Œæ•°æ®æ’å…¥æ˜¯æœ€åŸºæœ¬çš„æ“ä½œï¼Œåœ¨MongoDBä½¿ç”¨db.collection.insert(document)è¯­å¥æ¥æ’å…¥æ–‡æ¡£ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/insert1.png" alt=""></p>
<p>documentæ˜¯æ–‡æ¡£æ•°æ®ï¼Œcollectionæ˜¯å­˜æ”¾æ–‡æ¡£æ•°æ®çš„é›†åˆã€‚</p>
<p>ä¾‹å¦‚ï¼šæ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯å­˜æ”¾åœ¨usersé›†åˆä¸­ï¼Œæ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ä¸ºä¸€ä¸ªuseræ–‡æ¡£ï¼Œæ’å…¥æ•°æ®:</p>
<p>db.users.insert(user);<br>å¦‚æœcollectionå­˜åœ¨ï¼Œdocumentä¼šæ·»åŠ åˆ°collectionç›®å½•ä¸‹ï¼Œ å¦‚æœcollectionä¸å­˜åœ¨ï¼Œæ•°æ®åº“ä¼šå…ˆåˆ›å»ºcollectionï¼Œç„¶åå†ä¿å­˜documentã€‚</p>
<p>ç»ƒä¹ ä¸€ä¸‹ï¼šæŠŠè‡ªå·±çš„å§“å(name)å’Œå¹´é¾„(age)ä¿å­˜åˆ°personé›†åˆä¸­ï¼<br>å¦‚æœæƒ³è¦æŸ¥çœ‹å·²æ’å…¥çš„personæ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ï¼šdb.person.find()æŸ¥çœ‹å½“å‰åº“ä¸­personé›†åˆé‡Œçš„æ•°æ®ã€‚</p>
<p>å¦‚æœæƒ³è¦æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„é›†åˆåˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼šshow collectionsã€‚</p>
<p>db.person.insert({name:â€™é˜¿ç‰›â€™, age:28});</p>
<h2 id="æ‰¹é‡æ’å…¥æ–‡æ¡£">æ‰¹é‡æ’å…¥æ–‡æ¡£</h2><p>insertè¯­å¥ä¸ä½†å¯ä»¥æ’å…¥å•ä¸ªæ–‡æ¡£ï¼Œè¿˜å¯ä»¥ä¸€æ¬¡æ€§æ’å…¥å¤šä¸ªæ–‡æ¡£ã€‚</p>
<p>æ’å…¥å¤šä¸ªæ–‡æ¡£æ—¶ï¼Œinsertå‘½ä»¤çš„å‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ä¸ºBSONæ ¼å¼çš„æ–‡æ¡£ã€‚</p>
<p>å¤šä¸ªæ–‡æ¡£å¯ä»¥æ”¾åœ¨ä¸€ä¸ªæ•°ç»„å†…ï¼Œä¸€æ¬¡æ’å…¥å¤šæ¡æ•°æ®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.users.insert([&#123;name:&quot;tommy&quot;&#125;,&#123;name:&quot;xiaoming&quot;&#125;])</div></pre></td></tr></table></figure>
<p>æ–‡æ¡£æ‰¹é‡æ’å…¥éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯ä½¿ç”¨æ‰¹é‡æ’å…¥æ—¶ä¹Ÿæœ‰ä¸€äº›é—®é¢˜éœ€è¦æ³¨æ„ï¼Œå› ä¸ºBSONæ ¼å¼çš„é™åˆ¶ï¼Œä¸€æ¬¡æ’å…¥çš„æ•°æ®é‡ä¸èƒ½è¶…è¿‡16Mï¼Œåœ¨ä¸€ä¸ªinsertå‘½ä»¤ä¸­æ’å…¥å¤šæ¡æ•°æ®æ—¶ï¼ŒMongoDBä¸ä¿è¯å®Œå…¨æˆåŠŸæˆ–å®Œå…¨å¤±è´¥ã€‚</p>
<p>ä½¿ç”¨insertå‘½ä»¤å°†ä»¥ä¸‹æ•°æ®ä¸€æ¬¡æ€§æ’å…¥personé›†åˆä¸­ã€‚</p>
<p>æ–‡ï¼Te_Leeï¼ˆç®€ä¹¦ä½œè€…ï¼‰<br>åŸæ–‡é“¾æ¥ï¼š<a href="http://www.jianshu.com/p/1e402922ee32/" target="_blank" rel="external">http://www.jianshu.com/p/1e402922ee32/</a><br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œå¹¶æ ‡æ³¨â€œç®€ä¹¦ä½œè€…â€ã€‚</p>
<table>
<thead>
<tr>
<th>name</th>
<th style="text-align:center">age</th>
<th style="text-align:center">status</th>
</tr>
</thead>
<tbody>
<tr>
<td>mary</td>
<td style="text-align:center">21</td>
<td style="text-align:center">A</td>
</tr>
<tr>
<td>Lucy</td>
<td style="text-align:center">89</td>
<td style="text-align:center">A</td>
</tr>
<tr>
<td>Jacky</td>
<td style="text-align:center">30</td>
<td style="text-align:center">A</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">db.person.insert([</div><div class="line"> &#123;name:&quot;Mary&quot;,  age:21, status:&quot;A&quot;&#125;,</div><div class="line"> &#123;name:&quot;Lucy&quot;,  age:89, status:&quot;A&quot;&#125;,</div><div class="line"> &#123;name:&quot;Jacky&quot;, age:30, status:&quot;A&quot;&#125; </div><div class="line">]);</div></pre></td></tr></table></figure>
<h2 id="æŸ¥è¯¢æ–‡æ¡£">æŸ¥è¯¢æ–‡æ¡£</h2><p>åœ¨MongoDBä¸­ï¼ŒæŸ¥è¯¢æŒ‡å‘ç‰¹å®šçš„æ–‡æ¡£é›†åˆï¼ŒæŸ¥è¯¢è®¾å®šæ¡ä»¶ï¼ŒæŒ‡æ˜MongoDBéœ€è¦è¿”å›çš„æ–‡æ¡£ï¼›æŸ¥è¯¢ä¹Ÿå¯ä»¥åŒ…å«ä¸€ä¸ªæŠ•å½±ï¼ŒæŒ‡å®šè¿”å›çš„å­—æ®µã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼Œåœ¨æŸ¥è¯¢è¿‡ç¨‹æŒ‡å®šäº†ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶å’Œä¸€ä¸ªæ’åºä¿®é¥°ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="ç®€å•ä»‹ç»">ç®€å•ä»‹ç»</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>MongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ï¼Œç”±C++è¯­è¨€ç¼–å†™ï¼Œæ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p>
<p>MongoDBæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œå¼€æºï¼Œæ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“ï¼Œå®˜æ–¹ç»™è‡ªå·±çš„å®šä¹‰æ˜¯Key-valueå­˜å‚¨(é«˜æ€§èƒ½å’Œé«˜æ‰©å±•)å’Œä¼ ç»ŸRDBMS(ä¸°å¯Œçš„æŸ¥è¯¢å’ŒåŠŸèƒ½)ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢</p>]]>
    
    </summary>
    
      <category term="MongoDb" scheme="http://mzeht.com/tags/MongoDb/"/>
    
      <category term="æ•°æ®åº“" scheme="http://mzeht.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="MongoDb" scheme="http://mzeht.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MongoDb/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[nodejs + mongodbå®ç°ç®€å•è´­ç‰©ç½‘ç«™]]></title>
    <link href="http://mzeht.com/2016/03/21/nodejs-mongodb%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E8%B4%AD%E7%89%A9%E7%BD%91%E7%AB%99/"/>
    <id>http://mzeht.com/2016/03/21/nodejs-mongodbå®ç°ç®€å•è´­ç‰©ç½‘ç«™/</id>
    <published>2016-03-21T14:53:59.000Z</published>
    <updated>2016-11-27T10:23:21.000Z</updated>
    <content type="html"><![CDATA[<h1 id="éœ€æ±‚ä¸è®¾è®¡">éœ€æ±‚ä¸è®¾è®¡</h1><h2 id="åŠŸèƒ½ä»‹ç»">åŠŸèƒ½ä»‹ç»</h2><ol>
<li><p>ç”¨æˆ·å¯ä»¥å®Œæˆæ³¨å†Œã€ç™»å½•ç„¶åç™»å½•åå¯¹å•†å“çš„æµè§ˆã€‚</p>
</li>
<li><p>ç™»å½•ä¹‹åï¼Œç”¨æˆ·å¯ä»¥å¯¹ç›¸å…³å•†å“è¿›è¡Œé€‰è´­å¹¶æ·»åŠ åˆ°è´­ç‰©è½¦ã€‚</p>
</li>
<li><p>ç”¨æˆ·å¯ä»¥å¯¹è´­ç‰©è½¦é‡Œé¢çš„å•†å“è¿›è¡Œå¢åŠ ã€å‡å°‘ã€åˆ é™¤æ“ä½œã€‚</p>
</li>
<li><p>ç”¨æˆ·å¯å¯¹è´­ç‰©è½¦å•†å“è¿›è¡Œç»“ç®—æ“ä½œã€‚</p>
</li>
</ol>
<a id="more"></a>
<h2 id="æŠ€æœ¯é€‰å‹">æŠ€æœ¯é€‰å‹</h2><p>æœ¬é¡¹ç›®æ¶‰åŠä½¿ç”¨åˆ°NodeJSã€Expressæ¡†æ¶ã€MongoDBæ•°æ®åº“ã€Mongooseå¯¹è±¡æ¨¡å‹åº“ï¼Œè¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š</p>
<p>NodeJSï¼šNode.jsé‡‡ç”¨Google Chromeæµè§ˆå™¨çš„V8å¼•æ“ï¼Œä¸€ä¸ªåç«¯çš„Javascriptè¿è¡Œç¯å¢ƒï¼Œæä¾›å¾ˆå¤šç³»ç»Ÿçº§çš„APIï¼Œå¦‚æ–‡ä»¶æ“ä½œã€ç½‘ç»œç¼–ç¨‹ç­‰ã€‚</p>
<p>MongoDBï¼šMongoDBæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„ä¸€ä¸ªé«˜æ€§èƒ½ï¼Œå¼€æºï¼Œæ— æ¨¡å¼çš„æ–‡æ¡£å‹æ•°æ®åº“ï¼Œæ•°æ®ä»¥BSONæ–‡æ¡£çš„æ ¼å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚</p>
<p>Expressï¼šä¸€ä¸ªç®€æ´ã€çµæ´»çš„åŸºäºNode.jsçš„Webåº”ç”¨å¼€å‘æ¡†æ¶, æ”¯æŒEjsã€jadeç­‰å¤šç§æ¨¡æ¿ï¼Œå¹¶ä¸”æä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šæ¨¡æ¿è§£æã€é™æ€æ–‡ä»¶æœåŠ¡ã€ä¸­é—´ä»¶ã€è·¯ç”±æ§åˆ¶ç­‰ç­‰ã€‚</p>
<p>Mongooseï¼šä¸€ä¸ªé’ˆå¯¹MongoDBæ“ä½œçš„å¯¹è±¡æ¨¡å‹åº“ï¼Œå°è£…äº†MongoDBå¯¹æ–‡æ¡£çš„çš„ä¸€äº›å¢åˆ æ”¹æŸ¥ç­‰å¸¸ç”¨æ–¹æ³•ã€‚</p>
<h2 id="ç»“æ„åˆ’åˆ†">ç»“æ„åˆ’åˆ†</h2><p>é¡¹ç›®ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ å¤§æ¨¡å—ï¼šæ³¨å†Œæ¨¡å—ï¼Œç™»å½•æ¨¡å—ï¼Œå•†å“æ¨¡å—ã€è´­ç‰©è½¦æ¨¡å—ã€ç»“ç®—æ¨¡å—ã€‚</p>
<ol>
<li><p>ç”¨æˆ·æ³¨å†Œæ¨¡å—ï¼šå¡«å†™ç”¨æˆ·åã€å¯†ç ã€ç¡®è®¤å¯†ç åï¼Œå®ç°æˆåŠŸæ³¨å†Œï¼Œç„¶åè¿›è¡Œç™»å½•ã€‚</p>
</li>
<li><p>ç”¨æˆ·ç™»å½•æ¨¡å—ï¼šå¡«å†™å·²æ³¨å†Œçš„ç”¨æˆ·åç§°ï¼Œå¡«å†™æ­£ç¡®çš„å¯†ç ï¼Œè¿›å…¥å•†å“å±•ç¤ºé¡µé¢ã€‚</p>
</li>
<li><p>å•†å“æ¨¡å—ï¼šç”¨æˆ·é€‰æ‹©ç›¸å…³äº§å“åŠ å…¥è´­ç‰©è½¦ã€‚</p>
</li>
<li><p>è´­ç‰©è½¦æ¨¡å—ï¼šå¯¹ç›¸å…³å•†å“è¿›è¡Œå¢åŠ ã€å‡å°‘ã€åˆ é™¤æ“ä½œã€‚</p>
</li>
<li><p>ç»“ç®—æ¨¡å—ï¼šå¯¹è´­ç‰©è½¦å†…å·²é€‰æ‹©å•†å“è¿›è¡Œç»“ç®—ã€‚</p>
</li>
</ol>
<p>æ¨¡å—ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/module.jpg" alt="image"></p>
<h2 id="æµç¨‹è®¾è®¡">æµç¨‹è®¾è®¡</h2><p>æ­¤æµç¨‹å›¾æ˜¾ç¤ºç”¨æˆ·å¯ä»¥è¿›è¡Œç™»å½•å’Œæ³¨å†Œæ“ä½œï¼Œå¦‚æœç”¨æˆ·å·²ç»æ³¨å†Œï¼Œåˆ™å¯ä»¥ç›´æ¥ç™»å½•ï¼Œè‹¥æœªæ³¨å†Œåˆ™å¿…é¡»å…ˆæ³¨å†ŒæˆåŠŸåæ‰èƒ½è¿›è¡Œç™»å½•ï¼Œç™»å½•æˆåŠŸåå¯ä»¥è¿›å…¥å•†å“é¡µæµè§ˆå•†å“ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç›¸å…³å•†å“å¹¶å¯åŠ å…¥è´­ç‰©è½¦ï¼Œåœ¨è´­ç‰©è½¦é¡µé¢å†…å¯ä»¥å¯¹è´­ç‰©è½¦å•†å“è¿›è¡Œç›¸å…³æ“ä½œï¼Œæœ€åç»“é€‰æ‹©ç›¸å…³å•†å“è¿›è¡Œç»“ç®—ã€‚</p>
<p>å…¶æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/process.jpg" alt=""></p>
<h1 id="æ•°æ®åº“è®¾è®¡">æ•°æ®åº“è®¾è®¡</h1><h2 id="æ•°æ®åº“ä»‹ç»">æ•°æ®åº“ä»‹ç»</h2><p>æ•°æ®åº“çš„ä½¿ç”¨å‘¢ï¼Œæˆ‘ä»¬è¿™é‡Œé€‰æ‹©äº†MongoDBã€‚</p>
<p>MongoDBçš„ç®€å•ä»‹ç»å¦‚ä¸‹ï¼š</p>
<p>MongoDBæ˜¯ä¸€ä¸ªå¼€æºçš„NoSQLæ•°æ®åº“ï¼Œç›¸æ¯”MySQLé‚£æ ·çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒæ›´æ˜¾å¾—è½»å·§ã€çµæ´»ï¼Œ éå¸¸é€‚åˆåœ¨æ•°æ®è§„æ¨¡å¾ˆå¤§ã€äº‹åŠ¡æ€§ä¸å¼ºçš„åœºåˆä¸‹ä½¿ç”¨ã€‚åŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡æ•°æ®åº“ï¼Œæ²¡æœ‰è¡¨ã€è¡Œç­‰æ¦‚å¿µï¼Œä¹Ÿæ²¡æœ‰å›ºå®šçš„æ¨¡å¼å’Œç»“æ„ï¼Œæ‰€æœ‰çš„æ•°æ®ä»¥æ–‡æ¡£çš„å½¢å¼å­˜å‚¨ï¼Œæ•°æ®æ ¼å¼å°±æ˜¯JSONã€‚</p>
<p>MongoDB â€”â€” æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°æ®åº“ï¼Œæ²¡æœ‰è¡¨ã€è¡Œç­‰æ¦‚å¿µï¼Œä¹Ÿæ²¡æœ‰å›ºå®šçš„æ¨¡å¼å’Œç»“æ„ï¼Œæ‰€æœ‰çš„æ•°æ®ä»¥Document(ä»¥ä¸‹ç®€ç§°æ–‡æ¡£)çš„å½¢å¼å­˜å‚¨(Documentï¼Œå°±æ˜¯ä¸€ä¸ªå…³è”æ•°ç»„å¼çš„å¯¹è±¡ï¼Œå®ƒçš„å†…éƒ¨ç”±å±æ€§ç»„æˆï¼Œä¸€ä¸ªå±æ€§å¯¹åº”çš„å€¼å¯èƒ½æ˜¯ä¸€ä¸ªæ•°ã€å­—ç¬¦ä¸²ã€æ—¥æœŸã€æ•°ç»„ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªåµŒå¥—çš„æ–‡æ¡£ã€‚)</p>
<p>æˆ‘ä»¬ä¸€å…±è¦åˆ›å»ºä¸‰ä¸ªé›†åˆï¼Œåˆ†åˆ«æ˜¯user(ç”¨æˆ·)é›†åˆã€commodity(å•†å“)é›†åˆã€cart(è´­ç‰©è½¦)é›†åˆï¼Œåé¢æˆ‘ä»¬ä¼šä¸€ä¸€ä»‹ç»ã€‚</p>
<h2 id="useré›†åˆå±æ€§å€¼å±•ç¤º">useré›†åˆå±æ€§å€¼å±•ç¤º</h2><p>å…³äºuseré›†åˆï¼Œæˆ‘ä»¬è®¾è®¡çš„å±æ€§æœ‰name(ç”¨æˆ·å)ã€password(å¯†ç )ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/c_user.jpg" alt=""></p>
<h2 id="commodityé›†åˆå±æ€§å€¼å±•ç¤º">commodityé›†åˆå±æ€§å€¼å±•ç¤º</h2><p>å…³äºcommodityé›†åˆï¼Œæˆ‘ä»¬è®¾è®¡çš„å±æ€§æœ‰name(å•†å“åç§°)ã€price(å•†å“ä»·æ ¼)ã€imgSrc(å•†å“å±•ç¤ºå›¾ç‰‡è·¯å¾„)ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/c_commodity.jpg" alt=""></p>
<h2 id="cartsé›†åˆå±æ€§å€¼å±•ç¤º">cartsé›†åˆå±æ€§å€¼å±•ç¤º</h2><p>å…³äºcarté›†åˆï¼Œæˆ‘ä»¬è®¾è®¡çš„å±æ€§æœ‰uId(ç”¨æˆ·ID)ã€cId(å•†å“ID)ã€cName(å•†å“åç§°)ã€cPrice(å•†å“ä»·æ ¼)ã€cImgSrc(å•†å“å±•ç¤ºå›¾ç‰‡è·¯å¾„)ã€cQuantity(å•†å“æ•°é‡)ã€cStatus(å•†å“ç»“ç®—çŠ¶æ€ï¼Œæœªç»“ç®—ä¸ºfalse,å·²ç»“ç®—ä¸ºtrue)ï¼Œ å¦‚ä¸‹æ‰€ç¤ºï¼š<br>![](<a href="http://7xqtsx.com1.z0.glb.clouddn.com/c_cart.jpg" target="_blank" rel="external">http://7xqtsx.com1.z0.glb.clouddn.com/c_cart.jpg</a></p>
<h1 id="è¯¦ç»†è®¾è®¡">è¯¦ç»†è®¾è®¡</h1><h2 id="æ³¨å†Œæ¨¡å—åŠŸèƒ½è®¾è®¡ä»‹ç»">æ³¨å†Œæ¨¡å—åŠŸèƒ½è®¾è®¡ä»‹ç»</h2><p>åŠŸèƒ½ï¼šæœ¬æ¨¡å—ä¸»è¦ç”¨äºæ–°ç”¨æˆ·æ³¨å†Œï¼Œç”¨æˆ·é€šè¿‡è¡¨å•æä¾›ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œç³»ç»Ÿæ ¹æ®ç”¨æˆ·æä¾›çš„æ³¨å†Œä¿¡æ¯å¯¹ç”¨æˆ·è¿›è¡Œå…·ä½“æ“ä½œã€‚</p>
<p>è¾“å…¥æ“ä½œï¼šç”¨æˆ·åã€å¯†ç ã€ç¡®è®¤å¯†ç ã€‚</p>
<p>å¯¹åº”å¤„ç†ï¼š</p>
<ol>
<li>è¾“å…¥æ³¨å†Œä¿¡æ¯ï¼šåœ¨é¡µé¢æä¾›çš„è¡¨å•å¤„è¾“å…¥ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œç‚¹å‡»â€œæ³¨å†Œâ€æŒ‰é’®æäº¤è¡¨å•æ•°æ®ä¿¡æ¯ã€‚å·²æ³¨å†Œç”¨æˆ·ï¼Œå¯ç‚¹å‡»â€œç™»å½•â€æŒ‰é’®ï¼Œè¿›å…¥ç™»å½•é¡µé¢ã€‚</li>
</ol>
<p>(2) ç”¨æˆ·æ³¨å†Œèº«ä»½éªŒè¯ï¼šè¿æ¥æ•°æ®åº“ï¼Œä»¥è¾“å…¥çš„â€œç”¨æˆ·åâ€æ•°æ®ä¸ºæŸ¥è¯¢æ¡ä»¶æ¥æŸ¥çœ‹è¾“å…¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ï¼Œå¦‚æœç”¨æˆ·åæœªæ³¨å†Œï¼Œåˆ™æç¤ºæ³¨å†ŒæˆåŠŸå¹¶è½¬åˆ°ç™»å½•é¡µè¿›è¡Œç™»å½•ï¼Œå¦‚æœç”¨æˆ·å·²æ³¨å†Œï¼Œåˆ™ç»™å‡ºç”¨æˆ·å·²å­˜åœ¨æç¤ºå¹¶é‡æ–°æ³¨å†Œã€‚</p>
<h2 id="æ³¨å†Œç•Œé¢">æ³¨å†Œç•Œé¢</h2><p>ç”¨æˆ·æ³¨å†Œç•Œé¢è‰å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Register.jpg" alt=""></p>
<h2 id="ç™»å½•æ¨¡å—è®¾è®¡ä¸å®ç°">ç™»å½•æ¨¡å—è®¾è®¡ä¸å®ç°</h2><p>åŠŸèƒ½ï¼šæœ¬æ¨¡å—ä¸»è¦ç”¨äºå¯¹ç”¨æˆ·èº«ä»½è¿›è¡Œé‰´åˆ«ã€‚ç”¨æˆ·é€šè¿‡è¡¨å•æä¾›ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œç³»ç»Ÿæ ¹æ®ç”¨æˆ·æä¾›çš„ç™»å½•ä¿¡æ¯å¯¹ç”¨æˆ·è¿›è¡ŒæŸ¥è¯¢é‰´åˆ«ã€‚ å¦‚æœèº«ä»½åˆæ³•ï¼Œåˆ™ç”¨æˆ·å¯è¿›å…¥å•†å“é¡µé¢ã€‚</p>
<p>è¾“å…¥æ“ä½œï¼šç”¨æˆ·åã€å¯†ç ã€‚</p>
<p>å¯¹åº”å¤„ç†ï¼š</p>
<ol>
<li><p>è¾“å…¥ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼šåœ¨é¡µé¢æä¾›çš„è¡¨å•å¤„è¾“å…¥ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼Œç‚¹å‡»â€œç™»å½•â€æŒ‰é’®æäº¤è¡¨å•æ•°æ®ä¿¡æ¯ã€‚ ä¹Ÿå¯ç‚¹å‡»â€œæ³¨å†Œâ€æŒ‰é’®ï¼Œæ³¨å†Œæ–°ç”¨æˆ·ã€‚</p>
</li>
<li><p>ç”¨æˆ·èº«ä»½è¿›è¡ŒéªŒè¯ï¼šè¿æ¥æ•°æ®åº“ï¼Œæ‰“å¼€useré›†åˆï¼Œæ£€éªŒç”¨æˆ·ç™»å½•ä¿¡æ¯ã€‚ä»¥è¾“å…¥çš„â€œç”¨æˆ·åâ€æ•°æ®ä¸ºæŸ¥è¯¢æ¡ä»¶æ¥æŸ¥çœ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œç»§ç»­æ£€éªŒå…¶è¾“å…¥å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¯†ç å’Œç”¨æˆ·åéƒ½æ­£ç¡®ï¼Œåˆ™è¿›å…¥å•†å“å±•ç¤ºé¡µé¢ï¼›å¦‚æœç”¨æˆ·åä¸å­˜åœ¨æˆ–å¯†ç ä¸æ­£ç¡®ï¼Œåˆ™ç»™å‡ºç›¸åº”çš„æç¤ºã€‚</p>
</li>
</ol>
<h2 id="ç™»å½•ç•Œé¢è‰å›¾">ç™»å½•ç•Œé¢è‰å›¾</h2><p>ç”¨æˆ·ç™»å½•ç•Œé¢è‰å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Login.jpg" alt=""></p>
<h2 id="å•†å“é¡µé¢ä»‹ç»">å•†å“é¡µé¢ä»‹ç»</h2><p>å•†å“é¡µå‘¢ï¼Œæˆ‘ä»¬ä¸»è¦è¦æ¥å±•ç¤ºå•†å“ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åå°†ä¼šè·³å…¥å•†å“é¡µï¼Œå¯å¯¹æ‰€æœ‰å•†å“è¿›è¡ŒæŸ¥çœ‹ï¼Œ æ¯ä¸ªå•†å“ä¿¡æ¯çš„å†…å®¹åŒ…æ‹¬ï¼šå•†å“åç§°ã€å•†å“å›¾ç‰‡ã€å•†å“ä»·æ ¼ï¼Œç”¨æˆ·å¯æµè§ˆä¹Ÿå¯å°†å…¶åŠ å…¥è´­ç‰©è½¦ã€‚</p>
<p>é¡µé¢è‰å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Commodity.jpg" alt=""></p>
<h2 id="å•†å“é¡µé¢ä»‹ç»-1">å•†å“é¡µé¢ä»‹ç»</h2><p>å…³äºè´­ç‰©è½¦é¡µé¢ï¼Œä¸»è¦å±•ç¤ºç”¨æˆ·å·²è´­ä¹°çš„å•†å“ï¼ŒåŒ…æ‹¬å•†å“çš„ä¿¡æ¯ã€ä»·æ ¼ã€æ•°é‡ï¼Œå½“ç„¶ç”¨æˆ·å¯ä»¥å¯¹å…¶ä¸­å•†å“è¿›è¡Œå¢åŠ ã€å‡å°‘ã€åˆ é™¤æ“ä½œï¼Œæœ€åï¼Œç”¨æˆ·å¯é€‰æ‹©å¯¹å…¶ä¸­å•†å“è¿›è¡Œç»“ç®—ï¼Œé€‰æ‹©ç»“ç®—åï¼Œä¼šæç¤ºç›¸åº”çš„ä»˜æ¬¾é‡‘é¢ã€‚</p>
<p>é¡µé¢è‰å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Cart.jpg" alt=""></p>
<h1 id="å®ç°æ³¨å†Œ">å®ç°æ³¨å†Œ</h1><h2 id="ç®€å•å¯åŠ¨">ç®€å•å¯åŠ¨</h2><p>é¦–å…ˆå‘¢ï¼Œæˆ‘ä»¬å…ˆæ–°å»ºä¸€ä¸ªé¡¹ç›®å·¥ç¨‹ç›®å½•ï¼Œç„¶ååœ¨ç›®å½•ä¸‹åˆ›å»ºå¯åŠ¨æ–‡ä»¶app.jsï¼Œå¼€å§‹æˆ‘ä»¬çš„ç¬¬ä¸€æ­¥ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¼šç”¨åˆ°Expressæ¡†æ¶æ¥å®ç°ç›¸å…³åŠŸèƒ½ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å…ˆå®‰è£…å®ƒï¼Œå…·ä½“å®‰è£…æ–¹æ³•è¿™é‡Œå°±ä¸åœ¨åšä»‹ç»äº†ã€‚</p>
<p>åœ¨å¯åŠ¨æ–‡ä»¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œæ¥æµ‹è¯•Expressæ¡†æ¶æ˜¯å¦å¼•ç”¨æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line">app.get(&apos;/&apos;, function (req, res) &#123;  </div><div class="line">   res.send(&apos;Hello World!&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>æµè§ˆå™¨æŸ¥çœ‹ç»“æœï¼Œå¦‚æ”¶åˆ°å“åº”ä¿¡æ¯åˆ™è¡¨æ˜æˆ‘ä»¬é¡¹ç›®çš„ç¬¬ä¸€æ­¥å·²ç»æˆåŠŸæå®šã€‚</p>
<h2 id="åˆ›å»ºç›®å½•">åˆ›å»ºç›®å½•</h2><p>é¡¹ç›®å·²ç»å¯åŠ¨æˆåŠŸï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹åˆ›å»ºç›¸å…³ç›®å½•ï¼Œç”¨äºå­˜å‚¨ä¸åŒçš„æ–‡ä»¶ã€‚</p>
<p>è¯´æ˜ï¼šå³ä¾§æ â€æ–‡ä»¶ç®¡ç†â€ä¸­å¯æ·»åŠ ç›¸åº”ç›®å½•å’Œæ–‡ä»¶ã€‚</p>
<ol>
<li><p>publicç›®å½•ï¼šå­˜æ”¾é™æ€æ–‡ä»¶ã€‚</p>
</li>
<li><p>routesç›®å½•ï¼šå­˜æ”¾è·¯ç”±æ–‡ä»¶ã€‚</p>
</li>
<li><p>viewsç›®å½•ï¼š å­˜æ”¾é¡µé¢æ–‡ä»¶ã€‚</p>
</li>
<li><p>commonç›®å½•ï¼šå­˜æ”¾å…¬å…±æ–‡ä»¶ã€‚</p>
</li>
<li><p>publicç›®å½•(å¯ä¸é€‰)ï¼Œæ–°å»ºjavascriptsã€stylesheetsã€imagesä¸‰ä¸ªç›®å½•ç”¨ä»¥å­˜å‚¨jsã€cssã€imgç›¸å…³æ–‡ä»¶ã€‚</p>
</li>
</ol>
<p>è¿™é‡Œæˆ‘ä»¬å†…ç½®äº†ä¸€äº›jsã€cssæ–‡ä»¶æ¥å®ç°ç®€å•é¡µé¢æ ·å¼å’Œæ“ä½œï¼Œåœ¨é¡µé¢è§†å›¾ä¸­ç›´æ¥ä½¿ç”¨å³å¯ï¼Œå¼•ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;link href=&quot;example/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; &gt;</div><div class="line"> </div><div class="line">&lt;script src=&quot;example/js/jquery.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</div><div class="line"> </div><div class="line">&lt;script src=&quot;example/js/bootstrap.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<h2 id="æ·»åŠ æ–‡ä»¶">æ·»åŠ æ–‡ä»¶</h2><p>æœ‰äº†ç›®å½•ï¼Œæˆ‘ä»¬å¼€å§‹æ·»åŠ æ–‡ä»¶ï¼Œå…ˆæ¥æ·»åŠ ä¸€ä¸ªç™»å½•é¡µé¢register.htmlï¼Œä¾¿äºç®¡ç†å’Œå¼€å‘æˆ‘ä»¬ç»Ÿä¸€æŠŠè§†å›¾é¡µé¢æ”¾åˆ°viewsç›®å½•ä¸‹ã€‚</p>
<p>viewsç›®å½•ï¼Œæ·»åŠ register.htmlæ³¨å†Œè§†å›¾é¡µï¼Œå¦‚ä¸‹ç®€å•æ•ˆæœå›¾ï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Register.jpg" alt=""></p>
<p>æœ‰äº†è§†å›¾é¡µé¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å®ƒäº†ï¼Œé‚£è¦å¦‚ä½•è®¿é—®å‘¢ï¼Œè¿™é‡Œå°±è¦ä½¿ç”¨åˆ°ejsæ¨¡æ¿äº†ï¼Œå®‰è£…æ–¹æ³•ä¸åœ¨é˜è¿°ï¼Œç›´æ¥å¦‚ä¸‹å¼•ç”¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">app.set( &apos;view engine&apos;, &apos;html&apos; );</div><div class="line">app.engine( &apos;.html&apos;, require( &apos;ejs&apos; ).__express );</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨engineå‡½æ•°æ³¨å†Œæ¨¡æ¿å¼•æ“å¹¶æŒ‡å®šå¤„ç†åç¼€åä¸ºhtmlçš„æ–‡ä»¶ã€‚</p>
<p>è®¾å®šè§†å›¾å­˜æ”¾çš„ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.set(&apos;views&apos;, require(&apos;path&apos;).join(__dirname, &apos;views&apos;));</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯åœ¨æœ¬åœ°é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¿˜è¦æŒ‡å®šæœ¬åœ°é™æ€èµ„æºè®¿é—®çš„è·¯å¾„,å¦‚ä¸‹è®¾ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.use(express.static(require(&apos;path&apos;).join(__dirname, &apos;public&apos;)));</div></pre></td></tr></table></figure>
<h2 id="è®¿é—®æ³¨å†Œé¡µ">è®¿é—®æ³¨å†Œé¡µ</h2><p>æœ‰äº†è§†å›¾é¡µé¢ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹è®¿é—®å®ƒï¼Œapp.jsæ–‡ä»¶éƒ¨åˆ†å†…å®¹ï¼Œå¼•å…¥ç›¸å…³æ¨¡å—èµ„æºï¼Œç„¶åç®€å•è®¿é—®å¦‚ä¸‹ï¼š</p>
<p>app.get(â€˜/â€˜, function (req, res) {<br>    res.render(â€˜registerâ€™);<br>});<br>app.listen(80);<br>æœ¬èŠ‚å¯åŠ¨è®¿é—®80ç«¯å£ï¼Œå¦‚æˆåŠŸçœ‹åˆ°æ³¨å†Œé¡µé¢åˆ™è¡¨ç¤ºé¡¹ç›®å·²ç»è¿è¡ŒæˆåŠŸï¼Œå¦‚æœªçœ‹åˆ°ï¼ŒæŸ¥çœ‹ç›¸å…³é”™è¯¯ä¿¡æ¯ï¼Œæ˜¯å¦ç¼ºå°‘ç›¸å…³æ¨¡å—ï¼Œå®‰è£…å’Œå¼•ç”¨å³å¯ã€‚</p>
<h2 id="å®šä¹‰Schema">å®šä¹‰Schema</h2><p>é¦–å…ˆåœ¨commonç›®å½•å†…æ·»åŠ models.jsæ–‡ä»¶ç”¨æ¥ä¿å­˜å„ä¸ªé›†åˆçš„Schemaæ–‡ä»¶(é›†åˆå±æ€§)ï¼Œä¹Ÿä¾¿äºæˆ‘ä»¬æŸ¥çœ‹å’Œè®¿é—®ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">module.exports = &#123;</div><div class="line">    user: &#123;</div><div class="line">        name: &#123; type: String, required: true &#125;,</div><div class="line">        password: &#123; type: String, required: true &#125;,</div><div class="line">        gender: &#123; type: Boolean, default: true &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æœ‰äº†é›†åˆçš„Schemaæ–‡ä»¶ï¼Œå¦‚ä½•è®¿é—®å‘¢ï¼Œæ¥ç€æˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•ä½¿ç”¨Modelæ¨¡å‹æ“ä½œè¿™äº›å±æ€§ã€‚</p>
<h2 id="åˆ›å»ºå…¬å…±æ–¹æ³•">åˆ›å»ºå…¬å…±æ–¹æ³•</h2><p>è¿˜æ˜¯commonç›®å½•ï¼Œæˆ‘ä»¬åœ¨æ–°å»ºä¸€ä¸ªå…¬å…±æ–¹æ³• â€”â€” dbHelper.jsæ–‡ä»¶ï¼Œæ¥æ“ä½œè¿™äº›Schemaï¼Œå› ä¸ºåé¢è¿˜ä¼šæ¶‰åŠæ­¤é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™æˆä¸€ä¸ªå…¬å…±çš„æ–¹æ³•ï¼ŒdbHelperæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var mongoose = require(&apos;mongoose&apos;),</div><div class="line">    Schema = mongoose.Schema,</div><div class="line">    models = require(&apos;./models&apos;);</div><div class="line"> </div><div class="line">for(var m in models) &#123;</div><div class="line">    mongoose.model(m, new Schema(models[m]));</div><div class="line">&#125;</div><div class="line">module.exports = &#123;</div><div class="line">    getModel: function (type) &#123;</div><div class="line">        return _getModel(type);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">var _getModel = function (type) &#123;</div><div class="line">    return mongoose.model(type);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¦‚ä¸Šæ‰€ç¤ºæˆ‘ä»¬é€šè¿‡getModelå¯è·å–é›†åˆçš„Modelæ¨¡å‹å°±å¯ä»¥å¯¹æ•°æ®åº“æœ‰å®è´¨æ€§çš„æ“ä½œäº†</p>
<p>å…³äºModelï¼Œç®€å•ä»‹ç»ï¼šç”±Schemaæ„é€ ç”Ÿæˆçš„æ¨¡å‹ï¼Œå…·æœ‰æ•°æ®åº“æ“ä½œçš„è¡Œä¸ºã€‚</p>
<h2 id="æ·»åŠ å‡½æ•°">æ·»åŠ å‡½æ•°</h2><p>å…³äºdbHelper.jsæ–‡ä»¶é‡Œæ–¹æ³•çš„è®¿é—®å¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">global.dbHelper = require( &apos;./common/dbHelper&apos; );</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨globaæ¥å®šä¹‰å…¨å±€å˜é‡dbHelperï¼Œé‚£ä¹ˆdbHelperå°±å¯ä»¥åœ¨ä»»ä½•æ¨¡å—å†…è°ƒç”¨äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±å¼€å§‹ä¿®æ”¹registerè§†å›¾é¡µé¢ï¼Œæ·»åŠ å•å‡»äº‹ä»¶ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;button&quot;  onclick=&quot;register()&quot; value=&quot;æ³¨ å†Œ&quot; /&gt;</div></pre></td></tr></table></figure>
<p>å¯¹åº”register()å‡½æ•°ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">function register()&#123;</div><div class="line">   //é€šè¿‡serialize()æ–¹æ³•è¿›è¡Œåºåˆ—åŒ–è¡¨å•å€¼ï¼Œåˆ›å»ºæ–‡æœ¬å­—ç¬¦ä¸²ã€‚</div><div class="line">   var data = $(&quot;form&quot;).serialize();</div><div class="line">   //ä¾‹å¦‚ï¼š&quot;username=å¼ ä¸‰&amp;password=12345&quot;</div><div class="line">   $.ajax(&#123;</div><div class="line">       url:&apos;/register&apos;,</div><div class="line">       type:&apos;POST&apos;,</div><div class="line">       data:data,</div><div class="line">       success:function(data,status)&#123;</div><div class="line">           if(status == &apos;success&apos;)&#123;</div><div class="line">               location.href=&apos;register&apos;;</div><div class="line">           &#125;</div><div class="line">       &#125;,</div><div class="line">       error:function(res,err)&#123;</div><div class="line">           location.href=&apos;register&apos;;</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ·»åŠ è·¯ç”±">æ·»åŠ è·¯ç”±</h2><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªæ–‡ä»¶register.jsï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æ¥ä¹‹registeré¡µé¢çš„postè¯·æ±‚ï¼Œ åœ¨åé¢çš„å­¦ä¹ ä¸­è¿˜ä¼šæœ‰å¤šä¸ªä¸åŒå¤„ç†æ–‡ä»¶ï¼Œä¸‡æ‰€ä»¥æˆ‘ä»¬ç»Ÿä¸€ç®¡ç†åœ¨routesç›®å½•ä¸‹ï¼Œåœ¨å®é™…å¼€å‘ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒæ–‡ä»¶è¯·æ±‚ç»™å‡ºç›¸åº”æ–‡ä»¶çš„å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åšåˆ†å¼€å¤„ç†ã€‚</p>
<p>è¿™é‡Œè´´å‡ºregister.jsæ–‡ä»¶å¤„ç†getå’Œpostè¯·æ±‚çš„ç›¸å…³ä»£ç ä»¥ä¾›å‚è€ƒï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">// appï¼šexpresså¯¹è±¡</div><div class="line">module.exports = function ( app ) &#123;</div><div class="line">  app.get(&apos;/register&apos;, function(req, res) &#123;</div><div class="line">      res.render(&apos;register&apos;);</div><div class="line">  &#125;);</div><div class="line">  app.post(&apos;/register&apos;, function (req, res) &#123;</div><div class="line">     var User = global.dbHelper.getModel(&apos;user&apos;),</div><div class="line">     uname = req.body.uname;</div><div class="line">     User.findOne(&#123;name: uname&#125;, function (error, doc) &#123;</div><div class="line">       if (doc) &#123;</div><div class="line">            req.session.error = &apos;ç”¨æˆ·åå·²å­˜åœ¨ï¼&apos;;</div><div class="line">            res.send(500);</div><div class="line">        &#125; else &#123;</div><div class="line">            User.create(&#123;</div><div class="line">                name: uname,</div><div class="line">                password: req.body.upwd</div><div class="line">            &#125;, function (error, doc) &#123;</div><div class="line">                if (error) &#123;</div><div class="line">                    res.send(500);</div><div class="line">                &#125; else &#123;</div><div class="line">                    req.session.error = &apos;ç”¨æˆ·ååˆ›å»ºæˆåŠŸï¼&apos;;</div><div class="line">                    res.send(200);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ¨¡å—çš„åŠ è½½å’Œå¼•ç”¨">æ¨¡å—çš„åŠ è½½å’Œå¼•ç”¨</h2><p>registerçš„postè¯·æ±‚å¤„ç†ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†session(express-sessionæ¨¡å—)è¿˜æœ‰å¤„ç†postè¯·æ±‚æ•°æ®çš„bodyå±æ€§(body-parserå’Œmulteræ¨¡å—)ï¼Œéœ€å…ˆå®‰è£…ä»–ä»¬ï¼Œç„¶åå¼•ç”¨å³å¯ï¼Œå¦‚ä¸‹å‚è€ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;pre&gt;</div><div class="line">//å¼•ç”¨æ¨¡å—</div><div class="line">var bodyParser = require(&apos;body-parser&apos;);</div><div class="line">var multer = require(&apos;multer&apos;);</div><div class="line">var session = require(&apos;express-session&apos;);</div><div class="line"></div><div class="line"> </div><div class="line">//è°ƒç”¨ä¸­é—´ä»¶ä½¿ç”¨</div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123; extended: true &#125;));</div><div class="line">app.use(multer());</div></pre></td></tr></table></figure>
<p>åé¢æˆ‘ä»¬è¿˜ä¼šå†æ¬¡æ·»åŠ å¤šä¸ªè·¯ç”±è®°å½•ï¼Œæ‰€ä»¥ä¾¿äºç®¡ç†å’Œè®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»–ä»¬ç»Ÿä¸€æ”¾åˆ°ä¸€èµ·ï¼Œæ¯”å¦‚routesç›®å½•ä¸‹æ–°å»ºindex.jsæ–‡ä»¶ä¸“é—¨ç”¨æ¥å­˜æ”¾æ·»åŠ çš„æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    require(&apos;./register&apos;)(app);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨app.jsæ–‡ä»¶ä¸­ç›´æ¥å¼•ç”¨index.jsæ–‡ä»¶å°±å¯ä»¥è®¿é—®è¿™äº›æ–‡ä»¶äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require(&apos;./routes&apos;)(app); //app:expresså¯¹è±¡ã€‚;</div></pre></td></tr></table></figure>
<h2 id="ä¸­é—´ä»¶ä¼ é€’ä¿¡æ¯">ä¸­é—´ä»¶ä¼ é€’ä¿¡æ¯</h2><p>è¿™é‡Œæˆ‘ä»¬å°±ä¸€æ­¥åˆ°ä½ï¼Œåœ¨registerçš„postè¯·æ±‚å¤„ç†ä¸­æˆ‘ä»¬ä½¿ç”¨äº†express-sessionæ¨¡å—æ¥ä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨ä¸­é—´ä»¶æ¥ä¼ é€’è¿™äº›æç¤ºä¿¡æ¯ï¼Œä¸­é—´ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app.use(function(req, res, next)&#123;</div><div class="line">    res.locals.user = req.session.user; //ä¿å­˜ç”¨æˆ·ä¿¡æ¯</div><div class="line">    var err = req.session.error;  //ä¿å­˜ç»“æœå“åº”ä¿¡æ¯</div><div class="line">    res.locals.message = &apos;&apos;;  // ä¿å­˜htmlæ ‡ç­¾</div><div class="line">    if (err) res.locals.message = &apos;&lt;div class=&quot;alert alert-danger&quot; style=&quot;margin-bottom: 20px;color:red;&quot;&gt;&apos; + err + &apos;&lt;/div&gt;&apos;;</div><div class="line">    next();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ³¨æ„ä¸­é—´ä»¶çš„å®‰æ”¾ä½ç½®ï¼Œè¿˜æœ‰æˆ‘ä»¬è®¾ç½®äº†å˜é‡messageå¹¶ä¸ºå…¶ç®€å•æ·»åŠ äº†æ ·å¼ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨registerè§†å›¾é‡Œå°±ç”¨å®ƒæ¥ä½œä¸ºæ“ä½œç»“æœçš„ä¿¡æ¯æç¤ºï¼Œç›´æ¥æ·»åŠ &lt;%- message %&gt;åˆ°è§†å›¾ç¬¬ä¸€ä¸ªdivå†…å³å¯ã€‚</p>
<p>å…³äºæ³¨å†Œæˆ‘ä»¬åŸºæœ¬å·²ç»å‡†å¤‡å°±ç»ªï¼Œå¼€å§‹æ‰“å¼€è¿æ¥æ•°æ®åº“å¹¶è®¾ç½®ç”¨æˆ·è¿‡æœŸæ—¶é—´(æ³¨æ„æ‰§è¡Œé¡ºåºï¼Œåº”æ”¾ç½®åœ¨é¦–ä¸ªä¸­é—´ä»¶ä½ç½®)ï¼Œapp.jsæ¡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mongoose.connect(&quot;mongodb://127.0.0.1:27017/test&quot;);</div><div class="line"> </div><div class="line">app.use(session(&#123;</div><div class="line">    secret:&apos;secret&apos;,</div><div class="line">    cookie:&#123;</div><div class="line">        maxAge:1000*60*30</div><div class="line">    &#125;</div><div class="line">&#125;));</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼Œæ³¨å†ŒåŠŸèƒ½å·²ç»å®Œæ¯•ï¼Œåœ¨ç”¨æˆ·æ³¨å†Œçš„ä¿¡æ¯å½•å…¥ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿›è¡Œç›¸å…³çš„ä¸ºç©ºã€ä¸¤æ¬¡å¯†ç çš„ä¸åŒ¹é…ç­‰ç­‰éªŒè¯ç­‰ç­‰(å¯è‡ªè¡Œæ·»åŠ )ï¼Œèµ¶ç´§æ³¨å†Œè¯•è¯•å§ï¼Œæœ¬åœ°çš„è¯å¯ä»¥é€šè¿‡MongoVUE(å¯è§†åŒ–å®¢æˆ·ç«¯)æ¥æŸ¥çœ‹æ•°æ®æ˜¯å¦æˆåŠŸå†™å…¥æ•°æ®åº“ã€‚</p>
<h1 id="ç™»é™†å’Œæµè§ˆ">ç™»é™†å’Œæµè§ˆ</h1><h2 id="æ·»åŠ è§†å›¾">æ·»åŠ è§†å›¾</h2><p>å‰é¢æˆ‘ä»¬å·²ç»å®ç°äº†æ³¨å†ŒåŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥æˆåŠŸæ³¨å†Œï¼Œæ¥ç€æˆ‘ä»¬å°±å¼€å§‹è®©ç”¨æˆ·ç™»å½•äº†ï¼Œæ­¤èŠ‚æˆ‘ä»¬å°±å®ç°ç”¨æˆ·çš„ç™»å½•åŠŸèƒ½ï¼Œå¹¶ä¸”ç™»å½•æˆåŠŸåè·³è½¬å•†å“é¡µé¢æŸ¥çœ‹å•†å“ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯åœ¨viewsç›®å½•ä¸‹æ·»åŠ ç™»å½•è§†å›¾é¡µé¢ â€”â€” login.htmlï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Login.jpg" alt=""></p>
<h2 id="è®¿é—®è§†å›¾">è®¿é—®è§†å›¾</h2><p>æœ‰äº†ç™»å½•é¡µé¢ï¼Œé‚£ä¹ˆæ³¨å†Œé¡µé¢(register)çš„ç™»å½•æŒ‰é’®æ·»åŠ æŒ‡å‘ç™»é™†é¡µé¢çš„é“¾æ¥ï¼Œç›¸åº”çš„ç™»é™†é¡µçš„æ³¨å†ŒæŒ‰é’®ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯æ·»åŠ ä¸€ä¸ªç›¸å¯¹åº”çš„æ–‡ä»¶ç”¨æ¥å¤„ç†loginé¡µé¢çš„è¯·æ±‚ï¼Œroutesç›®å½•ä¸‹æ–°å»ºåä¸ºlogin.jsçš„æ–‡ä»¶ï¼Œå…ˆæ¥å¢åŠ ä¸€ä¸ªå¤„ç†getè¯·æ±‚çš„æ–¹æ³•ï¼Œä»£ç å‚è€ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    app.get(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">        res.render(&apos;login&apos;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å’Œregisteræ–‡ä»¶ä¸€æ ·æ·»åŠ åˆ°index.jsä¸­ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require(&apos;./login&apos;)(app);</div></pre></td></tr></table></figure>
<p>registerè§†å›¾é¡µçš„register()å‡½æ•°çš„å›è°ƒä¸­ï¼Œå½“æ³¨å†ŒæˆåŠŸæ—¶æˆ‘ä»¬å°±å¯ä»¥è·³è½¬åˆ°ç™»é™†é¡µé¢äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">location.href=&apos;login&apos;;</div></pre></td></tr></table></figure>
<p>å¥½ï¼Œèµ¶ç´§è¯•è¯•ç™»é™†ã€æ³¨å†ŒæŒ‰é’®èƒ½å¦æˆåŠŸè·³è½¬å§ï¼</p>
<h2 id="å®ç°ç™»é™†">å®ç°ç™»é™†</h2><p>æˆ‘ä»¬ä¸ºç™»é™†æŒ‰é’®å¢åŠ å•å‡»äº‹ä»¶å’Œå¯¹åº”å‡½æ•°login()ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">function login()&#123;</div><div class="line">  //é€šè¿‡serialize()æ–¹æ³•è·å–formè¡¨å•å†…è¾“å…¥æ¡†ç”¨æˆ·åã€å¯†ç çš„å€¼</div><div class="line">  //å¦‚ï¼š&quot;username=å¼ ä¸‰&amp;password=12345&quot;</div><div class="line">  var data = $(&quot;form&quot;).serialize();</div><div class="line">  $.ajax(&#123;</div><div class="line">      url:&apos;/login&apos;,</div><div class="line">      type:&apos;POST&apos;,</div><div class="line">      data:data,</div><div class="line">      success:function(data,status)&#123;</div><div class="line">          if(status == &apos;success&apos;)&#123;</div><div class="line">              location.href=&apos;home&apos;;</div><div class="line">          &#125;</div><div class="line">      &#125;,</div><div class="line">      error:function(data,status)&#123;</div><div class="line">           if(status == &quot;error&quot;)&#123;</div><div class="line">              location.href=&apos;login&apos;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ç›¸åº”çš„login.jsæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬è¿˜å¾—æ·»åŠ ç›¸å¯¹åº”çš„postè¯·æ±‚å¤„ç†æ–¹æ³•ï¼Œæ¥ç€æˆ‘ä»¬ä¼šè®²è¿°ã€‚</p>
<h2 id="ç™»é™†å¤„ç†">ç™»é™†å¤„ç†</h2><p>å…³äºloginè§†å›¾é¡µçš„postè¯·æ±‚å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ç”¨æˆ·æ‰€è¾“å…¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¹¶ä½¿ç”¨å˜é‡ä¿å­˜ç›¸åº”æç¤ºä¿¡æ¯ï¼Œå½“ç”¨æˆ·åå’Œå¯†ç å…¨éƒ¨æ­£ç¡®æ—¶ï¼Œåˆ™è¿”å›æˆåŠŸå¹¶ä¿å­˜ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œç”¨ä½œæ¥åˆ¤æ–­ç”¨æˆ·çš„ç™»é™†çŠ¶æ€ï¼Œå…·ä½“å¯å‚è€ƒregisterè§†å›¾é¡µçš„postè¯·æ±‚ã€‚</p>
<p>login.jsæ–‡ä»¶çš„postè¯·æ±‚å¤„ç†ä»£ç ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">app.post(&apos;/login&apos;, function (req, res) &#123;</div><div class="line">  var User = global.dbHelper.getModel(&apos;user&apos;),uname = req.body.uname;</div><div class="line">  User.findOne(&#123;name: uname&#125;, function (error, doc) &#123;</div><div class="line">           if (ç”¨æˆ·ä¸å­˜åœ¨) &#123;</div><div class="line">                req.session.error = &apos;ç”¨æˆ·åä¸å­˜åœ¨ï¼&apos;;</div><div class="line">                res.send(404);</div><div class="line">            &#125; else if(ç”¨æˆ·å­˜åœ¨ï¼Œå¯†ç é”™è¯¯) &#123;</div><div class="line">                   req.session.error = &quot;å¯†ç é”™è¯¯!&quot;;</div><div class="line">                   res.send(404);</div><div class="line">               &#125;else&#123; //ç”¨æˆ·åã€å¯†ç æ­£ç¡®</div><div class="line">                   req.session.user=doc;</div><div class="line">                   res.send(200);</div><div class="line">               &#125;</div><div class="line">            &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿˜è®°å¾—æˆ‘ä»¬ç™»é™†çš„æœ¬åœ°å˜é‡messageå˜›ï¼Œç”¨æ¥ä¿å­˜htmlæ ‡ç­¾å¹¶åŒ…å«ç›¸åº”æç¤ºä¿¡æ¯ï¼Œè¿™é‡Œåœ¨ç™»é™†é¡µé¢æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œç”¨æ³•ï¼š&lt;%- message %&gt;ï¼ŒæŒ‡å®šåˆ°ç›¸åº”ä½ç½®å³å¯ã€‚</p>
<h2 id="å•†å“é¡µè§†å›¾">å•†å“é¡µè§†å›¾</h2><p>ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹ååˆ™è·³è½¬è‡³homeè§†å›¾é¡µé¢(å•†å“ä¸»é¡µ)ï¼Œå°±å¯ä»¥è¿›è¡Œå¯¹å•†å“çš„æµè§ˆå’Œé€‰æ‹©äº†ã€‚</p>
<p>è¿˜æ˜¯viewsç›®å½•ï¼Œæ·»åŠ homeå•†å“è§†å›¾é¡µï¼Œå¦‚ä¸‹ç®€å•æ•ˆæœå›¾ï¼š</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Commodity.jpg" alt=""></p>
<p>ç”¨æˆ·æˆåŠŸç™»å½•ä¹‹åè·³è½¬è‡³homeé¡µï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯åšåˆ†å¼€å¤„ç†ï¼Œroutesç›®å½•ä¸‹æ–°å»ºhome.jsæ–‡ä»¶ç”¨æ¥å¤„ç†æ¥ä¹‹homeä¹Ÿçš„getè¯·æ±‚ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å‡è®¾å¦‚æœç”¨æˆ·æœªç™»å½•å°†ä¸èƒ½æŸ¥çœ‹å•†å“ä¸»é¡µï¼Œæ‰€ä»¥ï¼Œåœ¨è¯·æ±‚å¤„ç†ä¸­æˆ‘ä»¬è¿˜éœ€è¦åˆ¤æ–­ç”¨æˆ·çš„ç™»é™†çŠ¶æ€ï¼Œè¿™ä¸ªå¯ä»¥ä½¿ç”¨æˆ‘ä»¬åœ¨ç™»å½•å¤„ç†æ—¶æ‰€ä¿å­˜çš„ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€‚</p>
<p>å…³äºå•†å“é¡µçš„è§†å›¾å±•ç¤ºæˆ‘ä»¬åªéœ€è¦æœ‰å…¶åç§°ã€ä»·æ ¼ã€å›¾ç‰‡ï¼Œè¿™é‡Œä½¿ç”¨ejsæ¨¡æ¿å¾ªç¯å±•ç¤ºï¼Œå¯å‚è€ƒå¦‚ä¸‹æ–¹å¼ï¼š</p>
<p>æ³¨ï¼šCommodityï¼šå•†å“é›†åˆæ‰€æœ‰æ•°æ®ï¼Œå†…ç½®å›¾ç‰‡è·¯å¾„ä¸ºâ€œ/example/imgâ€</p>
<p><img src="http://7xqtsx.com1.z0.glb.clouddn.com/home_refer.jpg" alt=""></p>
<h2 id="è¯·æ±‚å¤„ç†">è¯·æ±‚å¤„ç†</h2><p>åœ¨homeçš„getè¯·æ±‚å¤„ç†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆåˆ¤æ–­ç”¨æˆ·çš„ç™»é™†çŠ¶æ€ï¼Œåªæœ‰ç”¨æˆ·ç™»å½•äº†æ–¹å¯è·³è½¬åˆ°å•†å“é¡µï¼Œå¦‚æœä¸ºç™»é™†å‘¢åˆ™è·³è½¬åˆ°ç™»å½•é¡µï¼Œè€Œä¸”åœ¨è¿›å…¥å•†å“é¡µçš„æ—¶å€™å¹¶ä¼ å…¥Commodityé›†åˆçš„æ‰€æœ‰æ•°æ®æ•°æ®åœ¨é¡µé¢å±•ç¤ºã€‚</p>
<p>é¦–å…ˆå‘¢ï¼Œåœ¨models.jsæ–‡ä»¶ä¸­å®šä¹‰Commodityé›†åˆçš„Schemaå±æ€§ï¼Œå…±åŒ…æ‹¬å•†å“åç§°ã€å•†å“ä»·æ ¼ã€å•†å“å›¾ç‰‡ï¼Œè¿™é‡Œç®€å•å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">commodity: &#123;</div><div class="line">   name: String,</div><div class="line">   price: Number,</div><div class="line">   imgSrc: String</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>routesç›®å½•ä¸‹æ·»åŠ home.jsæ–‡ä»¶(index.jsæ–‡ä»¶ä¸­å¼•ç”¨)ã€‚</p>
<p>å…·ä½“å¤„ç†æ–¹å¼å¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    app.get(&apos;/home&apos;, function (req, res) &#123;</div><div class="line">        if(req.session.user)&#123;</div><div class="line">            var Commodity = global.dbHelper.getModel(&apos;commodity&apos;);</div><div class="line">            Commodity.find(&#123;&#125;, function (error, docs) &#123;</div><div class="line">               //å°†Commodityså˜é‡ä¼ å…¥homeæ¨¡æ¿</div><div class="line">               res.render(&apos;home&apos;,&#123;Commoditys:docs&#125;);</div><div class="line">            &#125;);</div><div class="line">        &#125;else&#123;</div><div class="line">            req.session.error = &quot;è¯·å…ˆç™»å½•&quot;</div><div class="line">            res.redirect(&apos;/login&apos;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ·»åŠ å•†å“">æ·»åŠ å•†å“</h2><p>æ·»åŠ å•†å“ï¼Œviewsç›®å½•ä¸‹æ·»åŠ addcommodityè§†å›¾é¡µé¢ç”¨æ¥å¯¹å•†å“çš„æ·»åŠ ï¼Œè¿™é‡Œç®€å•æ ·å¼å‚è€ƒå¦‚ä¸‹ï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Addcommodity.jpg" alt=""></p>
<p>ç›¸å¯¹åº”çš„addcommodityå‡½æ•°å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//imgSrcè¡¨ç¤ºå›¾ç‰‡è·¯å¾„)ï¼Œè¿™é‡Œå†…ç½®äº†5å¼ å›¾ç‰‡ï¼Œæ ¼å¼ä¸ºï¼šxmsz-X.jpg(Xä¸º1-5æ•°å­—)ã€‚</div><div class="line">var data = $(&quot;form&quot;).serialize()+&quot;&amp;imgSrc=&quot; + &quot;xmsz-&quot;+Math.floor(Math.random()*5+1)+&quot;.jpg&quot;;</div><div class="line">$.ajax(&#123;</div><div class="line">     url:&apos;/addcommodity&apos;,</div><div class="line">     type:&apos;POST&apos;,</div><div class="line">     data:data,</div><div class="line">     success:function(data,status)&#123;</div><div class="line">         if(status == &apos;success&apos;)&#123;</div><div class="line">            alert(&apos;æ·»åŠ æˆåŠŸï¼&apos;)</div><div class="line">         &#125;</div><div class="line">     &#125;,</div><div class="line">     error:function(data,err)&#123;</div><div class="line">         alert(&apos;æ·»åŠ å¤±è´¥ï¼&apos;)</div><div class="line">     &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="å•†å“æ·»åŠ å¤„ç†">å•†å“æ·»åŠ å¤„ç†</h2><p>è¿™é‡Œæˆ‘ä»¬å°±ç›´æ¥åœ¨home.jsæ–‡ä»¶ä¸­æ·»åŠ ä¿å­˜å•†å“çš„å¤„ç†æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/addcommodity&apos;, function(req, res) &#123;</div><div class="line">    res.render(&apos;addcommodity&apos;);</div><div class="line">&#125;);</div><div class="line">app.post(&apos;/addcommodity&apos;, function (req, res) &#123;</div><div class="line">    var Commodity = global.dbHelper.getModel(&apos;commodity&apos;);</div><div class="line">    Commodity.create(&#123;</div><div class="line">        name: req.body.name,</div><div class="line">        price: req.body.price,</div><div class="line">        imgSrc: req.body.imgSrc</div><div class="line">    &#125;, function (error, doc) &#123;</div><div class="line">        if (doc) &#123;</div><div class="line">            res.send(200);</div><div class="line">        &#125;else&#123;</div><div class="line">            res.send(404);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œå…³äºå•†å“é¡µçš„å±•ç¤ºå’Œæ·»åŠ å°±å®Œæˆäº†</p>
<h1 id="è´­ç‰©è½¦ç»“ç®—">è´­ç‰©è½¦ç»“ç®—</h1><h2 id="æ·»åŠ å•†å“é“¾æ¥">æ·»åŠ å•†å“é“¾æ¥</h2><p>ä¸ŠèŠ‚è¯¾ç¨‹é‡Œæˆ‘ä»¬å·²ç»å®ç°äº†å•†å“çš„æ·»åŠ å’Œå±•ç¤ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è¿›è¡Œå¯¹å•†å“çš„æ“ä½œâ€”â€”åŠ å…¥è´­ç‰©è½¦ã€‚</p>
<p>é¦–å…ˆï¼Œå•†å“é¡µçš„åŠ å…¥è´­ç‰©è½¦æŒ‰é’®ã€è´­ç‰©è½¦æŸ¥çœ‹æŒ‰é’®æ·»åŠ é“¾æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;/addToCart/&lt;%=Commoditys[i]._id%&gt;&quot;&gt;åŠ å…¥è´­ç‰©è½¦&lt;/a&gt;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å…ˆå®šä¹‰è´­ç‰©è½¦(cart)é›†åˆçš„Schemaå±æ€§ï¼ŒåŒ…å«ï¼šuId(ç”¨æˆ·ID)ã€cId(å•†å“ID)ã€cName(å•†å“åç§°)ã€cPrice(å•†å“ä»·æ ¼)ã€cImgSrc(å•†å“å±•ç¤ºå›¾ç‰‡è·¯å¾„)ã€cQuantity(å•†å“æ•°é‡)ã€cStatus(å•†å“ç»“ç®—çŠ¶æ€ï¼Œé»˜è®¤ä¸ºfalse)ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">cart:&#123;</div><div class="line">       uId: &#123; type: String &#125;,</div><div class="line">       cId: &#123; type: String &#125;,</div><div class="line">       cName: &#123; type: String &#125;,</div><div class="line">       cPrice: &#123; type: String &#125;,</div><div class="line">       cImgSrc: &#123; type:String &#125; ,</div><div class="line">       cQuantity: &#123; type: Number &#125;,</div><div class="line">       cStatus : &#123; type: Boolean, default: false  &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå±æ€§å®šä¹‰æˆ‘ä»¬è¿˜æ˜¯ç»Ÿä¸€æ”¾åˆ°models.jsæ–‡ä»¶ä¸­ä»¥æ–¹ä¾¿ç®¡ç†å’Œæ“ä½œã€‚<br>æ¥ç€viewsç›®å½•ä¸‹æ·»åŠ è´­ç‰©è½¦(cart.html)è§†å›¾é¡µé¢ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/Cart.jpg" alt=""></p>
<p>è´­ç‰©è½¦é¡µé¢çš„å±•ç¤ºå®ç°å¯å‚è€ƒå¦‚ä¸‹è´´å›¾ï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/cart_refer.jpg" alt=""></p>
<h2 id="è®¿é—®è§†å›¾-1">è®¿é—®è§†å›¾</h2><p>æ¥ç€åœ¨routesç›®å½•æ·»åŠ cart.jsæ–‡ä»¶(index.jsæ–‡ä»¶ä¸­å¼•ç”¨)ï¼Œæ¥å®šä¹‰è·¯ç”±å¤„ç†è§„åˆ™ã€‚</p>
<ol>
<li>æ¯”å¦‚cartè·¯å¾„çš„å¤„ç†ï¼Œå¦‚ä¸‹ï¼š</li>
</ol>
<p>1.1 æ£€æµ‹ç™»é™†ç”¨æˆ·æ˜¯å¦è¿‡æœŸï¼Œå·²è¿‡æœŸåˆ™è·³è½¬loginé¡µåŒæ—¶ç»™å‡ºæç¤ºä¿¡æ¯ã€‚<br>1.2 é€šè¿‡global.dbHelper.getModelæ–¹æ³•è·å–cartæ¨¡å‹ã€‚<br>1.3 é€šè¿‡findæŸ¥è¯¢ç”¨æˆ·æ‰€æœ‰å•†å“å¹¶ä¼ å…¥æ¨¡æ¿ï¼Œæ¡ä»¶ï¼šç”¨æˆ·IDï¼Œç»“ç®—çŠ¶æ€ã€‚<br>1.4 è´´å‡ºéƒ¨åˆ†ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/cart&apos;, function(req, res) &#123;</div><div class="line">     ......</div><div class="line">   Cart.find(&#123;&quot;uId&quot;:ç”¨æˆ·ID,&quot;cStatus&quot;:false&#125;,function (error, docs) &#123;</div><div class="line">       res.render(&apos;cart&apos;,&#123;carts:docs&#125;);</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ol>
<li>åŠ å…¥è´­ç‰©è½¦æŒ‰é’®é“¾æ¥æ‰€å¯¹åº”è·¯å¾„çš„å¤„ç†ï¼Œå¦‚ï¼š/addToCart/:å•†å“id</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.get(&quot;/addToCart/:id&quot;, function(req, res) &#123;...&#125;);</div></pre></td></tr></table></figure>
<p>2.1 é€šè¿‡req.params.idè·å–å•†å“IDå·å¹¶æ£€æµ‹ç™»é™†ç”¨æˆ·çŠ¶æ€ã€‚<br>2.2 é€šè¿‡global.dbHelper.getModelæ–¹æ³•è·å–è´­ç‰©è½¦(cart)ã€å•†å“(commodity)æ¨¡å‹ã€‚<br>2.3 å•†å“å·²å­˜åœ¨åˆ™è¿›è¡Œæ›´æ–°æ“ä½œï¼Œè´´å‡ºéƒ¨åˆ†å‚è€ƒä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Cart.update(&#123;&quot;uId&quot;:ç”¨æˆ·ID,&quot;cId&quot;:å•†å“ID&#125;,&#123;$set:&#123;cQuantity:å·²æœ‰æ•°é‡+1&#125;&#125;</div></pre></td></tr></table></figure></p>
<p>2.4å•†å“æœªå­˜åœ¨åˆ™è¿›è¡Œæ·»åŠ æ“ä½œï¼Œè´´å‡ºéƒ¨åˆ†ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Commodity.findOne(&#123;&quot;_id&quot;: å•†å“ID&#125;, function (error, doc) &#123;</div><div class="line">        Cart.create(&#123;</div><div class="line">            uId: ç”¨æˆ·ID,</div><div class="line">            cId: å•†å“ID,</div><div class="line">            cName: doc.name,</div><div class="line">            cPrice: doc.price,</div><div class="line">            cImgSrc: doc.imgSrc,</div><div class="line">            cQuantity : 1</div><div class="line">        &#125;,function(error,doc)&#123;</div><div class="line">            if(doc)&#123;</div><div class="line">                res.redirect(&apos;/home&apos;);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="å•†å“çš„å•é€‰å’Œå…¨é€‰">å•†å“çš„å•é€‰å’Œå…¨é€‰</h2><p>åœ¨è´­ç‰©è½¦é¡µé¢å±•ç¤ºè¿˜æ˜¯ä½¿ç”¨ejsæ¨¡æ¿(å…·ä½“å®ç°å¯å‚è€ƒè´´å›¾)æ¥å®ç°ç”¨æˆ·è´­ç‰©è½¦å•†å“çš„å±•ç¤ºï¼Œç°æœŸé—´æˆ‘ä»¬ç”¨åˆ°äº†checkboxï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ¥ç®€å•çš„å®ç°å•†å“çš„å…¨é€‰å’Œå•é€‰ã€‚</p>
<p>é¦–å…ˆï¼Œç®€å•ä»‹ç»å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>ç”¨æˆ·é€‰ä¸­å…¨é€‰æŒ‰é’®æ—¶ï¼Œåˆ—è¡¨å†…é€‰æ¡†å…¨éƒ¨å˜ä¸ºå‹¾é€‰çŠ¶æ€ã€‚</li>
<li>ç”¨æˆ·å–æ¶ˆå…¨é€‰æŒ‰é’®é€‰ä¸­çŠ¶æ€æ—¶ï¼Œåˆ—è¡¨å†…é€‰æ¡†å…¨éƒ¨å–æ¶ˆå‹¾é€‰çŠ¶æ€ã€‚</li>
<li>åˆ—è¡¨å†…é€‰æ¡†ä¸ºå…¨éƒ¨å‹¾é€‰çŠ¶æ€æ—¶ï¼Œå…¨é€‰æŒ‰é’®ä¸ºé€‰ä¸­çŠ¶æ€ï¼Œåä¹‹ä¸å‹¾é€‰ã€‚</li>
<li>å…¨é€‰æŒ‰é’®æœªé€‰ä¸­æƒ…å†µä¸‹ï¼Œå½“åˆ—è¡¨å†…æŒ‰é’®å…¨éƒ¨é€‰ä¸­åˆ™å…¨é€‰æŒ‰é’®ä¹Ÿè¦è¢«é€‰ä¸­ã€‚<br>å¯¹äºcheckboxæŒ‰é’®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/checkbox.jpg" alt=""></li>
</ol>
<p>æ³¨ï¼šdata-indexå±æ€§å­˜å‚¨ç´¢å¼•å€¼ç”¨æ¥è·å–å•†å“æ•°é‡ï¼Œdata=idå­˜å‚¨å•†å“IDï¼Œdata-priceå­˜å‚¨å•†å“ä»·æ ¼ã€‚</p>
<p>å®ç°å…¨é€‰ï¼šä¸ºå…¨é€‰æ¡†(å¦‚idä¸ºCheckAll)æ·»åŠ å•å‡»äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨propæ–¹æ³•è®¾ç½®checkboxçŠ¶æ€ã€isæ–¹æ³•åˆ¤æ–­checkboxçŠ¶æ€ï¼Œå¦‚ä¸‹å‚è€ƒç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(&apos;#CheckAll&apos;).click(function()&#123;</div><div class="line">      var self = $(this);</div><div class="line">      $(&apos;input[name=&quot;chkItem&quot;]&apos;).each(function()&#123;</div><div class="line">         $(this).prop(&quot;checked&quot;,self.is(&apos;:checked&apos;));</div><div class="line">      &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å®ç°å•é€‰ï¼šå•é€‰æ¡†(å¦‚nameä¸ºchkItem)æ·»åŠ å•å‡»äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨propæ–¹æ³•è®¾ç½®checkboxçŠ¶æ€ã€notæ–¹æ³•åˆ¤æ–­checkboxçŠ¶æ€ï¼Œå¦‚ä¸‹å‚è€ƒç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(&apos;input[name=&quot;chkItem&quot;]:checkbox&apos;).click(function()&#123;</div><div class="line">   var isCheck = $(&apos;input[name=&quot;chkItem&quot;]:not(:checked)&apos;).length?false:true;</div><div class="line">   $(&apos;#CheckAll&apos;).prop(&quot;checked&quot;,isCheck);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±ç®€å•å®ç°äº†æŒ‰é’®çš„å…¨é€‰å’Œå•é€‰ï¼Œä»¥ä¸Šæ–¹æ³•å¯ä¾›å‚è€ƒä¹Ÿå¯ä»¥è‡ªè¡Œæ€è·¯å»å®ç°ã€‚</p>
<h2 id="å•†å“çš„å¢åŠ å’Œå‡å°‘">å•†å“çš„å¢åŠ å’Œå‡å°‘</h2><p>å‰é¢æˆ‘ä»¬å®ç°äº†å¯¹äºå•†å“çš„å•é€‰å’Œå…¨é€‰åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å®ç°å•†å“æ•°é‡çš„åŠ å‡ã€‚</p>
<p>å¯¹äº+ã€-æŒ‰é’®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="http://7xqtsx.com1.z0.glb.clouddn.com/add-subtr.jpg" alt=""></p>
<p>ç®€å•å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®šä¹‰data-typeå±æ€§ç”¨äºåŒºåˆ†+ã€-æŒ‰é’®ã€‚</li>
<li>aæ ‡ç­¾æ·»åŠ å•å‡»äº‹ä»¶ã€‚å¹¶åŒæ—¶æ”¹å˜æ˜¾ç¤ºæ¡†çš„å€¼ã€‚</li>
<li>ä½¿ç”¨siblings()æ–¹æ³•æ”¹å˜åŒçº§æ ‡ç­¾çš„æ•°é‡å€¼ã€‚<br>å…·ä½“å®ç°å¯å‚è€ƒå¦‚ä¸‹æ–¹æ³•ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$(&apos;.li-quantity a&apos;).click(function()&#123;</div><div class="line">    var self = $(this);</div><div class="line">    var type = self.attr(&apos;data-type&apos;),</div><div class="line">        num = parseFloat(self.siblings(&apos;input&apos;).val());</div><div class="line">    if(type == &apos;add&apos;)&#123;</div><div class="line">          num += 1;</div><div class="line">     &#125;else if(type == &apos;subtr&apos;)&#123;</div><div class="line">          if(num &gt; 1)&#123;</div><div class="line">             num -= 1;</div><div class="line">          &#125;else&#123;</div><div class="line">             return false;</div><div class="line">          &#125;</div><div class="line">     &#125;</div><div class="line">    self.siblings(&apos;input&apos;).val(num);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œå¯¹äºå•†å“æ•°é‡çš„åŠ ã€å‡ä¹Ÿå®ç°äº†ï¼Œæ¥ç€æˆ‘ä»¬å¼€å§‹å®ç°ç”¨æˆ·é€‰ä¸­å•†å“çš„æ€»ä»·æ ¼è®¡ç®—åŠŸèƒ½ã€‚</p>
<h2 id="è®¡ç®—æ€»é‡‘é¢">è®¡ç®—æ€»é‡‘é¢</h2><p>å•†å“çš„çŠ¶æ€é€‰æ‹©å’Œæ•°é‡çš„åŠ å‡åŠŸèƒ½æˆ‘ä»¬å·²ç»å®ç°äº†ï¼Œé€‰æ‹©æˆ‘ä»¬å°±å¼€å§‹å®ç°å½“ç”¨æˆ·é€‰æ‹©ç›¸å…³å•†å“æ—¶æ€»é‡‘é¢çš„è®¡ç®—åŠŸèƒ½ã€‚</p>
<p>å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®šä¹‰å…¬å…±æ–¹æ³•ï¼Œç”¨äºç”¨æˆ·ä¸åŒåŠ ã€å‡ã€å…¨é€‰ç­‰æ“ä½œæ—¶çš†å¯è°ƒç”¨ã€‚</li>
<li>å¾ªç¯åˆ—è¡¨å†…æ‰€æœ‰è¢«é€‰ä¸­çš„checkbox(å‡è®¾nameä¸ºchkItem)ã€‚</li>
<li>ä½¿ç”¨checkboxçš„ç›¸åº”å±æ€§å€¼ï¼Œæ¥è·å–ä»·æ ¼å’Œæ•°é‡ã€‚</li>
<li>å®šä¹‰å…¨å±€å˜é‡(å‡è®¾ä¸ºsum)å­˜å‚¨æ€»é‡‘é¢å¹¶èµ‹å€¼æ˜¾ç¤ºã€‚<br>å…·ä½“æ–¹æ³•å®ç°å¯å‚è€ƒå¦‚ä¸‹å†…å®¹ï¼š</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sum = 0;</div><div class="line">$(&apos;input[name=&quot;chkItem&quot;]:checked&apos;).each(function()&#123;</div><div class="line">    var self = $(this),</div><div class="line">     price = self.attr(&apos;data-price&apos;),</div><div class="line">     index = self.attr(&apos;data-index&apos;);</div><div class="line">     var quantity = $(&apos;#Q&apos;+index).val();</div><div class="line">     sum +=(parseFloat(price)*parseFloat(quantity));</div><div class="line"> &#125;);</div><div class="line"> $(&quot;é‡‘é¢æ ‡ç­¾&quot;).html(&apos;ï¿¥&apos;+ sum +&apos;.00&apos;);</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼Œé€‰ä¸­å•†å“çš„ä»·æ ¼æ€»è®¡åŠŸèƒ½ä¹Ÿå°±ç®€å•å®ç°äº†ã€‚</p>
<h2 id="å•†å“ç»“ç®—">å•†å“ç»“ç®—</h2><p>å…³äºç»“ç®—åŠŸèƒ½ï¼Œè¿™é‡Œå°±åšç®€å•ä»‹ç»ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ç»“ç®—æŒ‰é’®æ—¶ï¼Œè®¡ç®—å‡ºè¢«é€‰å•†å“çš„æ€»é‡‘é¢ï¼Œç»™äºˆalertå‡ºæ€»é‡‘é¢ï¼Œæ•°æ®åº“åˆ™æ›´æ–°ç›¸åº”å•†å“çš„ç»“ç®—çŠ¶æ€å’Œæ•°é‡ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨è´­ç‰©è½¦é›†åˆä¸­æ·»åŠ ä¸€ä¸ªç”¨æˆ·æ¶ˆè´¹é‡‘é¢çš„å±æ€§æ¥ä¿å­˜æ‰€æ¶ˆè´¹çš„é‡‘é¢æ€»æ•°æ›´å¥½ï¼Œè¿™é‡Œå°±ç®€å•å¤„ç†äº†ã€‚</p>
<p>å…·ä½“åŠŸèƒ½å®ç°è¿™é‡Œç®€å•ä»‹ç»å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®šä¹‰å…¬å…±æ–¹æ³•ï¼Œç”¨äºç”¨æˆ·ä¸åŒåŠ ã€å‡ã€å…¨é€‰ç­‰æ“ä½œæ—¶çš†å¯è°ƒç”¨ã€‚</li>
<li>å¾ªç¯åˆ—è¡¨å†…æ‰€æœ‰è¢«é€‰ä¸­çš„checkbox(å‡è®¾nameä¸ºchkItem)ã€‚</li>
<li>ä½¿ç”¨checkboxçš„ç›¸åº”å±æ€§å€¼ï¼Œæ¥è·å–ä»·æ ¼å’Œæ•°é‡ã€‚</li>
<li>å®šä¹‰å…¨å±€å˜é‡(å‡è®¾ä¸ºsum)å­˜å‚¨æ€»é‡‘é¢å¹¶èµ‹å€¼æ˜¾ç¤ºã€‚<br>è¿™é‡Œè´´å‡ºéƒ¨åˆ†å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</li>
</ol>
<p>//ç»“ç®—æ–¹æ³•å†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$(&apos;input[name=&quot;chkItem&quot;]:checked&apos;).each(function()&#123;</div><div class="line">     var self = $(this),</div><div class="line">         //é€šè¿‡data-indexå±æ€§ï¼Œè·å–ç´¢å¼•å€¼</div><div class="line">         index = self.attr(&apos;data-index&apos;),</div><div class="line">        //é€šè¿‡data-idå±æ€§ï¼Œè·å–å¯¹åº”ID</div><div class="line">         ID= self.attr(&apos;data-id&apos;);</div><div class="line">     var æ•°é‡= $(&apos;#Q&apos;+index).val();</div><div class="line">     var data = &#123; &quot;cid&quot;: ID, &quot;cnum&quot;:æ•°é‡&#125;;</div><div class="line">     //å‘é€æ•°æ®è¯·æ±‚</div><div class="line">     ...   </div><div class="line">&#125;);</div><div class="line">alert(&apos;æ‰€ä»˜é‡‘é¢ä¸ºï¼šï¿¥&apos;+sum);</div><div class="line">location.href = &quot;cart&quot;;</div></pre></td></tr></table></figure>
<p>cart.jsæ–‡ä»¶æ·»åŠ å¯¹åº”è·¯ç”±å¤„ç†å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.post(&quot;è·¯å¾„&quot;,function(req,res)&#123;</div><div class="line">   var Cart = global.dbHelper.getModel(&apos;cart&apos;);</div><div class="line">   Cart.update(&#123;&quot;_id&quot;:req.body.ID&#125;,&#123;$set : &#123; cQuantity : req.body.æ•°é‡,cStatus:true &#125;&#125;,function(error,doc)&#123; </div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="å•†å“åˆ é™¤">å•†å“åˆ é™¤</h2><p>å…³äºå•†å“çš„åˆ é™¤åŠŸèƒ½å°±ç®€å•å¤šäº†ï¼Œæˆ‘ä»¬åªéœ€è·å–å…¶IDå³å¯å®ç°å¯¹äºè´­ç‰©è½¦å†…å•†å“çš„åˆ é™¤æ“ä½œ</p>
<p>åœ¨è´­ç‰©è½¦å•†å“çš„å±•ç¤ºåŠŸèƒ½å®ç°æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–å…¶IDï¼Œå¦‚ä¸‹å‚è€ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;/delFromCart/&lt;%=carts[i]._id%&gt;&quot; &gt;åˆ é™¤&lt;/a&gt;</div><div class="line">cart.jsæ–‡ä»¶ï¼Œæ·»åŠ å¯¹åº”è·¯å¾„å¤„ç†æ–¹æ³•ï¼Œè¿™é‡Œç®€å•å®ç°å‚è€ƒå¦‚ä¸‹ï¼š</div><div class="line"></div><div class="line">app.get(&quot;/delFromCart/:id&quot;, function(req, res) &#123;</div><div class="line">   //req.params.id è·å–IDå·</div><div class="line">   var Cart = global.dbHelper.getModel(&apos;cart&apos;);</div><div class="line">   Cart.remove(&#123;&quot;_id&quot;:req.params.id&#125;,function(error,doc)&#123;</div><div class="line">       //æˆåŠŸè¿”å›1  å¤±è´¥è¿”å›0</div><div class="line">       if(doc &gt; 0)&#123;</div><div class="line">           res.redirect(&apos;/cart&apos;);</div><div class="line">       &#125;</div><div class="line">   &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¥½ï¼Œåˆ°è¿™é‡Œæ‰€æœ‰åŠŸèƒ½éƒ½å·²ç»å®ç°äº†ï¼Œèµ¶å¿«å¥½å¥½å›å‘³å›å‘³æ‰€å­¦æ‰€æ‚Ÿå§ï¼</p>
<p>é™„ï¼šé¡¹ç›®æºç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/hubwiz/example-node" target="_blank" rel="external">https://github.com/hubwiz/example-node</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="éœ€æ±‚ä¸è®¾è®¡">éœ€æ±‚ä¸è®¾è®¡</h1><h2 id="åŠŸèƒ½ä»‹ç»">åŠŸèƒ½ä»‹ç»</h2><ol>
<li><p>ç”¨æˆ·å¯ä»¥å®Œæˆæ³¨å†Œã€ç™»å½•ç„¶åç™»å½•åå¯¹å•†å“çš„æµè§ˆã€‚</p>
</li>
<li><p>ç™»å½•ä¹‹åï¼Œç”¨æˆ·å¯ä»¥å¯¹ç›¸å…³å•†å“è¿›è¡Œé€‰è´­å¹¶æ·»åŠ åˆ°è´­ç‰©è½¦ã€‚</p>
</li>
<li><p>ç”¨æˆ·å¯ä»¥å¯¹è´­ç‰©è½¦é‡Œé¢çš„å•†å“è¿›è¡Œå¢åŠ ã€å‡å°‘ã€åˆ é™¤æ“ä½œã€‚</p>
</li>
<li><p>ç”¨æˆ·å¯å¯¹è´­ç‰©è½¦å•†å“è¿›è¡Œç»“ç®—æ“ä½œã€‚</p>
</li>
</ol>]]>
    
    </summary>
    
      <category term="MongoDb" scheme="http://mzeht.com/tags/MongoDb/"/>
    
      <category term="Nodejs" scheme="http://mzeht.com/tags/Nodejs/"/>
    
      <category term="ç»¼åˆ" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/"/>
    
      <category term="é¡¹ç›®" scheme="http://mzeht.com/categories/%E7%BB%BC%E5%90%88/%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[ConnectManagerç½‘ç»œè¯·æ±‚çš„ä¸‰å±‚å°è£…ï¼ˆæ¨¡å—ï¼è½¬æ¢ï¼åº•å±‚ï¼‰]]></title>
    <link href="http://mzeht.com/2016/03/18/ConnectManager%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E4%B8%89%E5%B1%82%E5%B0%81%E8%A3%85%EF%BC%88%E6%A8%A1%E5%9D%97%EF%BC%8D%E8%BD%AC%E6%8D%A2%EF%BC%8D%E5%BA%95%E5%B1%82%EF%BC%89/"/>
    <id>http://mzeht.com/2016/03/18/ConnectManagerç½‘ç»œè¯·æ±‚çš„ä¸‰å±‚å°è£…ï¼ˆæ¨¡å—ï¼è½¬æ¢ï¼åº•å±‚ï¼‰/</id>
    <published>2016-03-18T06:01:47.000Z</published>
    <updated>2016-11-27T10:23:50.000Z</updated>
    <content type="html"><![CDATA[<p>åŸºäºhttpclientï¼Œjavaå°è£…ä¸€å¥—Androidç½‘ç»œè¯·æ±‚æ¡†æ¶<br><a id="more"></a><br>è°ƒç”¨å±‚ï¼æ•°æ®è§£æå±‚ï¼åº•å±‚</p>
<h2 id="è°ƒç”¨å±‚">è°ƒç”¨å±‚</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">private void getSystemToken() &#123;</div><div class="line">        GetSystemTokenParam param = new GetSystemTokenParam();</div><div class="line">        param.loginId=Constants.LOGINID;</div><div class="line">        String password=mPasswordView.getText().toString();</div><div class="line">        String encpwd=PasswordUtil.getEncPwd(Constants.LOGINID, password);</div><div class="line">        param.password= encpwd;</div><div class="line">//        param.password= password;</div><div class="line">        L.i(&quot;systemID&quot;,mUsernameView.getText().toString());</div><div class="line">        L.i(&quot;æ˜æ–‡å¯†ç &quot;,mPasswordView.getText().toString());</div><div class="line">        L.i(&quot;loginID&quot;,Constants.LOGINID);</div><div class="line">        L.i(&quot;password åŠ å¯†ç»“æœä¸º&quot;,encpwd);</div><div class="line">        L.i(&quot;password è§£å¯†ç»“æœä¸º&quot;,PasswordUtil.getDecPwd(Constants.LOGINID,encpwd));</div><div class="line">        ConnectManager.getInstance().getSystemToken(param,Tokencallback);</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    private final AbstractRequestListener&lt;GetSystemTokenBean&gt; Tokencallback = new AbstractRequestListener&lt;GetSystemTokenBean&gt;() &#123;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void onComplete(GetSystemTokenBean bean) &#123;</div><div class="line">            tokenBean = bean;</div><div class="line">            tHandler.sendEmptyMessage(ActivityForResultUtil.REQUEST_DATA_SUCCESS);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void onError(CustomError customError) &#123;</div><div class="line"></div><div class="line">            Message msg = tHandler.obtainMessage();</div><div class="line">            msg.obj = customError;</div><div class="line">            msg.what = ActivityForResultUtil.REQUEST_DATA_ERROR;</div><div class="line">            tHandler.sendMessage(msg);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void onFault(CustomError fault) &#123;</div><div class="line"></div><div class="line">            Message msg = tHandler.obtainMessage();</div><div class="line">            msg.obj = fault;</div><div class="line">            msg.what = ActivityForResultUtil.REQUEST_DATA_FAULT;</div><div class="line">            tHandler.sendMessage(msg);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;;</div></pre></td></tr></table></figure>
<h2 id="æ•°æ®è½¬åŒ–å±‚">æ•°æ®è½¬åŒ–å±‚</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">    * è¯·æ±‚systemToken</div><div class="line">    *</div><div class="line">    * @param params</div><div class="line">    * @param callback</div><div class="line">    */</div><div class="line">   public void getSystemToken(final GetSystemTokenParam params,</div><div class="line">                            final AbstractRequestListener&lt;GetSystemTokenBean&gt; callback) &#123;</div><div class="line">       exector.execute(new Runnable() &#123;</div><div class="line"></div><div class="line">           @Override</div><div class="line">           public void run() &#123;</div><div class="line"></div><div class="line">               try &#123;</div><div class="line">                   String method = params.getParam().getString(&quot;method&quot;);</div><div class="line">                   String response = HttpConnectionUtil.openUrl(</div><div class="line">                           Constants.SERVER_URL + method, &quot;GET&quot;,</div><div class="line">                           params.getParam(),false);</div><div class="line">                   GetSystemTokenBean bean = GetSystemTokenBean.getSystemTokenBean(response);</div><div class="line">                   if (callback != null) &#123;</div><div class="line">                       callback.onComplete(bean);</div><div class="line">                   &#125;</div><div class="line">               &#125; catch (RuntimeException e) &#123;</div><div class="line">                   e.printStackTrace();</div><div class="line">                   if (callback != null) &#123;</div><div class="line">                       callback.onFault(new CustomError(network_error));</div><div class="line">                   &#125;</div><div class="line">               &#125; catch (JSONException e) &#123;</div><div class="line">                   e.printStackTrace();</div><div class="line">                   if (callback != null) &#123;</div><div class="line">                       callback.onError(new CustomError(json_error));</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line"></div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h2 id="ç½‘ç»œåº•å±‚">ç½‘ç»œåº•å±‚</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">    * å‘é€httpè¯·æ±‚</div><div class="line">    *</div><div class="line">    * @param url</div><div class="line">    * @param method</div><div class="line">    *            GET æˆ– POST</div><div class="line">    * @param params</div><div class="line">    * @return</div><div class="line">    */</div><div class="line">   public static String openUrl(String url, String method, Bundle params,boolean Token) &#123;</div><div class="line">       if (method.equals(&quot;GET&quot;)) &#123;</div><div class="line">           if (params != null) &#123;</div><div class="line">               url = url + &quot;?&quot; + encodeUrl(params);</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       String response = &quot;&quot;;</div><div class="line"></div><div class="line">       try &#123;</div><div class="line">           L.i(method + &quot; URL: &quot; + url);</div><div class="line">           HttpClient httpClient = HttpConnectionUtil.getNewHttpClient();</div><div class="line">           HttpGet httpGet = new HttpGet(url);</div><div class="line">           if(Token==false)&#123;</div><div class="line"></div><div class="line">           &#125;else&#123;</div><div class="line"></div><div class="line">               httpGet.setHeader(&quot;systemToken&quot;, Constants.SYSTEMTOKEN);</div><div class="line">           &#125;</div><div class="line">           //è¿æ¥è¶…æ—¶</div><div class="line">           httpClient.getParams().setParameter(CoreConnectionPNames.CONNECTION_TIMEOUT, 20000);</div><div class="line">           // è¯»å–è¶…æ—¶</div><div class="line">           httpClient.getParams().setParameter(CoreConnectionPNames.SO_TIMEOUT, 20000);</div><div class="line"></div><div class="line">           HttpResponse resp = httpClient.execute(httpGet);</div><div class="line"></div><div class="line">           if (resp.getStatusLine().getStatusCode() != HttpStatus.SC_OK) &#123;</div><div class="line">               L.i(LOG_TAG, &quot;httpGet fail, status code = &quot; + resp.getStatusLine().getStatusCode());</div><div class="line"></div><div class="line">           &#125;else&#123;</div><div class="line">               response = EntityUtils.toString(resp.getEntity());</div><div class="line"></div><div class="line">           &#125;</div><div class="line">       &#125; catch (Exception e) &#123;</div><div class="line">           throw new RuntimeException(e.getMessage(), e);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       L.i(&quot;LOG_TAG&quot;+response);</div><div class="line">       return response;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<h1 id="å…·ä½“å°è£…">å…·ä½“å°è£…</h1><h2 id="AbstractRequestListener">AbstractRequestListener</h2><p>public abstract class AbstractRequestListener<t extends="" object="">{</t></p>
<pre><code>/<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> å°†responseè¯·æ±‚è§£æä¸ºé’ˆå¯¹å…·ä½“è¯·æ±‚çš„bean
 <span class="keyword">*</span>
 <span class="keyword">*</span> <span class="comment">@param response</span>
 <span class="keyword">*</span>             è¯·æ±‚å®Œæˆåçš„å“åº”å­—ç¬¦ä¸²
 <span class="keyword">*</span> <span class="comment">@return</span>
 <span class="keyword">*</span>             è‹¥è§£ææˆåŠŸï¼Œè¿”å›è§£æåçš„å¯¹è±¡ï¼Œå¦åˆ™è¿”å›null
 <span class="keyword">*</span>/
<span class="comment">@SuppressWarnings("unchecked")</span>
public T parse(String response) {
    Class<span class="variable">&lt;?&gt;</span> c = this.getGenericType();
    try {
        Constructor<span class="variable">&lt;T&gt;</span> constructor = (Constructor<span class="variable">&lt;T&gt;</span>) c.getDeclaredConstructor(String.class);
        T result = constructor.newInstance(response);
        return result;
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}

/<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> è·å–Tçš„ç±»å‹
 <span class="keyword">*</span> <span class="comment">@param</span>
 <span class="keyword">*</span> <span class="comment">@return</span>
 <span class="keyword">*</span>/
private Class<span class="variable">&lt;?&gt;</span> getGenericType() {
    Type genType = getClass().getGenericSuperclass();
    if (!(genType instanceof ParameterizedType)) {
        return Object.class;
    }
    Type[] params = ((ParameterizedType) genType).getActualTypeArguments();
    if (params.length <span class="variable">&lt; 1) {
        throw new RuntimeException("Index outof bounds");
    }
    if (!(params[0] instanceof Class)) {
        return Object.class;
    }
    return (Class&lt;?&gt;</span>) params[0];
}

 /<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> è¯·æ±‚å®Œæˆåä»¥å¯¹è±¡å½¢å¼è¿”å›æœåŠ¡å™¨çš„å“åº”çš„ç»“æœ
 <span class="keyword">*</span>
 <span class="keyword">*</span> <span class="comment">@param bean</span>
 <span class="keyword">*</span>             æœåŠ¡å™¨è¿”å›çš„å“åº”å­—ç¬¦ä¸²è§£æåå¾—åˆ°çš„å¯¹è±¡
 <span class="keyword">*</span>        
 <span class="keyword">*</span>/
public abstract void onComplete(T bean);

/<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> æœåŠ¡å™¨è¿”å›äº†é”™è¯¯ç»“æœï¼Œå·²ç»æ­£ç¡®çš„é“¾æ¥ä¸Šäº†æœåŠ¡å™¨ä½†æœ‰é”™è¯¯å¦‚ï¼šç¼ºå°‘å‚æ•°.ç­‰
 <span class="keyword">*</span>
 <span class="keyword">*</span> <span class="comment">@param customError</span>
 <span class="keyword">*</span>/
public abstract void onError(CustomError customError);

/<span class="keyword">*</span><span class="keyword">*</span>
 <span class="keyword">*</span> åœ¨è¯·æ±‚æœŸé—´å‘ç”Ÿäº†ä¸¥é‡é—®é¢˜ï¼ˆå¦‚ï¼šç½‘ç»œæ•…éšœã€è®¿é—®çš„åœ°å€ä¸å­˜åœ¨ç­‰ï¼‰
 <span class="keyword">*</span>
 <span class="keyword">*</span> <span class="comment">@param fault</span>
 <span class="keyword">*</span>/
public abstract void onFault(CustomError fault);
</code></pre><p>}</p>
<h2 id="CustomError">CustomError</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">public class CustomError extends RuntimeException &#123;</div><div class="line"></div><div class="line">	private static final long serialVersionUID = 1L;</div><div class="line">    /**</div><div class="line">     * é”™è¯¯ç </div><div class="line">     */</div><div class="line">	private int mErrorCode;</div><div class="line"></div><div class="line">	/** åŸå§‹å“åº”URL */</div><div class="line">	private String mResponse;</div><div class="line"></div><div class="line">	public CustomError() &#123;</div><div class="line">		super();</div><div class="line">	&#125;</div><div class="line">	public CustomError(String errorMessage) &#123;</div><div class="line">		super(errorMessage);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public CustomError(int errorCode, String errorMessage, String orgResponse) &#123;</div><div class="line">		super(errorMessage);</div><div class="line">		this.mErrorCode = errorCode;</div><div class="line">		this.mResponse = orgResponse;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public String getOrgResponse() &#123;</div><div class="line">		return mResponse;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public int  getErrorCode() &#123;</div><div class="line">		return mErrorCode;</div><div class="line">	&#125;</div><div class="line">	@Override</div><div class="line">	public String toString() &#123;</div><div class="line">		return &quot;errorCode:&quot; + this.mErrorCode + &quot;\nerrorMessage:&quot;</div><div class="line">				+ this.getMessage() + &quot;\norgResponse:&quot; + this.mResponse;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/**</div><div class="line">	 * å°†æœåŠ¡å™¨è¿”å›çš„errorMessageè½¬æ¢æˆå®šä¹‰çš„æ˜“äºç†è§£çš„å­—ç¬¦ä¸²</div><div class="line">	 *</div><div class="line">	 * @param errorCode</div><div class="line">	 * 			æœåŠ¡å™¨è¿”å›çš„é”™è¯¯ä»£ç </div><div class="line">	 * @param errorMessage</div><div class="line">	 * 			æœåŠ¡å™¨è¿”å›çš„é”™è¯¯å­—ç¬¦ä¸²ï¼Œå’Œé”™è¯¯ä»£ç ä¸€ä¸€å¯¹åº”</div><div class="line">	 * @return</div><div class="line">	 */</div><div class="line">	public static String interpretErrorMessage(int errorCode, String errorMessage) &#123;</div><div class="line">		switch (errorCode)</div><div class="line">		&#123;</div><div class="line">			/**</div><div class="line">			 * é”™è¯¯å¤„ç†</div><div class="line">			 */</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		return errorMessage;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="RequestParam">RequestParam</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> */</div><div class="line">public abstract class RequestParam &#123;</div><div class="line"></div><div class="line"></div><div class="line">	/**</div><div class="line">	 * è®¾ç½®è¯·æ±‚å‚æ•°</div><div class="line">	 * @return</div><div class="line">	 */</div><div class="line">    public abstract Bundle getParam();</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ResponseBean">ResponseBean</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">public abstract class ResponseBean implements Serializable &#123;</div><div class="line"></div><div class="line">	public String response;</div><div class="line">	//</div><div class="line"></div><div class="line">	public ResponseBean()</div><div class="line">	&#123;</div><div class="line"></div><div class="line">	&#125;</div><div class="line">	public ResponseBean(String response) throws JSONException &#123;</div><div class="line">		// TODO Auto-generated constructor stub</div><div class="line"></div><div class="line">		if(response == null || response.equals(&quot;&quot;) ||response.equals(&quot;null&quot;))</div><div class="line">			throw new JSONException(&quot;æ•°æ®è§£æå¼‚å¸¸&quot;);</div><div class="line"></div><div class="line">		this.response = response;</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public void setResponse(String response)&#123;</div><div class="line">		this.response = response;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	public String getResponse() &#123;</div><div class="line">		return response;</div><div class="line">	&#125;</div><div class="line">	/**</div><div class="line">	 * ä¿å­˜</div><div class="line">	 */</div><div class="line">	protected  void saveModel()</div><div class="line">	&#123;</div><div class="line">		   L.i(&quot;save_model&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	/**</div><div class="line">	 * æ›´æ–°</div><div class="line">	 */</div><div class="line">	protected  void updateModel()</div><div class="line">	&#123;</div><div class="line">		 L.i(&quot;update_model&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	/**</div><div class="line">	 * åˆ é™¤</div><div class="line">	 */</div><div class="line">	protected   void deleteModel()</div><div class="line">	&#123;</div><div class="line">		 L.i(&quot;delete_model&quot;);</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ç”¨æ³•">ç”¨æ³•</h1><p>å‚è§Demoï¼Œç»™åˆ«äººåšçš„æ¯•ä¸šè®¾è®¡ã€‚</p>
<p>Demoåœ°å€<a href="https://github.com/mzeht/ZhiHuiYun" target="_blank" rel="external">https://github.com/mzeht/ZhiHuiYun</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>åŸºäºhttpclientï¼Œjavaå°è£…ä¸€å¥—Androidç½‘ç»œè¯·æ±‚æ¡†æ¶<br>]]>
    
    </summary>
    
      <category term="Android" scheme="http://mzeht.com/tags/Android/"/>
    
      <category term="è®¾è®¡æ¨¡å¼" scheme="http://mzeht.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="ç½‘ç»œé€šè®¯" scheme="http://mzeht.com/tags/%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/"/>
    
      <category term="å°è£…" scheme="http://mzeht.com/tags/%E5%B0%81%E8%A3%85/"/>
    
      <category term="æ¡†æ¶" scheme="http://mzeht.com/categories/%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[expressæ¡†æ¶]]></title>
    <link href="http://mzeht.com/2016/03/17/express%E6%A1%86%E6%9E%B6/"/>
    <id>http://mzeht.com/2016/03/17/expressæ¡†æ¶/</id>
    <published>2016-03-17T04:08:02.000Z</published>
    <updated>2016-11-27T10:24:23.000Z</updated>
    <content type="html"><![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</h1><h2 id="Expressä»‹ç»">Expressä»‹ç»</h2><p>ã€€ã€€npmæä¾›äº†å¤§é‡çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå…¶ä¸­ä¸ä¹è®¸å¤šWebæ¡†æ¶ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ¬ç« èŠ‚è¦è®²è¿°çš„ä¸€ä¸ªè½»é‡çº§çš„Webæ¡†æ¶ â€”â€”â€” Expressã€‚</p>
<p>ã€€ã€€Expressæ˜¯ä¸€ä¸ªç®€æ´ã€çµæ´»çš„node.js Webåº”ç”¨å¼€å‘æ¡†æ¶, å®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šæ¨¡æ¿è§£æã€é™æ€æ–‡ä»¶æœåŠ¡ã€ä¸­é—´ä»¶ã€è·¯ç”±æ§åˆ¶ç­‰ç­‰,å¹¶ä¸”è¿˜å¯ä»¥ä½¿ç”¨æ’ä»¶æˆ–æ•´åˆå…¶ä»–æ¨¡å—æ¥å¸®åŠ©ä½ åˆ›å»ºå„ç§ Webå’Œç§»åŠ¨è®¾å¤‡åº”ç”¨,æ˜¯ç›®å‰æœ€æµè¡Œçš„åŸºäºNode.jsçš„Webå¼€å‘æ¡†æ¶ï¼Œå¹¶ä¸”æ”¯æŒEjsã€jadeç­‰å¤šç§æ¨¡æ¿ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå…·æœ‰å®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ã€‚</p>
<a id="more"></a>
<p>ã€€ã€€å¥½ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å§ï¼</p>
<p>NPMå®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install express</div></pre></td></tr></table></figure>
<p>è·å–ã€å¼•ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div></pre></td></tr></table></figure>
<p>é€šè¿‡å˜é‡â€œappâ€æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨expressçš„å„ç§æ–¹æ³•äº†ï¼Œå¥½æˆåˆšåˆšå¼€å§‹ï¼Œç»§ç»­åŠ æ²¹å§ï¼</p>
<h2 id="åˆ›å»ºåº”ç”¨">åˆ›å»ºåº”ç”¨</h2><p>ã€€ã€€è®¤è¯†äº†Expressæ¡†æ¶ï¼Œæˆ‘ä»¬å¼€å§‹åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªexpressåº”ç”¨ã€‚</p>
<p>ã€€ã€€åœ¨æˆ‘ä»¬çš„é»˜è®¤é¡¹ç›®ä¸»æ–‡ä»¶app.jsæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line">app.get(&apos;/&apos;, function (request, response) &#123;  </div><div class="line">   response.send(&apos;Hello World!&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>ã€€ã€€è¯´æ˜ï¼šåœ¨åé¢è¯¾ç¨‹å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä¼šç»Ÿä¸€ä½¿ç”¨80ç«¯å£ç”¨äºç›‘å¬è¯·æ±‚ã€‚</p>
<p>ã€€ã€€æ·»åŠ å®Œæ¯•ä¹‹åï¼Œé€šè¿‡å³ä¾§æ çš„â€œæµ‹è¯•åœ°å€â€æ¥æŸ¥çœ‹æµè§ˆå™¨å†…å®¹ï¼Œå½“çœ‹åˆ°â€œHello World!â€å†…å®¹å°±è¡¨æ˜ä¸€ä¸ªç®€å•çš„expressåº”ç”¨å·²ç»åˆ›å»ºæˆåŠŸäº†ã€‚
ã€€ã€€</p>
<h2 id="getè¯·æ±‚">getè¯·æ±‚</h2><p>ã€€å‰é¢æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªç®€å•çš„expressåº”ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹å…·ä½“è®²è¿°å®ƒçš„å…·ä½“å®ç°ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆæ¥å­¦ä¹ Expressçš„å¸¸ç”¨æ–¹æ³•ã€‚</p>
<p>ã€€ã€€getæ–¹æ³• â€”â€” æ ¹æ®è¯·æ±‚è·¯å¾„æ¥å¤„ç†å®¢æˆ·ç«¯å‘å‡ºçš„GETè¯·æ±‚ã€‚</p>
<p>ã€€ã€€æ ¼å¼ï¼šapp.get(path,function(request, response));</p>
<p>ã€€ã€€pathä¸ºè¯·æ±‚çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯requestå’Œresponseï¼Œä»£è¡¨è¯·æ±‚ä¿¡æ¯å’Œå“åº”ä¿¡æ¯ã€‚</p>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.get(&apos;/&apos;, function(request, response) &#123;</div><div class="line">   response.send(&apos;Welcome to the homepage!&apos;);</div><div class="line">&#125;);</div><div class="line">app.get(&apos;/about&apos;, function(request, response) &#123;</div><div class="line">   response.send(&apos;Welcome to the about page!&apos;);</div><div class="line">&#125;);</div><div class="line">app.get(&quot;*&quot;, function(request, response) &#123;</div><div class="line">    response.send(&quot;404 error!&quot;);</div><div class="line">&#125;);</div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>ã€€ã€€ä¸Šé¢ç¤ºä¾‹ä¸­ï¼ŒæŒ‡å®šäº†abouté¡µé¢è·¯å¾„ã€æ ¹è·¯å¾„å’Œæ‰€æœ‰è·¯å¾„çš„å¤„ç†æ–¹æ³•ã€‚å¹¶ä¸”åœ¨å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œä½¿ç”¨HTTPå›åº”çš„sendæ–¹æ³•ï¼Œè¡¨ç¤ºå‘æµè§ˆå™¨å‘é€ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>ã€€ã€€å‚ç…§ä»¥ä¸Šä»£ç ï¼Œè¯•è¯•è‡ªå·±è®¾å®šä¸€ä¸ªgetè¯·æ±‚è·¯å¾„ï¼Œç„¶åæµè§ˆå™¨è®¿é—®è¯¥åœ°å€æ˜¯å¦å¯ä»¥è¯·æ±‚æˆåŠŸã€‚
ã€€ã€€</p>
<h2 id="allå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">allå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>ã€€ã€€å’Œgetå‡½æ•°ä¸åŒapp.all()å‡½æ•°å¯ä»¥åŒ¹é…æ‰€æœ‰çš„HTTPåŠ¨è¯ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥è¿‡æ»¤æ‰€æœ‰è·¯å¾„çš„è¯·æ±‚ï¼Œå¦‚æœä½¿ç”¨allå‡½æ•°å®šä¹‰ä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»å…ˆé€šè¿‡æ­¤è¯¥ä¸­é—´ä»¶ã€‚</p>
<p>æ ¼å¼ï¼šapp.all(path,function(request, response));</p>
<p>å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨allå‡½æ•°åœ¨è¯·æ±‚ä¹‹å‰è®¾ç½®å“åº”å¤´å±æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">var express = require(&quot;express&quot;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.all(&quot;*&quot;, function(request, response, next) &#123;</div><div class="line">    response.writeHead(200, &#123; &quot;Content-Type&quot;: &quot;text/html;charset=utf-8&quot; &#125;);      //è®¾ç½®å“åº”å¤´å±æ€§å€¼</div><div class="line">    next();</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.get(&quot;/&quot;, function(request, response) &#123;</div><div class="line">    response.end(&quot;æ¬¢è¿æ¥åˆ°é¦–é¡µ!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.get(&quot;/about&quot;, function(request, response) &#123;</div><div class="line">    response.end(&quot;æ¬¢è¿æ¥åˆ°abouté¡µé¢!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.get(&quot;*&quot;, function(request, response) &#123;</div><div class="line">    response.end(&quot;404 - æœªæ‰¾åˆ°!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>ã€€ã€€ä¸Šé¢ä»£ç å‚æ•°ä¸­çš„â€œ*â€è¡¨ç¤ºå¯¹æ‰€æœ‰è·¯å¾„æœ‰æ•ˆï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ç»™ç‰¹å®šå‰ç¼€è·¯å¾„æˆ–è€…ä»»æ„è·¯å¾„ä¸Šå¤„ç†æ—¶ä¼šç‰¹åˆ«æœ‰ç”¨ï¼Œä¸ç®¡æˆ‘ä»¬è¯·æ±‚ä»»ä½•è·¯å¾„éƒ½ä¼šäº‹å…ˆç»è¿‡allå‡½æ•°ã€‚
ã€€ã€€</p>
<h2 id="useåŸºæœ¬ç”¨æ³•1">useåŸºæœ¬ç”¨æ³•1</h2><p>useæ˜¯expressè°ƒç”¨ä¸­é—´ä»¶çš„æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªå‡½æ•°ã€‚</p>
<p>æ ¼å¼ï¼šapp.use([path], function(request, response, next){});</p>
<p>å¯é€‰å‚æ•°pathé»˜è®¤ä¸ºâ€/â€œã€‚</p>
<p>1.ä½¿ç”¨ä¸­é—´ä»¶</p>
<p>app.use(express.static(path.join(__dirname, â€˜/â€˜)));<br>å¦‚ä¸Šå‘¢ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨useå‡½æ•°è°ƒç”¨expressä¸­é—´ä»¶è®¾å®šäº†é™æ€æ–‡ä»¶ç›®å½•çš„è®¿é—®è·¯å¾„(è¿™é‡Œå‡è®¾ä¸ºæ ¹è·¯å¾„)ã€‚</p>
<p>2.å¦‚ä½•è¿ç»­è°ƒç”¨ä¸¤ä¸ªä¸­é—´ä»¶å‘¢ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.use(function(request, response, next)&#123;</div><div class="line">    console.log(&quot;methodï¼š&quot;+request.method+&quot; ==== &quot;+&quot;urlï¼š&quot;+request.url);</div><div class="line">    next();</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.use(function(request, response)&#123;</div><div class="line">    response.writeHead(200, &#123; &quot;Content-Type&quot;: &quot;text/html;charset=utf-8&quot; &#125;);</div><div class="line">    response.end(&apos;ç¤ºä¾‹ï¼šè¿ç»­è°ƒç”¨ä¸¤ä¸ªä¸­é—´ä»¶&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>å›è°ƒå‡½æ•°çš„nextå‚æ•°ï¼Œè¡¨ç¤ºæ¥å—å…¶ä»–ä¸­é—´ä»¶çš„è°ƒç”¨ï¼Œå‡½æ•°ä½“ä¸­çš„next()ï¼Œè¡¨ç¤ºå°†è¯·æ±‚æ•°æ®ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚</p>
<p>ä¸Šé¢ä»£ç å…ˆè°ƒç”¨ç¬¬ä¸€ä¸ªä¸­é—´ä»¶ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºä¸€è¡Œä¿¡æ¯ï¼Œç„¶åé€šè¿‡next()ï¼Œè°ƒç”¨ç¬¬äºŒä¸ªä¸­é—´ä»¶ï¼Œè¾“å‡ºHTTPå›åº”ã€‚ç”±äºç¬¬äºŒä¸ªä¸­é—´ä»¶æ²¡æœ‰è°ƒç”¨nextæ–¹æ³•ï¼Œæ‰€ä»¥reqå¯¹è±¡å°±ä¸å†å‘åä¼ é€’äº†ã€‚</p>
<h2 id="useåŸºæœ¬ç”¨æ³•2">useåŸºæœ¬ç”¨æ³•2</h2><p>useæ–¹æ³•ä¸ä»…å¯ä»¥è°ƒç”¨ä¸­é—´ä»¶ï¼Œè¿˜å¯ä»¥æ ¹æ®è¯·æ±‚çš„ç½‘å€ï¼Œè¿”å›ä¸åŒçš„ç½‘é¡µå†…å®¹ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">var express = require(&quot;express&quot;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.use(function(request, response, next) &#123;</div><div class="line">   if(request.url == &quot;/&quot;) &#123;</div><div class="line">      response.send(&quot;Welcome to the homepage!&quot;);</div><div class="line">   &#125;else &#123;</div><div class="line">      next();</div><div class="line">   &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.use(function(request, response, next) &#123;</div><div class="line">   if(request.url == &quot;/about&quot;) &#123;</div><div class="line">     response.send(&quot;Welcome to the about page!&quot;);</div><div class="line">   &#125;else &#123;</div><div class="line">     next();</div><div class="line">   &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.use(function(request, response) &#123;</div><div class="line">  response.send(&quot;404 error!&quot;);</div><div class="line">&#125;);</div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡request.urlå±æ€§ï¼Œåˆ¤æ–­è¯·æ±‚çš„ç½‘å€ï¼Œä»è€Œè¿”å›ä¸åŒçš„å†…å®¹ã€‚</p>
<h2 id="å›è°ƒå‡½æ•°">å›è°ƒå‡½æ•°</h2><p>ã€€ã€€Expresså›è°ƒå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯request(ç®€ç§°req)å’Œresponse(ç®€ç§°res)ï¼Œrequestä»£è¡¨å®¢æˆ·ç«¯å‘æ¥çš„HTTPè¯·æ±‚ï¼Œresponseä»£è¡¨å‘å‘å®¢æˆ·ç«¯çš„HTTPå›åº”ï¼Œè¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯¹è±¡ã€‚ç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function(req, res) &#123;</div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="è·å–ä¸»æœºåã€è·¯å¾„å">è·å–ä¸»æœºåã€è·¯å¾„å</h2><p>ã€€ã€€ä»Šå¤©æˆ‘ä»¬å°±å…ˆæ¥å­¦ä¹ å¦‚ä½•ä½¿ç”¨reqå¯¹è±¡æ¥å¤„ç†å®¢æˆ·ç«¯å‘æ¥çš„HTTPè¯·æ±‚ã€‚</p>
<p>1.req.hostè¿”å›è¯·æ±‚å¤´é‡Œå–çš„ä¸»æœºå(ä¸åŒ…å«ç«¯å£å·)ã€‚</p>
<p>2.req.pathè¿”å›è¯·æ±‚çš„URLçš„è·¯å¾„åã€‚</p>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.listen(8000);</div><div class="line"></div><div class="line">app.get(&quot;*&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.path);</div><div class="line">    //console.log(req.host);</div><div class="line">    res.send(&quot;req.hostè·å–ä¸»æœºåï¼Œreq.pathè·å–è¯·æ±‚è·¯å¾„å!&quot;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¯•ä¸€è¯•åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä»»æ„ä¸€ä¸ªè¯·æ±‚è·¯å¾„ï¼Œé€šè¿‡reqæŸ¥çœ‹ä¸»æœºåæˆ–è¯·æ±‚è·¯å¾„ã€‚</p>
<p><a href="http://localhost:8000/about" target="_blank" rel="external">http://localhost:8000/about</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/about</div><div class="line">/favicon.ico</div></pre></td></tr></table></figure>
<h2 id="queryåŸºæœ¬ç”¨æ³•">queryåŸºæœ¬ç”¨æ³•</h2><p>ã€€ã€€queryæ˜¯ä¸€ä¸ªå¯è·å–å®¢æˆ·ç«¯getè¯·æ±‚è·¯å¾„å‚æ•°çš„å¯¹è±¡å±æ€§ï¼ŒåŒ…å«ç€è¢«è§£æè¿‡çš„è¯·æ±‚å‚æ•°å¯¹è±¡ï¼Œé»˜è®¤ä¸º{}ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.get(&quot;*&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.query.å‚æ•°å);</div><div class="line">    res.send(&quot;æµ‹è¯•queryå±æ€§!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>é€šè¿‡req.queryè·å–getè¯·æ±‚è·¯å¾„çš„å¯¹è±¡å‚æ•°å€¼ã€‚</p>
<p>æ ¼å¼ï¼šreq.query.å‚æ•°åï¼›è¯·æ±‚è·¯å¾„å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<blockquote>
<p>ä¾‹1ï¼š /search?n=Lenka</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">req.query.n  // &quot;Lenka&quot;</div></pre></td></tr></table></figure>
<blockquote>
<p>ä¾‹2ï¼š /shoes?order=desc&amp;shoe[color]=blue&amp;shoe[type]=converse</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">req.query.order  // &quot;desc&quot;</div><div class="line"> </div><div class="line">req.query.shoe.color  // &quot;blue&quot;</div><div class="line"> </div><div class="line">req.query.shoe.type  // &quot;converse&quot;</div></pre></td></tr></table></figure>
<p>è¯•ä¸€è¯•getè¯·æ±‚ä¸€ä¸ªå¸¦å‚æ•°è·¯å¾„ï¼Œä½¿ç”¨â€œreq.query.å‚æ•°åâ€æ–¹æ³•è·å–è¯·æ±‚å‚æ•°å€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/about&apos;,function(req,res)&#123;</div><div class="line">    console.log(req.query.name);</div><div class="line">    res.send(&quot;name=&quot;+req.query.name);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><a href="http://localhost:8000/about?name=mzeht&amp;name=jj" target="_blank" rel="external">http://localhost:8000/about?name=mzeht&amp;name=jj</a></p>
<p>name=mzeht,jj</p>
<h2 id="paramåŸºæœ¬ç”¨æ³•">paramåŸºæœ¬ç”¨æ³•</h2><p>å’Œå±æ€§queryä¸€æ ·ï¼Œé€šè¿‡req.paramæˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–è¢«è§£æè¿‡çš„è¯·æ±‚å‚æ•°å¯¹è±¡çš„å€¼ã€‚</p>
<p>æ ¼å¼ï¼šreq.param(â€œå‚æ•°åâ€)ï¼›è¯·æ±‚è·¯å¾„å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<p>ä¾‹1ï¼š è·å–è¯·æ±‚æ ¹è·¯å¾„çš„å‚æ•°å€¼ï¼Œå¦‚/?n=Lenkaï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.get(&quot;/&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.param(&quot;n&quot;)); //Lenka</div><div class="line">    res.send(&quot;ä½¿ç”¨req.paramå±æ€§è·å–è¯·æ±‚æ ¹è·¯å¾„çš„å‚æ•°å¯¹è±¡å€¼!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>ä¾‹2ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥è·å–å…·æœ‰ç›¸åº”è·¯ç”±è§„åˆ™çš„è¯·æ±‚å¯¹è±¡ï¼Œå‡è®¾è·¯ç”±è§„åˆ™ä¸º /user/:name/ï¼Œè¯·æ±‚è·¯å¾„/user/mike,å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.get(&quot;/user/:name/&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.param(&quot;name&quot;)); //mike</div><div class="line">    res.send(&quot;ä½¿ç”¨req.paramå±æ€§è·å–å…·æœ‰è·¯ç”±è§„åˆ™çš„å‚æ•°å¯¹è±¡å€¼!&quot;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>PSï¼šæ‰€è°“â€œè·¯ç”±â€ï¼Œå°±æ˜¯æŒ‡ä¸ºä¸åŒçš„è®¿é—®è·¯å¾„ï¼ŒæŒ‡å®šä¸åŒçš„å¤„ç†æ–¹æ³•ã€‚<br>å¦‚æœæ²¡æœ‰ç›¸åº”å‚æ•°çš„æ•°æ® req.param è¿”å›å€¼ä¸ºundefined;</p>
<p>çœ‹äº†ä¸Šé¢çš„ç¤ºä¾‹ï¼Œè¯•ä¸€è¯•ä½¿ç”¨req.paramå±æ€§è§£æä¸€ä¸ªè¯·æ±‚è·¯å¾„å¯¹è±¡ï¼Œå¹¶è·å–è¯·æ±‚å‚æ•°å€¼ã€‚</p>
<h2 id="paramsåŸºæœ¬ç”¨æ³•">paramsåŸºæœ¬ç”¨æ³•</h2><p>å’Œparamç›¸ä¼¼ï¼Œä½†paramsæ˜¯ä¸€ä¸ªå¯ä»¥è§£æåŒ…å«ç€æœ‰å¤æ‚å‘½åè·¯ç”±è§„åˆ™çš„è¯·æ±‚å¯¹è±¡çš„å±æ€§ã€‚</p>
<p>æ ¼å¼ï¼šreq.params.å‚æ•°åï¼›</p>
<p>ä¾‹1. å¦‚ä¸Šè¯¾æ—¶è¯·æ±‚æ ¹è·¯å¾„çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·è·å–ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line"> </div><div class="line">app.get(&quot;/user/:name/&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.params.name); //mike</div><div class="line">    res.send(&quot;ä½¿ç”¨req.paramså±æ€§è·å–å…·æœ‰è·¯ç”±è§„åˆ™çš„å‚æ•°å¯¹è±¡å€¼!&quot;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹è¿è¡Œç»“æœï¼Œå’Œparamå±æ€§åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒæ ·è·å–nameå‚æ•°å€¼ã€‚</p>
<p>ä¾‹2ï¼šå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯·æ±‚å¤æ‚çš„è·¯ç”±è§„åˆ™ï¼Œå¦‚/user/:name/:idï¼Œå‡è®¾è¯·æ±‚åœ°å€ä¸ºï¼š/user/mike/123ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.get(&quot;/user/:name/:id&quot;, function(req, res) &#123;</div><div class="line">    console.log(req.params.id); //&quot;123&quot;</div><div class="line">    res.send(&quot;ä½¿ç”¨req.paramså±æ€§å¤æ‚è·¯ç”±è§„åˆ™çš„å‚æ•°å¯¹è±¡å€¼!&quot;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¯¹äºè¯·æ±‚åœ°å€å…·æœ‰è·¯ç”±è§„åˆ™çš„è·¯å¾„æ¥è¯´ï¼Œå±æ€§paramsæ¯”paramå±æ€§æ˜¯ä¸æ˜¯åˆå¼ºå¤§äº†é‚£ä¹ˆä¸€ç‚¹ç‚¹å‘¢ï¼</p>
<h2 id="sendåŸºæœ¬ç”¨æ³•">sendåŸºæœ¬ç”¨æ³•</h2><p>send()æ–¹æ³•å‘æµè§ˆå™¨å‘é€ä¸€ä¸ªå“åº”ä¿¡æ¯ï¼Œå¹¶å¯ä»¥æ™ºèƒ½å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®ã€‚æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p>res.send([body|status], [body]);<br>1.å½“å‚æ•°ä¸ºä¸€ä¸ªStringæ—¶ï¼ŒContent-Typeé»˜è®¤è®¾ç½®ä¸ºâ€text/htmlâ€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.send(&apos;Hello World&apos;); //Hello World</div></pre></td></tr></table></figure>
<p>2.å½“å‚æ•°ä¸ºArrayæˆ–Objectæ—¶ï¼ŒExpressä¼šè¿”å›ä¸€ä¸ªJSONã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res.send(&#123; user: &apos;tobi&apos; &#125;); //&#123;&quot;user&quot;:&quot;tobi&quot;&#125;</div><div class="line">res.send([1,2,3]); //[1,2,3]</div></pre></td></tr></table></figure>
<p>3.å½“å‚æ•°ä¸ºä¸€ä¸ªNumberæ—¶ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸Šé¢æåˆ°çš„ä»»ä½•ä¸€æ¡åœ¨å“åº”ä½“é‡Œï¼ŒExpressä¼šå¸®ä½ è®¾ç½®ä¸€ä¸ªå“åº”ä½“ï¼Œæ¯”å¦‚ï¼š200ä¼šè¿”å›å­—ç¬¦â€OKâ€ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res.send(200); // OK</div><div class="line">res.send(404); // Not Found</div><div class="line">res.send(500); // Internal Server Error</div></pre></td></tr></table></figure>
<p>sendæ–¹æ³•åœ¨è¾“å‡ºå“åº”æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œä¸€äº›è®¾ç½®ï¼Œæ¯”å¦‚HEADä¿¡æ¯ã€HTTPç¼“å­˜æ”¯æŒç­‰ç­‰ã€‚</p>
<p>ps:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Fri, 18 Mar 2016 11:02:43 GMT express deprecated req.param(name): Use req.params, req.body, or req.query instead at app.js:37:21</div><div class="line">Fri, 18 Mar 2016 11:02:43 GMT express deprecated req.param(name): Use req.params, req.body, or req.query instead at app.js:38:21</div><div class="line">Fri, 18 Mar 2016 11:02:43 GMT express deprecated res.send(status): Use res.sendStatus(status) instead at app.js:42:9</div></pre></td></tr></table></figure>
<h1 id="å‡†å¤‡ç™»é™†">å‡†å¤‡ç™»é™†</h1><h2 id="æ¨¡æ¿å¼•æ“">æ¨¡æ¿å¼•æ“</h2><p>ã€€ã€€ä»æœ¬èŠ‚è¯¾ç¨‹å¼€å§‹æˆ‘ä»¬è¦ä½¿ç”¨expressæ¡†æ¶å®ç°ä¸€ä¸ªç®€å•çš„ç”¨æˆ·ç™»é™†åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬å…ˆå‡†å¤‡ä¸€ä¸‹ç›¸å…³èµ„æºã€‚</p>
<p>ã€€ã€€åœ¨nodejsä¸­ä½¿ç”¨expressæ¡†æ¶ï¼Œå®ƒé»˜è®¤çš„æ˜¯ejså’Œjadeæ¸²æŸ“æ¨¡æ¿ï¼Œä»Šå¤©æˆ‘ä»¬å°±ä»¥ejsæ¨¡æ¿ä¸ºä¾‹ï¼Œè®²è¿°æ¨¡æ¿æ¸²æŸ“ç½‘é¡µæ¨¡æ¿çš„åŸºç¡€åŠŸèƒ½ã€‚</p>
<p>1.ejsæ¨¡æ¿å®‰è£…æ–¹æ³•</p>
<p>npm install ejs<br>2.ç›®å½•ä¸‹å®‰è£…å¥½äº†ä¹‹åï¼Œå¦‚ä½•è°ƒç”¨å‘¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>//æŒ‡å®šæ¸²æŸ“æ¨¡æ¿æ–‡ä»¶çš„åç¼€åä¸ºejs<br>app.set(â€˜view engineâ€™, â€˜ejsâ€™);<br>é»˜è®¤ejsæ¨¡æ¿åªæ”¯æŒæ¸²æŸ“ä»¥ejsä¸ºæ‰©å±•åçš„æ–‡ä»¶ï¼Œå¯èƒ½åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šè§‰å¾—å®ƒçš„ä»£ç ä¹¦å†™æ–¹å¼å¾ˆä¸çˆ½è¿˜æ˜¯æƒ³ç”¨htmlçš„å½¢å¼å»ä¹¦å†™ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Œè¿™æ—¶å°±å¾—å»ä¿®æ”¹æ¨¡æ¿å¼•æ“äº†ï¼Œä¹Ÿå°±ä¼šç”¨åˆ°expressçš„engineå‡½æ•°ã€‚</p>
<p>engineæ³¨å†Œæ¨¡æ¿å¼•æ“çš„å‡½æ•°ï¼Œå¤„ç†æŒ‡å®šçš„åç¼€åæ–‡ä»¶ã€‚</p>
<p>// ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶çš„åç¼€åä¸ºhtml<br>app.set( â€˜view engineâ€™, â€˜htmlâ€™ );<br>// è¿è¡Œejsæ¨¡å—<br>app.engine( â€˜.htmlâ€™, require( â€˜ejsâ€™ ).<strong>express );<br>â€œ</strong>expressâ€ï¼Œejsæ¨¡å—çš„ä¸€ä¸ªå…¬å…±å±æ€§ï¼Œè¡¨ç¤ºè¦æ¸²æŸ“çš„æ–‡ä»¶æ‰©å±•åã€‚</p>
<h2 id="é™æ€èµ„æº">é™æ€èµ„æº</h2><p>ç”±äºç¯å¢ƒçš„é™åˆ¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸ä½¿ç”¨é™æ€èµ„æºäº†ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­æˆ‘ä»¬è‚¯å®šä¼šç”¨åˆ°ï¼Œå…·ä½“ä½¿ç”¨è§„åˆ™å·²åœ¨ä¸‹é¢åˆ—å‡ºï¼Œå¯å‚è€ƒã€‚</p>
<p>å¦‚æœè¦åœ¨ç½‘é¡µä¸­åŠ è½½é™æ€æ–‡ä»¶ï¼ˆcssã€jsã€imgï¼‰ï¼Œå°±éœ€è¦å¦å¤–æŒ‡å®šä¸€ä¸ªå­˜æ”¾é™æ€æ–‡ä»¶çš„ç›®å½•ï¼Œå½“æµè§ˆå™¨å‘å‡ºéHTMLæ–‡ä»¶è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å°±ä¼šåˆ°è¿™ä¸ªç›®å½•ä¸‹å»å¯»æ‰¾ç›¸å…³æ–‡ä»¶ã€‚</p>
<p>1.é¡¹ç›®ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªå­˜æ”¾é™æ€æ–‡ä»¶çš„ç›®å½•ä¸ºpublicã€‚</p>
<p>2.åœ¨publicç›®å½•ä¸‹åœ¨æ·»åŠ ä¸‰ä¸ªå­˜æ”¾jsã€cssã€imgçš„ç›®å½•ï¼Œç›¸åº”å–åä¸ºjavascriptsã€stylesheetsã€imagesã€‚</p>
<p>3.ç„¶åå°±å¯ä»¥æŠŠç›¸å…³æ–‡ä»¶æ”¾åˆ°ç›¸åº”çš„ç›®å½•ä¸‹äº†ã€‚</p>
<p>4.æ¯”å¦‚ï¼Œæµè§ˆå™¨å‘å‡ºå¦‚ä¸‹çš„æ ·å¼è¡¨è¯·æ±‚ï¼š</p>
<p> <link href="/stylesheets/bootstrap.min.css" rel="stylesheet" media="screen"><br>æœåŠ¡å™¨ç«¯å°±åˆ°public/stylesheets/ç›®å½•ä¸­å¯»æ‰¾bootstrap.min.cssæ–‡ä»¶ã€‚</p>
<p>æœ‰äº†é™æ€ç›®å½•æ–‡ä»¶ï¼Œæˆ‘ä»¬è¿˜å¾—åœ¨å¯åŠ¨æ–‡ä»¶é‡Œå‘Šè¯‰å®ƒè¿™ä¸ªé™æ€æ–‡ä»¶è·¯å¾„ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.use(express.static(require(&apos;path&apos;).join(__dirname, &apos;public&apos;)));</div></pre></td></tr></table></figure>
<p>PSï¼šexpress.static â€”â€” æŒ‡å®šé™æ€æ–‡ä»¶çš„æŸ¥æ‰¾ç›®å½•ã€‚</p>
<p>ä½¿ç”¨useå‡½æ•°è°ƒç”¨ä¸­é—´ä»¶æŒ‡å®šexpressé™æ€è®¿é—®ç›®å½•ï¼Œâ€™publicâ€™å°±æ˜¯æˆ‘ä»¬æˆ‘ä»¬æ–°å»ºçš„ç”¨æ¥å­˜æ”¾é™æ€æ–‡ä»¶çš„æ€»ç›®å½•ã€‚</p>
<h2 id="æ·»åŠ è§†å›¾">æ·»åŠ è§†å›¾</h2><p>å¥½ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥æ·»åŠ ç½‘é¡µæ¨¡æ¿äº†ï¼Œé¡¹ç›®ä¸­æˆ‘ä»¬ä¼šæ–°å»ºä¸€ä¸ªç›®å½•ç”¨æ¥å•ç‹¬å­˜æ”¾æ¨¡æ¿æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ç»Ÿä¸€æ”¾åˆ°æ ¹è·¯å¾„ä¸Šäº†ã€‚</p>
<p>ä¸‹é¢å¼€å§‹æ–°å»ºindex.htmlã€login.htmlã€home.htmlä¸‰ä¸ªé¡µé¢ã€‚</p>
<p>index.htmlé¡µé¢å‚è€ƒå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;height:400px;width:550px;margin:50px auto;margin-left:auto;border:solid 1px;background: rgb(246, 246, 253);&quot;&gt;</div><div class="line">    &lt;div style=&quot;margin-left: 35px;&quot;&gt;</div><div class="line"># é¦–é¡µ</div><div class="line"></div><div class="line"></div><div class="line">        &lt;form action=&quot;#&quot;  role=&quot;form&quot; style=&quot;margin-top: 90px;margin-left: 60px;&quot;&gt;</div><div class="line"># æ¬¢è¿è¿›å…¥é¦–é¡µï¼</div><div class="line">            &lt;div style=&quot;margin-top: 145px;&quot;&gt;</div><div class="line">                &lt;input type=&quot;button&quot; value=&quot;ç™» é™†&quot; /&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>login.htmlé¡µé¢å‚è€ƒå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">    &lt;title&gt;ç”¨æˆ·ç™»å½•&lt;/title&gt;</div><div class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">    &lt;script src=&quot;http://code.jquery.com/jquery-2.1.1.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">...</div><div class="line"> </div><div class="line">&lt;div style=&quot;height:300px;width:350px;margin:100px auto;margin-left:auto;border:solid 1px;background: rgb(246, 246, 253);&quot;&gt;</div><div class="line">    &lt;div style=&quot;width:200px;margin:auto;margin-top:50px;&quot;&gt;</div><div class="line"># ç”¨æˆ·ç™»å½•</div><div class="line">        &lt;form action=&quot;#&quot;  role=&quot;form&quot; method=&quot;post&quot; &gt;</div><div class="line">            &lt;input id=&quot;username&quot; type=&quot;text&quot; name=&quot;username&quot; style=&quot;margin: 20px 0px;&quot; /&gt;</div><div class="line">            &lt;input id=&quot;password&quot; type=&quot;password&quot; name=&quot;password&quot; /&gt;</div><div class="line">            &lt;div style=&quot;margin-top:30px;margin-left:125px;&quot;&gt;</div><div class="line">                &lt;input type=&quot;button&quot; value=&quot;ç™» é™†&quot; /&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>home.htmlé¡µé¢å‚è€ƒå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;div style=&quot;height:400px;width:550px;margin:50px auto;margin-left:auto;border:solid 1px;background: rgb(246, 246, 253);&quot;&gt;</div><div class="line">    &lt;div style=&quot;margin-left: 45px;&quot;&gt;</div><div class="line"># ä¸»é¡µ</div><div class="line">        &lt;form action=&quot;#&quot;  role=&quot;form&quot; style=&quot;margin-top: 90px;&quot;&gt;</div><div class="line"># ç™»é™†æˆåŠŸï¼</div><div class="line">            &lt;div style=&quot;margin-top: 145px;&quot;&gt;</div><div class="line">                &lt;input  type=&quot;button&quot; value=&quot;é€€ å‡º&quot; /&gt;</div><div class="line">            &lt;/div&gt;</div><div class="line">        &lt;/form&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>å’Œé™æ€æ–‡ä»¶ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿè¦è®¾ç½®viewså­˜æ”¾çš„ç›®å½•ï¼Œå¦‚ä¸‹ï¼š<br>// è®¾å®šviewså˜é‡ï¼Œæ„ä¸ºè§†å›¾å­˜æ”¾çš„ç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.set(&apos;views&apos;, __dirname);</div></pre></td></tr></table></figure>
<p>æœ‰äº†ç½‘é¡µæ¨¡æ¿å’ŒæŒ‡å®šç›®å½•ï¼Œä¸‹é¢å°±å¯ä»¥è®¿é—®å®ƒä»¬äº†ã€‚</p>
<h2 id="è®¿é—®è§†å›¾">è®¿é—®è§†å›¾</h2><p>æˆ‘ä»¬è¦å¦‚ä½•å¯¹ç½‘é¡µæ¨¡æ¿è¿›è¡Œè®¿é—®å‘¢ï¼Œè¿™å°±è¦ç”¨åˆ°reså¯¹è±¡çš„renderå‡½æ•°äº†ã€‚</p>
<p>1.renderå‡½æ•°ï¼Œå¯¹ç½‘é¡µæ¨¡æ¿è¿›è¡Œæ¸²æŸ“ã€‚</p>
<p>2.æ ¼å¼ï¼šres.render(view, [locals], callback);</p>
<p>3.å‚æ•°viewå°±æ˜¯æ¨¡æ¿çš„æ–‡ä»¶åcallbackç”¨æ¥å¤„ç†è¿”å›çš„æ¸²æŸ“åçš„å­—ç¬¦ä¸²ï¼Œoptionsã€callbackå¯çœç•¥ï¼Œåœ¨æ¸²æŸ“æ¨¡æ¿æ—¶localså¯ä¸ºå…¶æ¨¡æ¿ä¼ å…¥å˜é‡å€¼ï¼Œåœ¨æ¨¡æ¿ä¸­å°±å¯ä»¥è°ƒç”¨æ‰€ä¼ å˜é‡äº†ï¼Œåœ¨åé¢æˆ‘ä»¬ä¼šè®²è¿°å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œä¹Ÿå¯å…ˆè‡ªè¡Œä½¿ç”¨çœ‹å…¶æ•ˆæœã€‚</p>
<p>4.æ¯”å¦‚æ¸²æŸ“æˆ‘ä»¬åˆšåˆšæ·»åŠ çš„index.htmlé¡µé¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨app.jsä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line">var path = require(&apos;path&apos;);</div><div class="line"> </div><div class="line">app.set(&apos;views&apos;, __dirname);</div><div class="line"> </div><div class="line">app.set( &apos;view engine&apos;, &apos;html&apos; );</div><div class="line">app.engine( &apos;.html&apos;, require( &apos;ejs&apos; ).__express );</div><div class="line"> </div><div class="line">app.get(&apos;/&apos;, function(req, res) &#123;</div><div class="line">    res.render(&apos;index&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(8000);</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¹‹ååœ¨æµ‹è¯•åœ°å€æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æ‰€æ¸²æŸ“çš„indexé¡µé¢äº†ï¼Œè¯•ä¸€è¯•å…¶ä»–é¡µé¢æ˜¯å¦ä¹Ÿå¯æ¸²æŸ“æˆåŠŸï¼Ÿ</p>
<h2 id="redirectåŸºæœ¬ç”¨æ³•">redirectåŸºæœ¬ç”¨æ³•</h2><p>redirectæ–¹æ³•å…è®¸ç½‘å€çš„é‡å®šå‘ï¼Œè·³è½¬åˆ°æŒ‡å®šçš„urlå¹¶ä¸”å¯ä»¥æŒ‡å®šstatusï¼Œé»˜è®¤ä¸º302æ–¹å¼ã€‚</p>
<p>æ ¼å¼ï¼šres.redirect([status], url);</p>
<p>ä¾‹1ï¼šä½¿ç”¨ä¸€ä¸ªå®Œæ•´çš„urlè·³è½¬åˆ°ä¸€ä¸ªå®Œå…¨ä¸åŒçš„åŸŸåã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.redirect(&quot;http://www.hubwiz.com&quot;);</div></pre></td></tr></table></figure>
<p>ä¾‹2ï¼šè·³è½¬æŒ‡å®šé¡µé¢ï¼Œæ¯”å¦‚ç™»é™†é¡µï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.redirect(&quot;login&quot;);</div></pre></td></tr></table></figure>
<p>åé¢æˆ‘ä»¬å¼€å§‹å®ç°ç™»é™†åŠŸèƒ½ï¼Œå…ˆè¯•ä¸€ä¸‹redirecté‡å®šå‘ï¼Œè·³è½¬åˆ°æˆ‘ä»¬ç½‘ç«™å¦‚ä½•ï¼Ÿ</p>
<h1 id="å®ç°ç™»é™†">å®ç°ç™»é™†</h1><h2 id="è®¿é—®è§†å›¾-1">è®¿é—®è§†å›¾</h2><p>å‰é¢æˆ‘ä»¬å·²ç»æ·»åŠ äº†è§†å›¾æ¨¡æ¿å¹¶å­¦ä¹ äº†è®¿é—®è§†å›¾çš„æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å°±å…ˆå›é¡¾ä¸€ä¸‹ã€‚</p>
<p>1.å‚è€ƒä»¥ä¸‹ä»£ç ï¼Œåœ°å€æ è®¿é—®è¿™å‡ ä¸ªè¯·æ±‚è·¯å¾„æŸ¥çœ‹æ˜¯å¦å¯ä»¥æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">app.get(&apos;/&apos;, function(req, res) &#123;</div><div class="line">    res.render(&apos;index&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.get(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">    res.render(&apos;login&apos;);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.get(&apos;/home&apos;,function(req,res)&#123;</div><div class="line">    res.render(&apos;home&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å½“æµè§ˆå™¨çœ‹åˆ°äº†ç›¸åº”çš„è§†å›¾é¡µé¢å°±è¯´æ˜æˆ‘ä»¬çš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œç»§ç»­åŠ æ²¹å§ï¼</p>
<h2 id="ç”¨æˆ·ç™»é™†">ç”¨æˆ·ç™»é™†</h2><p>å‰é¢æˆ‘ä»¬å­¦ä¹ äº†expressçš„getè¯·æ±‚æ–¹æ³•ï¼Œä»Šå¤©æˆ‘ä»¬å°±å­¦ä¹ å®ƒçš„postè¯·æ±‚æ–¹æ³•ã€‚</p>
<p>1.postæ–¹æ³• â€”â€” æ ¹æ®è¯·æ±‚è·¯å¾„æ¥å¤„ç†å®¢æˆ·ç«¯å‘å‡ºçš„Postè¯·æ±‚ã€‚</p>
<p>2.æ ¼å¼ï¼šapp.post(path,function(req, res));</p>
<p>3.å’Œgetæ–¹æ³•ä¸€æ ·ï¼Œpathä¸ºè¯·æ±‚çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¤„ç†è¯·æ±‚çš„å›è°ƒå‡½æ•°ï¼Œreqå’Œresåˆ†åˆ«ä»£è¡¨è¯·æ±‚ä¿¡æ¯å’Œå“åº”ä¿¡æ¯ã€‚</p>
<p>4.ä¾‹å¦‚å¤„ç†loginçš„postè¯·æ±‚ï¼Œå¦‚ä¸‹ç¤ºä¾‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">app.post(&apos;/login&apos;,function(req,res)&#123;</div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>äº†è§£äº†postæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ä½¿ç”¨postæ¥å®ç°ç®€å•çš„ç”¨æˆ·ç™»é™†åŠŸèƒ½ã€‚</p>
<h2 id="bodyåŸºæœ¬ç”¨æ³•">bodyåŸºæœ¬ç”¨æ³•</h2><p>å®ç°ç™»é™†ä¹‹å‰æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸ªå±æ€§ â€”â€” bodyã€‚</p>
<p>bodyå±æ€§è§£æå®¢æˆ·ç«¯çš„postè¯·æ±‚å‚æ•°ï¼Œé€šè¿‡å®ƒå¯è·å–è¯·æ±‚è·¯å¾„çš„å‚æ•°å€¼ã€‚</p>
<p>æ ¼å¼ï¼šreq.body.å‚æ•°åï¼›</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±æ¥æµ‹è¯•bodyå±æ€§çš„åŠŸèƒ½ï¼Œåšä¸€äº›å‡†å¤‡å·¥ä½œã€‚</p>
<p>ä¿®æ”¹login.htmlï¼Œä¸ºç™»é™†æŒ‰é’®å¢åŠ ç™»é™†äº‹ä»¶ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&quot;button&quot; onclick=&quot;login();&quot; value=&quot;ç™» é™†&quot;&gt;</div><div class="line">function login()&#123;</div><div class="line">   var username = $(&apos;#username&apos;).val();</div><div class="line">   var data = &#123; &quot;username&quot;: username &#125;;</div><div class="line">   $.ajax(&#123;</div><div class="line">           url:&apos;/login&apos;,</div><div class="line">           type:&apos;POST&apos;,</div><div class="line">           data:data</div><div class="line">          &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¦æƒ³ä½¿ç”¨bodyå±æ€§è§£æpostè¯·æ±‚å‚æ•°å€¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®‰è£…å’Œå¼•ç”¨expressçš„ä¸¤ä¸ªä¸­é—´ä»¶body-parserå’Œmulterï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼šã€‚<br>2.1å®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install body-parser</div><div class="line">npm install multer</div></pre></td></tr></table></figure>
<p>2.2å¼•ç”¨å’Œè°ƒç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var bodyParser = require(&apos;body-parser&apos;);</div><div class="line">var multer = require(&apos;multer&apos;);</div><div class="line">   ......</div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123; extended: true &#125;));</div><div class="line">app.use(multer());</div></pre></td></tr></table></figure>
<p>ä¸­é—´ä»¶body-parserå’Œmulterç”¨äºå¤„ç†å’Œè§£æpostè¯·æ±‚çš„æ•°æ®ã€‚</p>
<h2 id="bodyåŸºæœ¬ç”¨æ³•(2)">bodyåŸºæœ¬ç”¨æ³•(2)</h2><p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•postè¯·æ±‚çš„bodyå±æ€§çš„ç®€å•ç”¨æ³•äº†ã€‚</p>
<p>1.ä¿®æ”¹å¥½ä¹‹åçš„å®Œæ•´çš„æ–‡ä»¶app.jså¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line">var bodyParser = require(&apos;body-parser&apos;);</div><div class="line">var multer = require(&apos;multer&apos;);</div><div class="line">app.set(&apos;views&apos;, __dirname);</div><div class="line">app.set( &apos;view engine&apos;, &apos;html&apos; );</div><div class="line">app.engine( &apos;.html&apos;, require( &apos;ejs&apos; ).__express );</div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123; extended: true &#125;));</div><div class="line">app.use(multer());</div><div class="line">app.get(&apos;/&apos;,function(req,res)&#123;</div><div class="line">    res.render(&apos;login&apos;);</div><div class="line">&#125;);</div><div class="line">app.post(&quot;/login&quot;, function(req, res) &#123;</div><div class="line">    console.log(&quot;ç”¨æˆ·åç§°ä¸ºï¼š&quot; + req.body.username);</div><div class="line">&#125;);</div><div class="line">app.listen(8000);</div></pre></td></tr></table></figure>
<p>é€šè¿‡æµ‹è¯•åœ°å€è®¿é—®æµè§ˆå™¨ï¼Œè¯•è¯•å½•å…¥ä»»æ„ä¸€ä¸ªç”¨æˆ·åç™»å½•ï¼ŒæŸ¥çœ‹é€šè¿‡bodyå±æ€§æ˜¯å¦å¯ä»¥æˆåŠŸè·å–ï¼Ÿ</p>
<h2 id="å‡†å¤‡ç™»é™†-1">å‡†å¤‡ç™»é™†</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹å®ç°ç™»é™†åŠŸèƒ½ï¼Œè®©æˆ‘ä»¬è¦å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œï¼Œä¸ºç›¸å…³æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ã€é“¾æ¥ã€‚</p>
<p>1.ä¿®æ”¹index.htmlï¼Œå¢åŠ ç™»é™†é“¾æ¥ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ç™» å½•](login)</div></pre></td></tr></table></figure></p>
<p>2.å¼ºåŒ–loginé¡µé¢çš„loginæ–¹æ³•ï¼Œå®ç°ä¸€ä¸ªç®€å•çš„postè¯·æ±‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">function login()&#123;</div><div class="line">   var username = $(&apos;#username&apos;).val();</div><div class="line">   var password = $(&apos;#password&apos;).val();</div><div class="line">   var data = &#123; &quot;username&quot;: username, &quot;password&quot;:password&#125;;</div><div class="line">   $.ajax(&#123;</div><div class="line">            url:&apos;login&apos;,</div><div class="line">            type:&apos;POST&apos;,</div><div class="line">            data:data,</div><div class="line">            success:function(data,status)&#123;</div><div class="line">                 if(status == &apos;success&apos;)&#123;</div><div class="line">                     location.href=&apos;home&apos;;</div><div class="line">                   &#125;</div><div class="line">            &#125;,</div><div class="line">            error:function(data,status,e)&#123;</div><div class="line">                 if(status == &quot;error&quot;)&#123;</div><div class="line">                      location.href=&apos;login&apos;;</div><div class="line">                    &#125;</div><div class="line">                  &#125;</div><div class="line">              &#125;);</div><div class="line">      &#125;</div></pre></td></tr></table></figure>
<p>ç½‘é¡µæ¨¡æ¿å‡†å¤‡å·²ç»å°±ç»ªï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹ä¿®æ”¹å¯åŠ¨æ–‡ä»¶app.jsçš„å†…å®¹ã€‚</p>
<h2 id="å‡†å¤‡ç™»é™†-2">å‡†å¤‡ç™»é™†</h2><p>ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹ä¿®æ”¹appå¯åŠ¨æ–‡ä»¶çš„å†…å®¹ã€‚</p>
<p>1.ä¿®æ”¹postæ–¹æ³•ï¼Œè¿™é‡Œå‡è®¾æ•°æ®åº“ä¸­ç”¨æˆ·åçš„åå­—ä¸ºadminã€å¯†ç ä¸ºadminã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">app.post(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">    var user=&#123;</div><div class="line">        username:&apos;admin&apos;,</div><div class="line">        password:&apos;admin&apos;</div><div class="line">    &#125;</div><div class="line">if(req.body.username==user.username&amp;&amp;req.body.password==user.password)</div><div class="line">    &#123; </div><div class="line">       res.send(200);</div><div class="line">    &#125;else&#123;</div><div class="line">       res.send( 404 );</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">2.ä¸€ä¸ªå®Œæ•´çš„å¯åŠ¨æ–‡ä»¶app.jså¦‚ä¸‹æ‰€ç¤ºï¼š</div><div class="line"></div><div class="line">var express = require(&apos;express&apos;);</div><div class="line">var app = express();</div><div class="line">var bodyParser = require(&apos;body-parser&apos;);</div><div class="line">var multer = require(&apos;multer&apos;);</div><div class="line"> </div><div class="line">app.set(&apos;views&apos;, __dirname);</div><div class="line">app.set( &apos;view engine&apos;, &apos;html&apos; );</div><div class="line">app.engine( &apos;.html&apos;, require( &apos;ejs&apos; ).__express );</div><div class="line"> </div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123; extended: true &#125;));</div><div class="line">app.use(multer());</div><div class="line"> </div><div class="line">app.get(&apos;/&apos;, function(req, res) &#123;</div><div class="line">    res.render(&apos;index&apos;);</div><div class="line">&#125;);</div><div class="line">app.get(&apos;/home&apos;,function(req,res)&#123;</div><div class="line">    res.render(&apos;home&apos;);</div><div class="line">&#125;);</div><div class="line">app.get(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">    res.render(&apos;login&apos;);</div><div class="line">&#125;);</div><div class="line">app.post(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">    var user=&#123;</div><div class="line">        username:&apos;admin&apos;,</div><div class="line">        password:&apos;admin&apos;</div><div class="line">    &#125;</div><div class="line"> if(req.body.username==user.username&amp;&amp;req.body.password==user.password)      &#123;</div><div class="line">      res.send(200);</div><div class="line">   &#125;else&#123;</div><div class="line">      res.send( 404 );</div><div class="line">   &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">app.listen(80);</div></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼Œä¸€ä¸ªç®€å•çš„Postç™»å½•å°±å®Œæˆäº†ï¼Œä½¿ç”¨æµè§ˆå™¨è¿è¡Œæœ¬åœ°ç«¯å£è¯•è¯•æ•ˆæœå§ï¼</p>
<h2 id="è®¿é—®æ§åˆ¶">è®¿é—®æ§åˆ¶</h2><p>ç®€å•ç™»é™†éƒ¨åˆ†æŒ‰ç…§æˆ‘ä»¬çš„æ±‚å·²ç»å®Œæˆäº†ï¼Œä½†ç½‘ç«™å¥½äº›å¹¶ä¸å®‰å…¨ï¼Œåå¤æµ‹è¯•æˆ‘ä»¬å‘ç°ï¼Œhome.htmlé¡µé¢æœ¬æ¥æ˜¯ç™»é™†ä»¥åæ‰è®¿é—®çš„ï¼Œç°åœ¨æˆ‘ä»¬ä¸éœ€ç™»é™†ï¼Œç›´æ¥åœ¨æµè§ˆå™¨è¾“å…¥ä¹Ÿå¯è®¿é—®ï¼Œè¿™æ ·è‚¯å®šæ˜¯ä¸èƒ½è¢«å…è®¸çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜å¾—å†æ¬¡å¯¹ç™»é™†åŠŸèƒ½è¿›è¡Œå¼ºåŒ–ã€‚</p>
<p>1.login.htmlé¡µé¢å¢åŠ EJSæ¨¡æ¿å˜é‡&lt;%- message %&gt;ä¿å­˜ç™»é™†æç¤ºä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">    &lt;%- message %&gt;</div><div class="line"># ç”¨æˆ·ç™»å½•</div><div class="line">...</div></pre></td></tr></table></figure>
<p>2.home.htmlé¡µé¢ï¼Œç™»é™†æˆåŠŸåè·³è½¬å¹¶ä¼ å…¥ç”¨æˆ·åï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># æ­å–œ_&lt;%= user.username %&gt;_ï¼Œç™»é™†æˆåŠŸï¼</div></pre></td></tr></table></figure>
<p>PSï¼šä½¿ç”¨EJSæ¨¡æ¿å˜é‡å€¼ä½¿ç”¨&lt;%= variable_name %&gt;è¾“å‡ºæ–¹å¼ï¼Œå­—ç¬¦ä¸²è¾“å‡ºæ—¶é»˜è®¤ç»è¿‡escapeè½¬ä¹‰ç¼–ç ã€‚ å½“æˆ‘ä»¬æƒ³è¦è¾“å‡ºä¸€äº›åŠ¨æ€ç”Ÿæˆçš„HTMLæ ‡ç­¾æ—¶å¯ä½¿ç”¨&lt;%- variable_nam %&gt;è¾“å‡ºæ–¹å¼ï¼Œè¿™ç§æ–¹å¼ä¸ä¼šè¢«escapeè½¬ä¹‰ç¼–ç ã€‚</p>
<p>3.home.htmlé¡µé¢æ·»åŠ é€€å‡ºé“¾æ¥ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[é€€ å‡º](logout)</div></pre></td></tr></table></figure></p>
<h2 id="è®¿é—®æ§åˆ¶-1">è®¿é—®æ§åˆ¶</h2><p>ä¿®æ”¹å¥½äº†æ¨¡æ¿é¡µï¼Œä¸‹é¢å¼€å§‹ä¿®æ”¹å¯åŠ¨æ–‡ä»¶app.jsçš„å†…å®¹ã€‚</p>
<p>1.å®‰è£…æ¨¡å—express-sessionå¹¶å¼•ç”¨ï¼Œå®‰è£…ã€å¼•ç”¨ä¸åœ¨è®²è¿°ã€‚</p>
<p>2.ä½¿ç”¨æ–°æ¨¡å—è¿›è¡Œè®¿é—®æ—¶é—´é™åˆ¶ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var session = require(&apos;express-session&apos;);</div><div class="line">...</div><div class="line">app.use(session(&#123;</div><div class="line">    secret:&apos;secret&apos;,</div><div class="line">    resave:true,</div><div class="line">    saveUninitialized:false,</div><div class="line">    cookie:&#123;</div><div class="line">        maxAge:1000*60*10  //è¿‡æœŸæ—¶é—´è®¾ç½®(å•ä½æ¯«ç§’)</div><div class="line">    &#125;</div><div class="line">&#125;));</div></pre></td></tr></table></figure>
<p>3.app.jsæ–‡ä»¶æ–°å¢ä¸­é—´ä»¶å¹¶è®¾ç½®æ¨¡æ¿å˜é‡å€¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">app.use(function(req, res, next)&#123;</div><div class="line">    res.locals.user = req.session.user;</div><div class="line">    var err = req.session.error;</div><div class="line">    res.locals.message = &apos;&apos;;</div><div class="line">    if (err) res.locals.message = &apos;&lt;div style=&quot;margin-bottom: 20px;color:red;&quot;&gt;&apos; + err + &apos;&lt;/div&gt;&apos;;</div><div class="line">    next();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>res.localså¯¹è±¡ä¿å­˜åœ¨ä¸€æ¬¡è¯·æ±‚èŒƒå›´å†…çš„å“åº”ä½“ä¸­çš„æœ¬åœ°å˜é‡å€¼ã€‚</p>
<p>PSï¼šæ³¨æ„ï¼Œä¸­é—´ä»¶çš„æ”¾ç½®é¡ºåºå¾ˆé‡è¦ï¼Œç­‰åŒäºæ‰§è¡Œé¡ºåºã€‚è€Œä¸”ï¼Œä¸­é—´ä»¶å¿…é¡»æ”¾åœ¨HTTPåŠ¨è¯æ–¹æ³•ä¹‹å‰ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œã€‚</p>
<p>4.å¢åŠ logoutè·¯å¾„å¤„ç†(ç”¨æˆ·ç™»é™†é€€å‡º)å’Œindexè·¯å¾„è¯·æ±‚å¤„ç†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/logout&apos;, function(req, res)&#123;</div><div class="line">    req.session.user = null;</div><div class="line">    req.session.error = null;</div><div class="line">    res.redirect(&apos;index&apos;);</div><div class="line">&#125;);</div><div class="line">app.get(&apos;/index&apos;, function(req, res) &#123;</div><div class="line">    res.render(&apos;index&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>5.ä¿®æ”¹homeè·¯å¾„è¯·æ±‚å¤„ç†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/home&apos;,function(req,res)&#123;</div><div class="line">    if(req.session.user)&#123;</div><div class="line">        res.render(&apos;home&apos;);</div><div class="line">    &#125;else&#123;</div><div class="line">        req.session.error = &quot;è¯·å…ˆç™»å½•&quot;</div><div class="line">        res.redirect(&apos;login&apos;);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>5.ä¿®æ”¹è·¯å¾„ä¸ºloginçš„Postè¯·æ±‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">app.post(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">    var user=&#123;</div><div class="line">        username:&apos;admin&apos;,</div><div class="line">        password:&apos;admin&apos;</div><div class="line">    &#125;</div><div class="line"> if(req.body.username==user.username&amp;&amp;req.body.password==user.password)&#123;</div><div class="line">        req.session.user = user;</div><div class="line">        res.send(200);</div><div class="line">    &#125;else&#123;</div><div class="line">        req.session.error = &quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;;</div><div class="line">        res.send( 404 );</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¥½ï¼Œå…¨éƒ¨ä¿®æ”¹å®Œæ¯•ï¼Œå†æ¬¡è®¿é—®æµ‹è¯•åœ°å€è¯•è¯•æ•ˆæœå§ï¼</p>
<h1 id="è·¯ç”±ç™»é™†">è·¯ç”±ç™»é™†</h1><h2 id="è·¯ç”±ä»‹ç»">è·¯ç”±ä»‹ç»</h2><p>è·¯ç”± â€”â€”â€”â€”ä¸ºä¸åŒçš„è®¿é—®è·¯å¾„ï¼ŒæŒ‡å®šä¸åŒçš„å¤„ç†æ–¹æ³•ã€‚ åœ¨app.jsä¸­æˆ‘ä»¬æŒ‡å®šäº†app.getã€app.postçš„ä¸åŒè·¯å¾„çš„å¤šä¸ªè·¯ç”±è§„åˆ™ï¼Œåœ¨å®é™…å¼€å‘åº”ç”¨ä¸­ï¼Œä¹Ÿä¼šç¢°åˆ°å…·æœ‰å¤šä¸ªè·¯ç”±è®°å½•çš„æƒ…å†µï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±è¦å¯¹è¿™äº›è·¯ç”±è®°å½•åšåˆ†å¼€å¤„ç†ï¼Œä»¥ä¾¿äºç®¡ç†ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯åœ¨ç™»é™†ä¾‹å­çš„åŸºç¡€ä¸Šåšå¦‚ä¸‹ä¿®æ”¹ã€‚</p>
<p>1.æ·»åŠ ä¸‰ä¸ªjsæ–‡ä»¶ï¼Œåç§°åˆ†åˆ«ä¸ºloginã€homeã€logoutã€‚</p>
<p>2.login.jsæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    app.get(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">        res.render(&apos;login&apos;);</div><div class="line">    &#125;);</div><div class="line"> </div><div class="line">    app.post(&apos;/login&apos;,function(req,res)&#123;</div><div class="line">        var user=&#123;</div><div class="line">            username:&apos;admin&apos;,</div><div class="line">            password:&apos;admin&apos;</div><div class="line">        &#125;</div><div class="line">        if(req.body.username==user.username&amp;&amp;req.body.password==user.password)&#123;</div><div class="line">            req.session.user = user;</div><div class="line">            res.send(200);</div><div class="line">        &#125;else&#123;</div><div class="line">            req.session.error = &quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</div><div class="line">            res.send( 404 );</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3.home.jsæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    app.get(&apos;/home&apos;,function(req,res)&#123;</div><div class="line">        if(req.session.user)&#123;</div><div class="line">            res.render(&apos;home&apos;);</div><div class="line">        &#125;else&#123;</div><div class="line">            req.session.error = &quot;è¯·å…ˆç™»å½•&quot;</div><div class="line">            res.redirect(&apos;login&apos;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨è·¯ç”±2">ä½¿ç”¨è·¯ç”±2</h2><p>4.logout.jsæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">module.exports = function ( app ) &#123;</div><div class="line">    app.get(&apos;/logout&apos;, function(req, res)&#123;</div><div class="line">        req.session.user = null;</div><div class="line">        req.session.error = null;</div><div class="line">        res.redirect(&apos;index&apos;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>5.app.jsæ–‡ä»¶ä¸­è¯·æ±‚è·¯å¾„ä¸ºlogoutã€homeã€loginçš„ä»£ç å°±å¯ä»¥åˆ é™¤äº†</p>
<p>6.æ–°å¢çš„ä¸‰ä¸ªæ–‡ä»¶æˆ‘ä»¬æ”¹å¦‚ä½•ä½¿ç”¨å‘¢ï¼Œå¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">require(&apos;./login&apos;)(app);</div><div class="line">require(&apos;./home&apos;)(app);</div><div class="line">require(&apos;./logout&apos;)(app);</div></pre></td></tr></table></figure>
<p>å¯¹ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€å¼•ç”¨è·¯ç”±çš„ç›®å½•å³å¯ã€‚</p>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬çš„ç”¨æˆ·ç™»é™†åŠŸèƒ½å°±å®‰å…¨äº†ï¼Œç°å­¦ç°ç”¨èµ¶å¿«è¯•è¯•æ•ˆæœå§ï¼</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</h1><h2 id="Expressä»‹ç»">Expressä»‹ç»</h2><p>ã€€ã€€npmæä¾›äº†å¤§é‡çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå…¶ä¸­ä¸ä¹è®¸å¤šWebæ¡†æ¶ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ¬ç« èŠ‚è¦è®²è¿°çš„ä¸€ä¸ªè½»é‡çº§çš„Webæ¡†æ¶ â€”â€”â€” Expressã€‚</p>
<p>ã€€ã€€Expressæ˜¯ä¸€ä¸ªç®€æ´ã€çµæ´»çš„node.js Webåº”ç”¨å¼€å‘æ¡†æ¶, å®ƒæä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šæ¨¡æ¿è§£æã€é™æ€æ–‡ä»¶æœåŠ¡ã€ä¸­é—´ä»¶ã€è·¯ç”±æ§åˆ¶ç­‰ç­‰,å¹¶ä¸”è¿˜å¯ä»¥ä½¿ç”¨æ’ä»¶æˆ–æ•´åˆå…¶ä»–æ¨¡å—æ¥å¸®åŠ©ä½ åˆ›å»ºå„ç§ Webå’Œç§»åŠ¨è®¾å¤‡åº”ç”¨,æ˜¯ç›®å‰æœ€æµè¡Œçš„åŸºäºNode.jsçš„Webå¼€å‘æ¡†æ¶ï¼Œå¹¶ä¸”æ”¯æŒEjsã€jadeç­‰å¤šç§æ¨¡æ¿ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ªå…·æœ‰å®Œæ•´åŠŸèƒ½çš„ç½‘ç«™ã€‚</p>]]>
    
    </summary>
    
      <category term="Express" scheme="http://mzeht.com/tags/Express/"/>
    
      <category term="Webå‰ç«¯" scheme="http://mzeht.com/categories/Web%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Nodejs" scheme="http://mzeht.com/categories/Web%E5%89%8D%E7%AB%AF/Nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Nodejså…¥é—¨]]></title>
    <link href="http://mzeht.com/2016/03/15/Nodejs%E5%85%A5%E9%97%A8/"/>
    <id>http://mzeht.com/2016/03/15/Nodejså…¥é—¨/</id>
    <published>2016-03-15T11:38:32.000Z</published>
    <updated>2016-11-27T10:24:33.000Z</updated>
    <content type="html"><![CDATA[<p>æ€»ç»“<a href="http://www.hubwiz.com/course/5359f6f6ec7452081a7873d8/" target="_blank" rel="external">http://www.hubwiz.com/course/5359f6f6ec7452081a7873d8/</a></p>
<h1 id="å¿«é€Ÿå…¥é—¨">å¿«é€Ÿå…¥é—¨</h1><h2 id="hello_world">hello world</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.log(&apos;hello world&apos;);</div></pre></td></tr></table></figure>
<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; hello world</div></pre></td></tr></table></figure>
<h2 id="å›è°ƒå‡½æ•°">å›è°ƒå‡½æ•°</h2><p>ç”±äºnodeæ˜¯ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„å¹³å°ï¼Œæ‰€ä»¥åœ¨ä»£ç ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨å›è°ƒå‡½æ•°ã€‚ä¸‹é¢æ˜¯å›è°ƒå‡½æ•°åº”ç”¨çš„ç»å…¸ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">setTimeout(function()&#123;</div><div class="line">    console.log(&apos;callback is called&apos;);</div><div class="line">&#125;,2000);</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä¼ ç»™setTimeoutå‡½æ•°ä¼ å…¥äº†ä¸€ä¸ªåŒ¿åå‡½æ•°å’Œä¸€ä¸ªè°ƒç”¨æ—¶é—´2000(æ¯«ç§’)ï¼Œè¿è¡Œç¨‹åºåç­‰å¾…2ç§’ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºäº†â€callback is calledâ€ã€‚</p>
<h2 id="æ ‡å‡†å›è°ƒå‡½æ•°">æ ‡å‡†å›è°ƒå‡½æ•°</h2><p>node.jsä¸­å›è°ƒå‡½æ•°æ ¼å¼æ˜¯çº¦å®šä¿—æˆçš„ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºerrï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºdataï¼Œé¡¾åæ€ä¹‰ï¼Œerræ˜¯é”™è¯¯ä¿¡æ¯ï¼Œdataåˆ™æ˜¯è¿”å›çš„æ•°æ®ï¼Œç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function(err,data)&#123;</div><div class="line"> </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†å…»æˆè‰¯å¥½çš„ç¼–ç ä¹ æƒ¯ï¼Œåœ¨ä»¥åçš„è¯¾ç¨‹ç¤ºä¾‹æˆ–ç»ƒä¹ ä¸­ï¼Œå›è°ƒå‡½æ•°æ ¼å¼éƒ½å°†é‡‡ç”¨è¿™æ ·çš„æ ¼å¼ã€‚</p>
<h2 id="è·å–æ¨¡å—">è·å–æ¨¡å—</h2><p>ä¸ºäº†æ”¯æŒå¿«é€Ÿå¼€å‘ï¼Œnodeå¹³å°ä¸Šæä¾›äº†å¤§é‡çš„æ¨¡å—ï¼Œå°è£…äº†å„è‡ªä¸åŒçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¦‚ä½•è°ƒè·å–æƒ³è¦çš„æ¨¡å—å‘¢ï¼Œä¸‹æ¥æˆ‘ä»¬å°±æ¥ä»‹ç»ã€‚ åœ¨nodeä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨requireå‡½æ•°ï¼Œå…·ä½“è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require(&quot;æ¨¡å—&quot;);</div></pre></td></tr></table></figure>
<p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å¾ˆæ–¹ä¾¿ï¼Œé€šè¿‡requireå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥è·å–ç›¸åº”æ¨¡å—è¿›è€Œä½¿ç”¨å®ƒçš„ä»»æ„åŠŸèƒ½äº†ã€‚</p>
<h2 id="ä½¿ç”¨æ¨¡å—">ä½¿ç”¨æ¨¡å—</h2><p>osæ¨¡å—å¯æä¾›æ“ä½œç³»ç»Ÿçš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œå®ƒçš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var os = require(&quot;os&quot;);</div><div class="line"> </div><div class="line">var result = os.platform(); //æŸ¥çœ‹æ“ä½œç³»ç»Ÿå¹³å°</div><div class="line">           //os.release(); æŸ¥çœ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬</div><div class="line">           //os.type();  æŸ¥çœ‹æ“ä½œç³»ç»Ÿåç§°</div><div class="line">           //os.arch();  æŸ¥çœ‹æ“ä½œç³»ç»ŸCPUæ¶æ„</div><div class="line"> </div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<h1 id="è¿›ç¨‹ç®¡ç†">è¿›ç¨‹ç®¡ç†</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>processæ˜¯ä¸€ä¸ªå…¨å±€å†…ç½®å¯¹è±¡ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»ä½•ä½ç½®è®¿é—®æ­¤å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä»£è¡¨æˆ‘ä»¬çš„node.jsä»£ç å®¿ä¸»çš„æ“ä½œç³»ç»Ÿè¿›ç¨‹å¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨processå¯¹è±¡å¯ä»¥æˆªè·è¿›ç¨‹çš„å¼‚å¸¸ã€é€€å‡ºç­‰äº‹ä»¶ï¼Œä¹Ÿå¯ä»¥è·å–è¿›ç¨‹çš„å½“å‰ç›®å½•ã€ç¯å¢ƒå˜é‡ã€å†…å­˜å ç”¨ç­‰ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æ‰§è¡Œè¿›ç¨‹é€€å‡ºã€å·¥ä½œç›®å½•åˆ‡æ¢ç­‰æ“ä½œã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹processå¯¹è±¡çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•ã€‚</p>
<h2 id="cwdå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">cwdå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>å½“æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹åº”ç”¨ç¨‹åºå½“å‰ç›®å½•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨cwdå‡½æ•°ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">process.cwd();</div></pre></td></tr></table></figure>
<h2 id="chdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">chdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>å¦‚æœéœ€è¦æ”¹å˜åº”ç”¨ç¨‹åºç›®å½•ï¼Œå°±è¦ä½¿ç”¨chdirå‡½æ•°äº†ï¼Œå®ƒçš„ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<p>process.chdir(â€œç›®å½•â€);</p>
<h2 id="stdoutçš„åŸºæœ¬ç”¨æ³•">stdoutçš„åŸºæœ¬ç”¨æ³•</h2><p>stdoutæ˜¯æ ‡å‡†è¾“å‡ºæµï¼Œå®ƒæ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿè¯·ä¸‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">console.log = function(d)&#123;</div><div class="line">    process.stdout.write(d+&apos;\n&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ²¡é”™ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯å°†å†…å®¹æ‰“å°åˆ°è¾“å‡ºè®¾å¤‡ä¸Šï¼Œconsole.logå°±æ˜¯å°è£…äº†å®ƒã€‚</p>
<h2 id="stderrçš„åŸºæœ¬ç”¨æ³•">stderrçš„åŸºæœ¬ç”¨æ³•</h2><p>stderræ˜¯æ ‡å‡†é”™è¯¯æµï¼Œå’Œstdoutçš„ä½œç”¨å·®ä¸å¤šï¼Œä¸åŒçš„æ˜¯å®ƒæ˜¯ç”¨æ¥æ‰“å°é”™è¯¯ä¿¡æ¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥æ•è·é”™è¯¯ä¿¡æ¯ï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">process.stderr.write(è¾“å…¥å†…å®¹);</div></pre></td></tr></table></figure>
<h2 id="stdinçš„åŸºæœ¬ç”¨æ³•">stdinçš„åŸºæœ¬ç”¨æ³•</h2><p>stdinæ˜¯è¿›ç¨‹çš„è¾“å…¥æµ,æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³¨å†Œäº‹ä»¶çš„æ–¹å¼æ¥è·å–è¾“å…¥çš„å†…å®¹ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">process.stdin.on(&apos;readable&apos;, function() &#123;</div><div class="line">  var chunk = process.stdin.read();</div><div class="line">  if (chunk !== null) &#123;</div><div class="line">    process.stdout.write(&apos;data: &apos; + chunk);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä¸­çš„chunkå°±æ˜¯è¾“å…¥æµä¸­çš„å†…å®¹ã€‚</p>
<h2 id="exitå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">exitå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>å¦‚æœä½ éœ€è¦åœ¨ç¨‹åºå†…æ€æ­»è¿›ç¨‹ï¼Œé€€å‡ºç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨exitå‡½æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">process.exit(code);</div></pre></td></tr></table></figure>
<p>å‚æ•°codeä¸ºé€€å‡ºåè¿”å›çš„ä»£ç ï¼Œå¦‚æœçœç•¥åˆ™é»˜è®¤è¿”å›0ï¼›</p>
<h2 id="æ³¨å†Œäº‹ä»¶">æ³¨å†Œäº‹ä»¶</h2><p>å‰é¢è®²åˆ°å¦‚ä½•åœ¨è¾“å…¥æµä¸­æ‰“å°ä¿¡æ¯ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–stdoutå†…å®¹çš„æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¯·çœ‹å¦‚ä¸‹çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">process.stdout.on(&apos;data&apos;,function(data)&#123;</div><div class="line">   console.log(data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸ºstdoutæ³¨å†Œdataäº‹ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°å®ƒè¾“å‡ºçš„å†…å®¹äº†ã€‚</p>
<h2 id="è®¾ç½®ç¼–ç ">è®¾ç½®ç¼–ç </h2><p>åœ¨æˆ‘ä»¬çš„è¾“å…¥è¾“å‡ºçš„å†…å®¹ä¸­æœ‰ä¸­æ–‡çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šä¹±ç çš„é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºç¼–ç ä¸åŒé€ æˆçš„ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹éœ€è¦ä¸ºæµè®¾ç½®ç¼–ç ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">process.stdin.setEncoding(ç¼–ç );</div><div class="line"> </div><div class="line">process.stdout.setEncoding(ç¼–ç );</div><div class="line"> </div><div class="line">process.stderr.setEncoding(ç¼–ç );</div></pre></td></tr></table></figure>
<h2 id="è¯¾ç¨‹å°ç»“">è¯¾ç¨‹å°ç»“</h2><p>processçš„å¸¸ç”¨æ–¹æ³•å°±è®²åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå¯ä»¥å‚è€ƒä»¥ä¸‹åœ°å€ï¼š</p>
<p><a href="http://nodejs.cn/api/process" target="_blank" rel="external">http://nodejs.cn/api/process</a><br><a href="http://nodeapi.ucdok.com/#/api/process.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/process.html</a></p>
<h1 id="æ–‡ä»¶I/O_fsæ¨¡å—çš„åŸºæœ¬ç”¨æ³•">æ–‡ä»¶I/O fsæ¨¡å—çš„åŸºæœ¬ç”¨æ³•</h1><p>å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸ä¼šæœ‰æ–‡ä»¶I/Oçš„éœ€æ±‚ï¼Œnode.jsä¸­æä¾›ä¸€ä¸ªåä¸ºfsçš„æ¨¡å—æ¥æ”¯æŒI/Oæ“ä½œï¼Œfsæ¨¡å—çš„æ–‡ä»¶I/Oæ˜¯å¯¹æ ‡å‡†POSIXå‡½æ•°çš„ç®€å•å°è£…ã€‚</p>
<h2 id="writeFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">writeFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>æ–‡ä»¶I/Oï¼Œå†™å…¥æ˜¯å¿…ä¿®è¯¾ä¹‹ä¸€ã€‚fsæ¨¡å—æä¾›writeFileå‡½æ•°ï¼Œå¯ä»¥å¼‚æ­¥çš„å°†æ•°æ®å†™å…¥ä¸€ä¸ªæ–‡ä»¶, å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨åˆ™ä¼šè¢«æ›¿æ¢ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.writeFile(filename, data, callback)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var fs= require(&quot;fs&quot;);</div><div class="line"> </div><div class="line">fs.writeFile(&apos;test.txt&apos;, &apos;Hello Node&apos;, function (err) &#123;</div><div class="line">   if (err) throw err;</div><div class="line">   console.log(&apos;Saved successfully&apos;); //æ–‡ä»¶è¢«ä¿å­˜</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ•°æ®å‚æ•°å¯ä»¥æ˜¯stringæˆ–è€…æ˜¯Buffer,ç¼–ç æ ¼å¼å‚æ•°å¯é€‰ï¼Œé»˜è®¤ä¸ºâ€utf8â€ï¼Œå›è°ƒå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°errã€‚</p>
<h2 id="appendFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">appendFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>writeFileå‡½æ•°è™½ç„¶å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³æ·»åŠ ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå®ƒå°±ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚äº†ï¼Œå¾ˆå¹¸è¿ï¼Œfsæ¨¡å—ä¸­è¿˜æœ‰appendFileå‡½æ•°ï¼Œå®ƒå¯ä»¥å°†æ–°çš„å†…å®¹è¿½åŠ åˆ°å·²æœ‰çš„æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.appendFile(æ–‡ä»¶å,æ•°æ®,ç¼–ç ,å›è°ƒå‡½æ•°(err));</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var fs= require(&quot;fs&quot;);</div><div class="line"> </div><div class="line">fs.appendFile(&apos;test.txt&apos;, &apos;data to append&apos;, function (err) &#123;</div><div class="line">   if (err) throw err;</div><div class="line"> </div><div class="line">    //æ•°æ®è¢«æ·»åŠ åˆ°æ–‡ä»¶çš„å°¾éƒ¨</div><div class="line">    console.log(&apos;The &quot;data to append&quot; was appended to file!&apos;); </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç¼–ç æ ¼å¼é»˜è®¤ä¸ºâ€utf8â€</p>
<h2 id="existså‡½æ•°çš„åŸºæœ¬ç”¨æ³•">existså‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>å¦‚ä½•æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨å‘¢ï¼Ÿæˆ‘æƒ³existså‡½æ•°å¯ä»¥å¸®åŠ©ä½ ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.exists(æ–‡ä»¶ï¼Œå›è°ƒå‡½æ•°(exists));</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">existsçš„å›è°ƒå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸ºå¸ƒå°”å‹ï¼Œé€šè¿‡å®ƒæ¥è¡¨ç¤ºæ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</div><div class="line"></div><div class="line">var fs= require(&quot;fs&quot;);</div><div class="line"> </div><div class="line">fs.exists(&apos;/etc/passwd&apos;, function (exists) &#123;</div><div class="line">  console.log(exists ? &quot;å­˜åœ¨&quot; : &quot;ä¸å­˜åœ¨!&quot;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="renameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">renameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>ä¿®æ”¹æ–‡ä»¶åç§°æ˜¯æˆ‘ä»¬ç»å¸¸ä¼šé‡è§çš„äº‹æƒ…ï¼Œrenameå‡½æ•°æä¾›ä¿®æ”¹åç§°æœåŠ¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var fs= require(&quot;fs&quot;);</div><div class="line"> </div><div class="line">fs.rename(æ—§æ–‡ä»¶ï¼Œæ–°æ–‡ä»¶ï¼Œå›è°ƒå‡½æ•°(err)&#123;</div><div class="line">   if (err) throw err;</div><div class="line">   console.log(&apos;Successful modification,&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="renameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•-1">renameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>ç§»åŠ¨æ–‡ä»¶ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸ä¼šé‡è§çš„ï¼Œå¯æ˜¯fsæ²¡æœ‰ä¸“é—¨ç§»åŠ¨æ–‡ä»¶çš„å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡renameå‡½æ•°æ¥è¾¾åˆ°ç§»åŠ¨æ–‡ä»¶çš„ç›®çš„ï¼Œç¤ºä¾‹å¦‚ä¸‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var fs = require(&apos;fs&apos;);</div><div class="line"> </div><div class="line">fs.rename(oldPath,newPath,function (err) &#123;</div><div class="line">   if (err) throw err;</div><div class="line">   console.log(&apos;renamed complete&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="readFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">readFileå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>è¯»å–æ–‡ä»¶æ˜¯æœ€å¸¸ç”¨åˆ°çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œä½¿ç”¨fsæ¨¡å—è¯»å–æ–‡ä»¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.readFile(æ–‡ä»¶,ç¼–ç ,å›è°ƒå‡½æ•°);</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var fs = require(&apos;fs&apos;);</div><div class="line"> </div><div class="line">fs.readFile(æ–‡ä»¶å, function (err, data) &#123;</div><div class="line">  if (err) throw err;</div><div class="line">  console.log(data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å›è°ƒå‡½æ•°é‡Œé¢çš„data,å°±æ˜¯è¯»å–çš„æ–‡ä»¶å†…å®¹ã€‚</p>
<h2 id="unlinkå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">unlinkå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>é¢å¯¹ä¸€å †åƒåœ¾çš„æ–‡ä»¶æ€»æ˜¯æœ‰æƒ³åˆ é™¤çš„å†²åŠ¨ï¼Œæˆ‘æœ‰å¼ºè¿«ç—‡ï¼Ÿä½ æ‰æœ‰å‘¢ã€‚</p>
<p>å¥½åœ¨æœ‰unlinkå‡½æ•°ï¼Œç»ˆäºå¾—æ•‘äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.unlink(æ–‡ä»¶,å›è°ƒå‡½æ•°(err));</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var fs = require(&apos;fs&apos;);</div><div class="line"> </div><div class="line">fs.unlink(æ–‡ä»¶, function(err) &#123;</div><div class="line">  if (err) throw err;</div><div class="line">  console.log(&apos;successfully deleted&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="mkdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">mkdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>é™¤äº†é’ˆå¯¹æ–‡ä»¶çš„æ“ä½œï¼Œç›®å½•çš„åˆ›å»ºã€åˆ é™¤ä¹Ÿç»å¸¸é‡åˆ°çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹node.jsä¸­å¦‚ä½•åˆ›å»ºç›®å½•ï¼š</p>
<blockquote>
<p>fs.mkdir(è·¯å¾„ï¼Œæƒé™ï¼Œå›è°ƒå‡½æ•°(err));<br>å‚æ•°</p>
</blockquote>
<p>è·¯å¾„ï¼šæ–°åˆ›å»ºçš„ç›®å½•ã€‚<br>æƒé™ï¼šå¯é€‰å‚æ•°ï¼Œåªåœ¨linuxä¸‹æœ‰æ•ˆï¼Œè¡¨ç¤ºç›®å½•çš„æƒé™ï¼Œé»˜è®¤ä¸º0777ï¼Œè¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶æ‰€æœ‰è€…æ‰€åœ¨çš„ç»„çš„ç”¨æˆ·ã€æ‰€æœ‰ç”¨æˆ·ï¼Œéƒ½æœ‰æƒé™è¿›è¡Œè¯»ã€å†™ã€æ‰§è¡Œçš„æ“ä½œã€‚<br>å›è°ƒå‡½æ•°ï¼šå½“å‘ç”Ÿé”™è¯¯æ—¶ï¼Œé”™è¯¯ä¿¡æ¯ä¼šä¼ é€’ç»™å›è°ƒå‡½æ•°çš„errå‚æ•°ã€‚</p>
<h2 id="rmdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">rmdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>åˆ é™¤ç›®å½•ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„åŠŸèƒ½ï¼Œrmdirå‡½æ•°å¯ä»¥åˆ é™¤æŒ‡å®šçš„ç›®å½•ï¼š</p>
<blockquote>
<p>ä¾‹ï¼šfs.rmdir(è·¯å¾„ï¼Œå›è°ƒå‡½æ•°(err));</p>
</blockquote>
<p>var fs = require(â€˜fsâ€™);</p>
<p>fs.rmdir(path, function(err) {<br>  if (err) throw err;<br>  console.log(â€˜okâ€™);<br>});</p>
<h2 id="readdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">readdirå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>å¦‚æœè¦è¯»å–ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿreaddirå‡½æ•°å¯ä»¥è¯»å–åˆ°æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var fs = require(&apos;fs&apos;);</div><div class="line"> </div><div class="line">fs.readdir(ç›®å½•,å›è°ƒå‡½æ•°(err,files));</div></pre></td></tr></table></figure>
<p>å›è°ƒå‡½æ•° (callback) æ¥å—ä¸¤ä¸ªå‚æ•° (err, files) å…¶ä¸­ files æ˜¯ä¸€ä¸ªå­˜å‚¨ç›®å½•ä¸­æ‰€åŒ…å«çš„æ–‡ä»¶åç§°çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­ä¸åŒ…æ‹¬ â€˜.â€™ å’Œ â€˜..â€™ã€‚</p>
<h2 id="è¯¾ç¨‹å°ç»“-1">è¯¾ç¨‹å°ç»“</h2><p>æ–‡ä»¶I/Oæ˜¯æœ€åŸºæœ¬çš„æ“ä½œï¼Œåº”è¯¥ç†Ÿæ‚‰æŒæ¡ã€‚</p>
<p>fsæ¨¡å—ä¸ä½†æä¾›å¼‚æ­¥çš„æ–‡ä»¶æ“ä½œï¼Œè¿˜æä¾›ç›¸åº”çš„åŒæ­¥æ“ä½œæ–¹æ³•ï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œnodejsé‡‡ç”¨å¼‚æ­¥I/Oæ­£æ˜¯ä¸ºäº†é¿å…I/Oæ—¶çš„ç­‰å¾…æ—¶é—´ï¼Œæé«˜CPUçš„åˆ©ç”¨ç‡ï¼Œæ‰€ä»¥åœ¨é€‰æ‹©ä½¿ç”¨å¼‚æ­¥æˆ–åŒæ­¥æ–¹æ³•çš„æ—¶å€™éœ€è¦æƒè¡¡å–èˆã€‚</p>
<p>æœ¬èŠ‚è¯¾ç¨‹è®²è§£äº†fsæ¨¡å—å¸¸ç”¨çš„ä¸€äº›åŠŸèƒ½ï¼Œå½“ç„¶å®ƒè¿˜æœ‰æ›´å¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹èµ„æ–™ï¼š</p>
<p><a href="http://nodejs.cn/api/fs" target="_blank" rel="external">http://nodejs.cn/api/fs</a></p>
<p><a href="http://nodeapi.ucdok.com/#/api/fs.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/fs.html</a></p>
<h1 id="urlå¤„ç†_urlæ¨¡å—çš„åŸºæœ¬ç”¨æ³•">urlå¤„ç† urlæ¨¡å—çš„åŸºæœ¬ç”¨æ³•</h1><p>node.jsä¸ºäº’è”ç½‘è€Œç”Ÿï¼Œå’Œurlæ‰“äº¤é“æ˜¯æ— æ³•é¿å…çš„äº†ï¼Œurlæ¨¡å—æä¾›ä¸€äº›åŸºç¡€çš„urlå¤„ç†ã€‚</p>
<h2 id="parseå‡½æ•°çš„åŸºç¡€ç”¨æ³•">parseå‡½æ•°çš„åŸºç¡€ç”¨æ³•</h2><p>parseå‡½æ•°çš„ä½œç”¨æ˜¯è§£æurlï¼Œè¿”å›ä¸€ä¸ªjsonæ ¼å¼çš„æ•°ç»„ï¼Œè¯·çœ‹å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var url = require(&apos;url&apos;);</div><div class="line">url.parse(&apos;http://www.baidu.com&apos;);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123; protocol: &apos;http:&apos;,</div><div class="line">  slashes: null,</div><div class="line">  auth: null,</div><div class="line">  host: null,</div><div class="line">  port: null,</div><div class="line">  hostname: null,</div><div class="line">  hash: null,</div><div class="line">  search: null,</div><div class="line">  query: null,</div><div class="line">  pathname: &apos;www.baidu.com&apos;,</div><div class="line">  path: &apos;www.baidu.com&apos;,</div><div class="line">  href: &apos;http://www.baidu.com&apos; &#125;</div></pre></td></tr></table></figure>
<h2 id="parseå‡½æ•°_â€”â€”_æ¡ä»¶è§£æ">parseå‡½æ•° â€”â€” æ¡ä»¶è§£æ</h2><p>parseå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¸ƒå°”ç±»å‹ï¼Œå½“å‚æ•°ä¸ºtrueæ—¶ï¼Œä¼šå°†æŸ¥è¯¢æ¡ä»¶ä¹Ÿè§£ææˆjsonæ ¼å¼çš„å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var url = require(&apos;url&apos;);</div><div class="line">url.parse(&apos;http://www.baidu.com?page=1&apos;,true);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123; protocol: &apos;http:&apos;,</div><div class="line">  slashes: true,</div><div class="line">  auth: null,</div><div class="line">  host: &apos;www.baidu.com&apos;,</div><div class="line">  port: null,</div><div class="line">  hostname: &apos;www.baidu.com&apos;,</div><div class="line">  hash: null,</div><div class="line">  search: &apos;?page=1&apos;,</div><div class="line">  query: &#123; page: &apos;1&apos; &#125;,</div><div class="line">  pathname: &apos;/&apos;,</div><div class="line">  path: &apos;/?page=1&apos;,</div><div class="line">  href: &apos;http://www.baidu.com/?page=1&apos; &#125;</div></pre></td></tr></table></figure>
<p>è¯•ä¸€è¯•ï¼Œå½“å‚æ•°åˆ†åˆ«ä¸ºtrueå’Œfalseæ—¶ï¼Œè¿”å›æ•°æ®ä¸­çš„queryå­—æ®µçš„å†…å®¹æœ‰ä»€ä¹ˆä¸åŒã€‚</p>
<h2 id="parseå‡½æ•°_â€”â€”_è§£æä¸»æœº">parseå‡½æ•° â€”â€” è§£æä¸»æœº</h2><p>parseå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¹Ÿæ˜¯å¸ƒå°”ç±»å‹çš„ï¼Œå½“å‚æ•°ä¸ºtrueï¼Œè§£ææ—¶ä¼šå°†urlçš„â€//â€œå’Œç¬¬ä¸€ä¸ªâ€/â€œä¹‹é—´çš„éƒ¨åˆ†è§£æä¸ºä¸»æœºåï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var url = require(&apos;url&apos;);</div><div class="line">url.parse(&apos;http://www.baidu.com/news&apos;,false,true);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123; protocol: &apos;http:&apos;,</div><div class="line">  slashes: true,</div><div class="line">  auth: null,</div><div class="line">  host: &apos;www.baidu.com&apos;,</div><div class="line">  port: null,</div><div class="line">  hostname: &apos;www.baidu.com&apos;,</div><div class="line">  hash: null,</div><div class="line">  search: null,</div><div class="line">  query: null,</div><div class="line">  pathname: &apos;/news&apos;,</div><div class="line">  path: &apos;/news&apos;,</div><div class="line">  href: &apos;http://www.baidu.com/news&apos; &#125;</div></pre></td></tr></table></figure>
<h2 id="formatå‡½æ•°çš„åŸºç¡€ç”¨æ³•">formatå‡½æ•°çš„åŸºç¡€ç”¨æ³•</h2><p>formatå‡½æ•°çš„ä½œç”¨ä¸parseç›¸åï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªJSONå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªç»„è£…å¥½çš„urlåœ°å€ï¼Œè¯·çœ‹å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var url = require(&apos;url&apos;);</div><div class="line">url.format(&#123;</div><div class="line">protocol: &apos;http:&apos;,</div><div class="line">hostname:&apos;www.baidu.com&apos;,</div><div class="line">port:&apos;80&apos;,</div><div class="line">pathname :&apos;/news&apos;,</div><div class="line">query:&#123;page:1&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.baidu.com/news?page=1</div></pre></td></tr></table></figure>
<p>å‚æ•°JSONå¯¹è±¡çš„å­—æ®µè·Ÿparseå‡½æ•°è§£æåè¿”å›çš„JSONå­—æ®µä¸€ä¸€å¯¹åº”ã€‚</p>
<p>è¯•ä¸€è¯•ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œçœ‹çœ‹è¿”å›urlæ˜¯ä»€ä¹ˆã€‚</p>
<h2 id="resolveå‡½æ•°çš„åŸºç¡€ç”¨æ³•">resolveå‡½æ•°çš„åŸºç¡€ç”¨æ³•</h2><p>resolveå‡½æ•°çš„å‚æ•°æ˜¯ä¸¤ä¸ªè·¯å¾„ï¼Œç¬¬ä¸€ä¸ªè·¯å¾„æ˜¯å¼€å§‹çš„è·¯å¾„æˆ–è€…è¯´å½“å‰è·¯å¾„ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯æƒ³è¦å»å¾€çš„è·¯å¾„ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªç»„è£…å¥½çš„urlï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var url = require(&apos;url&apos;);</div><div class="line">url.resolve(&apos;http://example.com/&apos;, &apos;/one&apos;)  // &apos;http://example.com/one&apos;</div><div class="line">url.resolve(&apos;http://example.com/one&apos;, &apos;/two&apos;) // &apos;http://example.com/two&apos;</div></pre></td></tr></table></figure>
<p>åŠ¨åŠ¨æ‰‹ï¼Œè¯•ä¸€è¯•resolveå‡½æ•°ã€‚</p>
<h2 id="è¯¾ç¨‹å°ç»“-2">è¯¾ç¨‹å°ç»“</h2><p>æœ¬èŠ‚è¯¾ç¨‹è®²è§£äº†urlæ¨¡å—å¸¸ç”¨çš„ä¸€äº›åŠŸèƒ½ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹èµ„æ–™ï¼š</p>
<p><a href="http://nodejs.cn/api/url" target="_blank" rel="external">http://nodejs.cn/api/url</a></p>
<h1 id="pathä¼˜åŒ–_pathæ¨¡å—çš„åŸºæœ¬ç”¨æ³•">pathä¼˜åŒ– pathæ¨¡å—çš„åŸºæœ¬ç”¨æ³•</h1><p>æœ¬æ¨¡å—åŒ…å«ä¸€å¥—ç”¨äºå¤„ç†å’Œè½¬æ¢æ–‡ä»¶è·¯å¾„çš„å·¥å…·é›†,ç”¨äºå¤„ç†ç›®å½•çš„å¯¹è±¡ï¼Œæé«˜ç”¨æˆ·å¼€å‘æ•ˆç‡ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥å¿«é€Ÿçš„è®¤è¯†pathå¯¹è±¡çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å§ï¼</p>
<h2 id="normalizeå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">normalizeå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>normalizeå‡½æ•°å°†ä¸ç¬¦åˆè§„èŒƒçš„è·¯å¾„ç»è¿‡æ ¼å¼åŒ–è½¬æ¢ä¸ºæ ‡å‡†è·¯å¾„,è§£æè·¯å¾„ä¸­çš„.ä¸..å¤–ï¼Œè¿˜èƒ½å»æ‰å¤šä½™çš„æ–œæ ã€‚</p>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);  </div><div class="line">var data = path.normalize(&apos;/path///normalize/hi/..&apos;);</div><div class="line">console.log(data);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;/path/normalize/&apos;</div></pre></td></tr></table></figure>
<p>çœ‹äº†ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆSo easyï¼Œèµ¶å¿«å¯»ä¸ªè·¯å¾„è¯•è¯•æ•ˆæœå§(æŒ‰æ­¥æ“ä½œå“Ÿ)ï¼</p>
<h2 id="joinå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">joinå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>joinå‡½æ•°å°†ä¼ å…¥çš„å¤šä¸ªè·¯å¾„æ‹¼æ¥ä¸ºæ ‡å‡†è·¯å¾„å¹¶å°†å…¶æ ¼å¼åŒ–ï¼Œè¿”å›è§„èŒƒåçš„è·¯å¾„ï¼Œé¿å…æ‰‹å·¥æ‹¼æ¥è·¯å¾„å­—ç¬¦ä¸²çš„ç¹ç. å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);</div><div class="line">var data = path.join(&apos;///you&apos;, &apos;/are&apos;, &apos;//beautiful&apos;);</div><div class="line">console.log(data);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;/you/are/beautiful&apos;</div></pre></td></tr></table></figure>
<h2 id="dirnameå‡½æ•°ç”¨æ¥è¿”å›è·¯å¾„ä¸­çš„ç›®å½•å-_å¦‚ä¸‹ç¤ºä¾‹ï¼š">dirnameå‡½æ•°ç”¨æ¥è¿”å›è·¯å¾„ä¸­çš„ç›®å½•å. å¦‚ä¸‹ç¤ºä¾‹ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);</div><div class="line">var data = path.dirname(&apos;/foo/strong/cool/nice&apos;); </div><div class="line">console.log(data);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;/foo/strong/cool&apos;</div></pre></td></tr></table></figure>
<h2 id="basenameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">basenameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>basenameå‡½æ•°å¯è¿”å›è·¯å¾„ä¸­çš„æœ€åä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å…¶è¿›è¡Œæ¡ä»¶æ’é™¤. å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<p>ä¾‹1ï¼špath.basename(â€˜è·¯å¾„å­—ç¬¦ä¸²â€™);</p>
<p>ä¾‹2ï¼špath.basename(â€˜è·¯å¾„å­—ç¬¦ä¸²â€™, â€˜[ext]â€™)&lt;æ’é™¤[ext]åç¼€å­—ç¬¦ä¸²&gt;;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);    </div><div class="line">var data1 = path.basename(&apos;/foo/strong/basename/index.html&apos;);</div><div class="line">var data2 = path.basename(&apos;/foo/strong/basename/index.html&apos;,&apos;.html&apos;);</div><div class="line">console.log(data1 + &apos; &quot;and&quot; &apos; + data2);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;index.html &quot;and&quot; index&apos;</div></pre></td></tr></table></figure>
<h2 id="extnameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">extnameå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>extnameå‡½æ•°è¿”å›è·¯å¾„ä¸­æ–‡ä»¶çš„æ‰©å±•å(ä»¥æœ€åä¸€ä¸ªâ€™.â€™å¼€å§‹,è¿”å›â€™.â€™ä»¥åŠâ€™.â€™ä»¥åçš„æ‰€æœ‰å­—ç¬¦ä¸²,å¦‚æ²¡æœ‰â€™.â€™,åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²). å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var path = require(&apos;path&apos;);</div><div class="line">var data = path.extname(&apos;index.html&apos;);</div><div class="line">console.log(data);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;.html&apos;</div></pre></td></tr></table></figure>
<h2 id="è¯¾ç¨‹å°ç»“-3">è¯¾ç¨‹å°ç»“</h2><p>å¾ˆé«˜å…´æ‚¨å­¦å®Œäº†æœ¬èŠ‚è¯¾ç¨‹ï¼Œå…³äºpathçš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å°±å…ˆè®²åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœæ‚¨è¿˜æƒ³äº†è§£æ›´å¤šçš„è¯,å¯ä»¥å‚è€ƒä»¥ä¸‹åœ°å€ï¼š</p>
<p><a href="http://nodejs.cn/api/path" target="_blank" rel="external">http://nodejs.cn/api/path</a> </p>
<p><a href="http://nodeapi.ucdok.com/#/api/path.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/path.html</a></p>
<h1 id="å­—ç¬¦ä¸²è½¬æ¢_Query_Stringæ¨¡å—çš„åŸºæœ¬ä»‹ç»">å­—ç¬¦ä¸²è½¬æ¢ Query Stringæ¨¡å—çš„åŸºæœ¬ä»‹ç»</h1><p>Query Stringæ¨¡å—ç”¨äºå®ç°URLå‚æ•°å­—ç¬¦ä¸²ä¸å‚æ•°å¯¹è±¡ä¹‹é—´çš„äº’ç›¸è½¬æ¢ï¼Œæä¾›äº†â€stringifyâ€ã€â€parseâ€ç­‰ä¸€äº›å®ç”¨å‡½æ•°æ¥é’ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ï¼Œé€šè¿‡åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæ¥æ›´å¥½çš„åº”å¯¹å®é™…å¼€å‘ä¸­çš„æ¡ä»¶éœ€æ±‚ï¼Œå¯¹äºé€»è¾‘çš„å¤„ç†ä¹Ÿæä¾›äº†å¾ˆå¥½çš„å¸®åŠ©ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£å­¦ä¹ å®ƒå§ï¼</p>
<h2 id="stringifyå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">stringifyå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>stringifyå‡½æ•°çš„ä½œç”¨å°±æ˜¯åºåˆ—åŒ–å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å°†å¯¹è±¡ç±»å‹è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼ˆé»˜è®¤çš„åˆ†å‰²ç¬¦ï¼ˆâ€&amp;â€ï¼‰å’Œåˆ†é…ç¬¦ï¼ˆâ€=â€ï¼‰ï¼‰ï¼Œæœ¬èŠ‚å…ˆä»‹ç»å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼Œåœ¨ä¸‹ä¸€èŠ‚é‡Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ›¿æ¢é»˜è®¤åˆ†é…ç¬¦ï¼Œä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡ä»¥ä¸‹ä¾‹å­æ¥æ¸…æ¥šçš„è®¤è¯†ä¸€ä¸‹å§ï¼</p>
<blockquote>
<p>ä¾‹1ï¼šquerystring.stringify(â€œå¯¹è±¡â€)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var querystring= require(&apos;querystring&apos;);</div><div class="line">var result = querystring.stringify(&#123;foo:&apos;bar&apos;,cool:[&apos;xux&apos;, &apos;yys&apos;]&#125;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">foo=bar&amp;cool=xux&amp;cool=yys</div></pre></td></tr></table></figure>
<h2 id="stringifyå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•">stringifyå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•</h2><p>è¿™èŠ‚æˆ‘ä»¬æ¥å­¦ä¹ stringifyå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•ï¼Œä¸ŠèŠ‚æˆ‘ä»¬çŸ¥é“äº†å¯¹è±¡è¢«åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ä¹‹åé»˜è®¤æ˜¯é€šè¿‡åˆ†å‰²ç¬¦ï¼ˆâ€&amp;â€ï¼‰å’Œåˆ†é…ç¬¦ï¼ˆâ€=â€ï¼‰ç»„æˆçš„ï¼Œé‚£å¯ä¸å¯ä»¥æ”¹å˜å‘¢ï¼Œè¿™èŠ‚æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹ï¼Œæ˜¯å¦å¯ä»¥è‡ªå·±å»å®šä¹‰ç»„åˆç»“æœï¼Œçœ‹ä¸‹é¢çš„å°ä¾‹å­</p>
<blockquote>
<p>ä¾‹1ï¼šquerystring.stringify(â€œå¯¹è±¡â€ï¼Œâ€åˆ†éš”ç¬¦â€ï¼Œâ€åˆ†é…ç¬¦â€)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var querystring = require(&apos;querystring&apos;);</div><div class="line">var result = querystring.stringify(&#123;foo:&apos;bar&apos;,cool:[&apos;xux&apos;, &apos;yys&apos;]&#125;,&apos;*&apos;,&apos;$&apos;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;foo$bar*cool$xux*cool$yys&apos;</div></pre></td></tr></table></figure>
<h2 id="parseå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">parseå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>åˆšåˆšæˆ‘ä»¬å·²ç»å­¦ä¹ äº†stringifyå‡½æ•°çš„ä½œç”¨ï¼Œæ¥ä¸‹æ¥å°±æ¥å­¦ä¹ ååºåˆ—åŒ–å‡½æ•°â€”â€”parseå‡½æ•°ï¼Œparseå‡½æ•°çš„ä½œç”¨å°±æ˜¯ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆé»˜è®¤æ˜¯ç”±â€=â€ã€â€&amp;â€æ‹¼æ¥è€Œæˆï¼‰ï¼Œè½¬æ¢å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ç±»å‹ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<blockquote>
<p>ä¾‹1ï¼šquerystring.parse(â€œå­—ç¬¦ä¸²â€)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var querystring = require(&apos;querystring&apos;);</div><div class="line">var result = querystring.parse(&apos;foo=bar&amp;cool=xux&amp;cool=yys&apos;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; foo: &apos;bar&apos;, cool: [&apos;xux&apos;, &apos;yys&apos;]&#125;</div></pre></td></tr></table></figure>
<h2 id="parseå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•">parseå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•</h2><p>ç°åœ¨æˆ‘ä»¬å­¦ä¹ parseå‡½æ•°çš„æ‰©å±•ç”¨æ³•ï¼Œå’Œä¸ŠèŠ‚stringifyå‡½æ•°çš„å¤šå‚æ•°ç”¨æ³•ä¸åŒçš„æ˜¯ï¼Œparseå‡½æ•°å¯ä»¥æ ¹æ®ç”¨æˆ·æ‰€è‡ªå®šä¹‰çš„åˆ†å‰²ç¬¦ã€åˆ†é…ç¬¦æ¥ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œä»è€Œå¾—åˆ°ç›¸åº”çš„å¯¹è±¡ç»“æœ.å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<blockquote>
<p>ä¾‹1ï¼šquerystring.parse(â€œå­—ç¬¦ä¸²â€ï¼Œâ€åˆ†éš”ç¬¦â€ï¼Œâ€åˆ†é…ç¬¦â€)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var querystring = require(&apos;querystring&apos;);</div><div class="line">var result = querystring.parse(&apos;foo@bar$cool@xux$cool@yys&apos;,&apos;@&apos;,&apos;$&apos;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123; foo: &apos;&apos;, bar: &apos;cool&apos;, xux: &apos;cool&apos;, yys: &apos;&apos; &#125;</div></pre></td></tr></table></figure>
<h2 id="è¯¾ç¨‹å°ç»“-4">è¯¾ç¨‹å°ç»“</h2><p>å¾ˆé«˜å…´æ‚¨å­¦å®Œäº†æœ¬èŠ‚è¯¾ç¨‹ï¼Œå…³äºquerystringçš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å°±å…ˆè®²åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœæ‚¨è¿˜æƒ³äº†è§£æ›´å¤šçš„è¯,å¯ä»¥å‚è€ƒä»¥ä¸‹åœ°å€ï¼š</p>
<p><a href="http://nodejs.cn/api/querystring" target="_blank" rel="external">http://nodejs.cn/api/querystring</a><br><a href="http://nodeapi.ucdok.com/#/api/querystring.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/querystring.html</a></p>
<h1 id="å®ç”¨å·¥å…·_UTILæ¨¡å—çš„åŸºæœ¬ä»‹ç»">å®ç”¨å·¥å…· UTILæ¨¡å—çš„åŸºæœ¬ä»‹ç»</h1><p>å…³äºæ¨¡å—çš„å¦‚ä½•è®¿é—®å‰é¢å·²ç»è®²è¿°è¿‡äº†ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å®Œå…¨æŒæ¡äº†ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬æ¥å­¦ä¹ utilæ¨¡å—ã€‚utilæ¨¡å—å‘¢ï¼Œæ˜¯ä¸€ä¸ªNode.jsæ ¸å¿ƒæ¨¡å—ï¼Œæä¾›å¸¸ç”¨å‡½æ•°çš„é›†åˆï¼Œç”¨äºå¼¥è¡¥æ ¸å¿ƒJavaScriptçš„ä¸€äº›åŠŸèƒ½è¿‡äºç²¾ç®€çš„ä¸è¶³ã€‚å¹¶ä¸”è¿˜æä¾›äº†ä¸€ç³»åˆ—å¸¸ç”¨å·¥å…·ï¼Œç”¨æ¥å¯¹æ•°æ®çš„è¾“å‡ºå’ŒéªŒè¯ã€‚</p>
<h2 id="inspectå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">inspectå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>util.inspect(object,[showHidden],[depth],[colors])æ˜¯ä¸€ä¸ªå°†ä»»æ„å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•å’Œé”™è¯¯è¾“å‡ºã€‚å®ƒè‡³å°‘æ¥å—ä¸€ä¸ªå‚æ•°objectï¼Œå³è¦è½¬æ¢çš„å¯¹è±¡,æˆ‘ä»¬æ¥å­¦ä¹ å®ƒçš„ç®€å•ç”¨æ³•ã€‚ä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.inspect(object);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<h2 id="formatå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">formatå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>formatå‡½æ•°æ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå ä½ç¬¦çš„å­—ç¬¦ä¸²ã€‚æ¯ä¸€ä¸ªå ä½ç¬¦è¢«æ›¿æ¢ä¸ºä¸å…¶å¯¹åº”çš„è½¬æ¢åçš„å€¼ï¼Œæ”¯æŒçš„å ä½ç¬¦æœ‰ï¼šâ€%s(å­—ç¬¦ä¸²)â€ã€â€%d(æ•°å­—&lt;æ•´å‹å’Œæµ®ç‚¹å‹&gt;)â€ã€â€%j(JSON)â€ã€â€%(å•ç‹¬ä¸€ä¸ªç™¾åˆ†å·åˆ™ä¸ä½œä¸ºä¸€ä¸ªå‚æ•°)â€ã€‚</p>
<p>1ï¼šå¦‚æœå ä½ç¬¦æ²¡æœ‰ç›¸å¯¹åº”çš„å‚æ•°ï¼Œå ä½ç¬¦å°†ä¸ä¼šè¢«æ›¿æ¢.å¦‚ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.format(&apos;%s:%s&apos;, &apos;foo&apos;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;foo:%s&apos;</div></pre></td></tr></table></figure>
<p>2ï¼šå¦‚æœæœ‰å¤šä¸ªå‚æ•°å ä½ç¬¦ï¼Œé¢å¤–çš„å‚æ•°å°†ä¼šè°ƒç”¨util.inspect()è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚è¿™äº›å­—ç¬¦ä¸²è¢«è¿æ¥åœ¨ä¸€èµ·ï¼Œå¹¶ä¸”ä»¥ç©ºæ ¼åˆ†éš”ã€‚å¦‚ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.format(&apos;%s:%s&apos;, &apos;foo&apos;, &apos;bar&apos;, &apos;baz&apos;);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;foo:bar baz&apos;</div></pre></td></tr></table></figure>
<p>3ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªéæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šæŠŠæ‰€æœ‰çš„å‚æ•°è½¬æˆå­—ç¬¦ä¸²å¹¶ä»¥ç©ºæ ¼éš”å¼€æ‹¼æ¥åœ¨ä¸€å—ï¼Œè€Œä¸”è¿”å›è¯¥å­—ç¬¦ä¸²ã€‚å¦‚ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.format(1, 2, 3);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&apos;1 2 3&apos;</div></pre></td></tr></table></figure>
<h2 id="isArrayå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">isArrayå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>isArrayå‡½æ•°å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ•°ç»„ç±»å‹ï¼Œæ˜¯åˆ™è¿”å›ture,å¦åˆ™ä¸ºfalseã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.isArray(object);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<h2 id="isDateå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">isDateå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>isDateå‡½æ•°å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ—¥æœŸç±»å‹ï¼Œæ˜¯åˆ™è¿”å›ture,å¦åˆ™è¿”å›falseã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.isDate(object);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<h2 id="isRegExpå‡½æ•°çš„åŸºæœ¬ç”¨æ³•">isRegExpå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h2><p>isRegExpå‡½æ•°å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºæ­£åˆ™ç±»å‹ï¼Œæ˜¯åˆ™è¿”å›ture,å¦åˆ™è¿”å›falseã€‚è¯­æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var util = require(&apos;util&apos;);</div><div class="line">var result = util.isRegExp(object);</div><div class="line">console.log(result);</div></pre></td></tr></table></figure>
<h2 id="è¯¾ç¨‹å°ç»“-5">è¯¾ç¨‹å°ç»“</h2><p>å¾ˆé«˜å…´æ‚¨å­¦å®Œäº†æœ¬èŠ‚è¯¾ç¨‹ï¼Œå…³äºutilæ¨¡å—çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å°±å…ˆè®²åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœæ‚¨è¿˜æƒ³äº†è§£æ›´å¤šçš„è¯,å¯ä»¥å‚è€ƒä»¥ä¸‹åœ°å€ï¼š</p>
<p><a href="http://nodejs.cn/api/util" target="_blank" rel="external">http://nodejs.cn/api/util</a></p>
<p><a href="http://nodeapi.ucdok.com/#/api/util.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/util.html</a></p>
<h1 id="å­è¿›ç¨‹_child_processæ¨¡å—çš„åŸºæœ¬ä»‹ç»">å­è¿›ç¨‹ child_processæ¨¡å—çš„åŸºæœ¬ä»‹ç»</h1><p>ä¼—æ‰€å‘¨çŸ¥node.jsæ˜¯åŸºäºå•çº¿ç¨‹æ¨¡å‹æ¶æ„ï¼Œè¿™æ ·çš„è®¾è®¡å¯ä»¥å¸¦æ¥é«˜æ•ˆçš„CPUåˆ©ç”¨ç‡ï¼Œä½†æ˜¯æ— æ³•å´åˆ©ç”¨å¤šä¸ªæ ¸å¿ƒçš„CPUï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œnode.jsæä¾›äº†child_processæ¨¡å—ï¼Œé€šè¿‡å¤šè¿›ç¨‹æ¥å®ç°å¯¹å¤šæ ¸CPUçš„åˆ©ç”¨. child_processæ¨¡å—æä¾›äº†å››ä¸ªåˆ›å»ºå­è¿›ç¨‹çš„å‡½æ•°ï¼Œåˆ†åˆ«æ˜¯spawnï¼Œexecï¼ŒexecFileå’Œforkã€‚</p>
<h2 id="pawnå‡½æ•°çš„ç®€å•ç”¨æ³•">pawnå‡½æ•°çš„ç®€å•ç”¨æ³•</h2><p>spawnå‡½æ•°ç”¨ç»™å®šçš„å‘½ä»¤å‘å¸ƒä¸€ä¸ªå­è¿›ç¨‹ï¼Œåªèƒ½è¿è¡ŒæŒ‡å®šçš„ç¨‹åºï¼Œå‚æ•°éœ€è¦åœ¨åˆ—è¡¨ä¸­ç»™å‡ºã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var child_process = require(&apos;child_process&apos;);</div><div class="line">var child = child_process.spawn( command );</div><div class="line">child.stdout.on(&apos;data&apos;, function(data) &#123;</div><div class="line">  console.log(data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ‰§è¡Œå‘½ä»¤å¾—åˆ°è¿”å›ç»“æœï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°æ ‡å‡†è¾“å‡ºæµæ•°æ®äº†ã€‚</p>
<h2 id="execå‡½æ•°çš„ç®€å•ç”¨æ³•">execå‡½æ•°çš„ç®€å•ç”¨æ³•</h2><p>execä¹Ÿæ˜¯ä¸€ä¸ªåˆ›å»ºå­è¿›ç¨‹çš„å‡½æ•°ï¼Œä¸spawnå‡½æ•°ä¸åŒå®ƒå¯ä»¥ç›´æ¥æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯err, stdout , stderrï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>var child_process = require(â€˜child_processâ€™);<br>child_process.exec( command , function(err, stdout , stderr ) {<br>  console.log( stdout );<br>});<br>execå‡½æ•°å¯ä»¥ç›´æ¥æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå›è°ƒå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯err, stdout,stderrï¼Œéå¸¸æ–¹ä¾¿ç›´æ¥ä½¿ç”¨ï¼Œ</p>
<h2 id="execFileå‡½æ•°çš„ç®€å•ç”¨æ³•">execFileå‡½æ•°çš„ç®€å•ç”¨æ³•</h2><p>execFileå‡½æ•°ä¸execå‡½æ•°ç±»ä¼¼ï¼Œä½†execFileå‡½æ•°æ›´æ˜¾å¾—ç²¾ç®€ï¼Œå› ä¸ºå®ƒå¯ä»¥ç›´æ¥æ‰§è¡Œæ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var child_process = require(&apos;child_process&apos;);</div><div class="line">child_process.execFile( file , function(err, stdout , stderr ) &#123;</div><div class="line">  console.log( stdout );</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>execFileä¸spawnçš„å‚æ•°ç›¸ä¼¼ï¼Œä¹Ÿéœ€è¦åˆ†åˆ«æŒ‡å®šæ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°ï¼Œä½†å¯ä»¥æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸execçš„å›è°ƒå‡½æ•°ç›¸åŒã€‚</p>
<h2 id="execFileå‡½æ•°çš„ç®€å•ç”¨æ³•-1">execFileå‡½æ•°çš„ç®€å•ç”¨æ³•</h2><p>execFileå‡½æ•°ä¸execå‡½æ•°ç±»ä¼¼ï¼Œä½†execFileå‡½æ•°æ›´æ˜¾å¾—ç²¾ç®€ï¼Œå› ä¸ºå®ƒå¯ä»¥ç›´æ¥æ‰§è¡Œæ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var child_process = require(&apos;child_process&apos;);</div><div class="line">child_process.execFile( file , function(err, stdout , stderr ) &#123;</div><div class="line">  console.log( stdout );</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>execFileä¸spawnçš„å‚æ•°ç›¸ä¼¼ï¼Œä¹Ÿéœ€è¦åˆ†åˆ«æŒ‡å®šæ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°ï¼Œä½†å¯ä»¥æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¸execçš„å›è°ƒå‡½æ•°ç›¸åŒã€‚</p>
<h2 id="è¯¾ç¨‹å°ç»“-6">è¯¾ç¨‹å°ç»“</h2><p>æ­å–œä½ å­¦å®Œäº†æœ¬èŠ‚è¯¾ç¨‹ï¼Œå…³äºchild_processçš„å››ä¸ªå‡½æ•°çš„åŸºæœ¬ç®€å•ç”¨æ³•ï¼Œå°±å…ˆè®²åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœæ‚¨è¿˜æƒ³æ·±å…¥äº†è§£å­¦ä¹ çš„è¯,å¯ä»¥å‚è€ƒä»¥ä¸‹åœ°å€ï¼š</p>
<p><a href="http://nodejs.cn/api/child_process" target="_blank" rel="external">http://nodejs.cn/api/child_process</a><br><a href="http://nodeapi.ucdok.com/#/api/child_process.html" target="_blank" rel="external">http://nodeapi.ucdok.com/#/api/child_process.html</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>æ€»ç»“<a href="http://www.hubwiz.com/course/5359f6f6ec7452081a7873d8/" target="_blank" rel="external">http://www.hubwiz.com/course/5359f6f6ec]]>
    </summary>
    
      <category term="Nodejs" scheme="http://mzeht.com/tags/Nodejs/"/>
    
      <category term="Webå‰ç«¯" scheme="http://mzeht.com/categories/Web%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Nodejs" scheme="http://mzeht.com/categories/Web%E5%89%8D%E7%AB%AF/Nodejs/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Android project from eclipes to androidstudio]]></title>
    <link href="http://mzeht.com/2016/02/25/eclipes-to-androidstudio/"/>
    <id>http://mzeht.com/2016/02/25/eclipes-to-androidstudio/</id>
    <published>2016-02-25T06:55:23.000Z</published>
    <updated>2016-11-27T10:24:52.000Z</updated>
    <content type="html"><![CDATA[<h2 id="jaråŒ…å†²çª">jaråŒ…å†²çª</h2><blockquote>
<p>Error:Execution failed for task â€˜:app:transformResourcesWithMergeJavaResForDebugâ€™.<br>com.android.build.api.transform.TransformException: com.android.builder.packaging.DuplicateFileException: Duplicate files copied in APK META-INF/LICENSE.txt<br>      File1: /Users/wpmac/AndroidStudioProjects/Android_XinJiang/app/libs/httpmime-4.1.1.jar<br>      File2: /Users/wpmac/AndroidStudioProjects/Android_XinJiang/app/libs/commons-codec-1.4.jar</p>
</blockquote>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">packagingOptions &#123;</div><div class="line">     exclude &apos;META-INF/DEPENDENCIES&apos;</div><div class="line">     exclude &apos;META-INF/NOTICE&apos;</div><div class="line">     exclude &apos;META-INF/LICENSE&apos;</div><div class="line">     exclude &apos;META-INF/LICENSE.txt&apos;</div><div class="line">     exclude &apos;META-INF/NOTICE.txt&apos;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="å›¾ç‰‡èµ„æºæŠ¥é”™">å›¾ç‰‡èµ„æºæŠ¥é”™</h2><blockquote>
<p>AAPT: /Users/wpmac/AndroidStudioProjects/Android_JieQian/app/src/main/res/drawable-xhdpi/suspected_association_normal.png: libpng warning: iCCP: Not recognizing known sRGB profile that has been edited<br>AAPT err(Facade for 203993302) : No Delegate set : lost message:/Users/wpmac/AndroidStudioProjects/Android_JieQian/app/src/main/res/drawable-xhdpi/register_info_normal.png: libpng warning: iCCP: Not recognizing known sRGB profile that has been edited<br>AAPT: /Users/wpmac/AndroidStudioProjects/Android_JieQian/app/src/main/res/drawable-xxhdpi/attention_pressed.png: libpng warning: iCCP: Not recognizing known sRGB profile that has been edited<br>AAPT: /Users/wpmac/AndroidStudioProjects/Android_JieQian/app/src/main/res/drawable-hdpi/splash_imageview.png: libpng warning: iCCP: Not recognizing known sRGB profile that has been edited<br>AAPT: /Users/wpmac/AndroidStudioProjects/Android_JieQian/app/src/main/res/drawable-xhdpi/province_select.png: libpng warning: iCCP: Not recognizing known sRGB profile that has been edited</p>
</blockquote>
<p>buildtools 23.0.2  warning: iCCP: Not recognizing known sRGB profile that has been edited</p>
<p>21.1.1 no warning   iCCP: Not recognizing known sRGB profile that has been edited</p>
<p>not a png file :check png file </p>
]]></content>
    <summary type="html">
    <![CDATA[<h2 id="jaråŒ…å†²çª">jaråŒ…å†²çª</h2><blockquote>
<p>Error:Execution failed for task â€˜:app:transformResourcesWithMergeJavaResForDebugâ€™.<br>com.android]]>
    </summary>
    
      <category term="debug" scheme="http://mzeht.com/tags/debug/"/>
    
      <category term="å·¥å…·" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="IDE" scheme="http://mzeht.com/categories/%E5%B7%A5%E5%85%B7/IDE/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Meterial design for developer]]></title>
    <link href="http://mzeht.com/2016/02/14/Meterial-design-for-developer/"/>
    <id>http://mzeht.com/2016/02/14/Meterial-design-for-developer/</id>
    <published>2016-02-14T13:05:35.000Z</published>
    <updated>2016-11-27T10:25:14.000Z</updated>
    <content type="html"><![CDATA[<h1 id="å…¥é—¨æŒ‡å—">å…¥é—¨æŒ‡å—</h1><p>å¦‚æœè¦ä½¿ç”¨ææ–™è®¾è®¡åˆ›å»ºåº”ç”¨ï¼š</p>
<ol>
<li>è¯·æŸ¥é˜…ææ–™<a href="http://www.google.com/design/spec/material-design/introduction.html" target="_blank" rel="external">è®¾è®¡è§„èŒƒ</a>ã€‚<ul>
<li>åœ¨æ‚¨çš„åº”ç”¨ä¸­ä½¿ç”¨ææ–™ä¸»é¢˜ã€‚</li>
<li>éµå¾ªææ–™è®¾è®¡æŒ‡å¯¼æ–¹é’ˆåˆ›å»ºæ‚¨çš„å¸ƒå±€ã€‚</li>
<li>æŒ‡å®šæ‚¨è§†å›¾è¦æŠ•å°„é˜´å½±çš„é«˜åº¦ã€‚</li>
<li>ä½¿ç”¨ç³»ç»Ÿå°ç»„ä»¶å‘ˆç°åˆ—è¡¨ä¸å¡ç‰‡ã€‚</li>
<li>å®šåˆ¶æ‚¨çš„åº”ç”¨ä¸­çš„åŠ¨ç”»ã€‚</li>
</ul>
</li>
</ol>
<p>ä¿æŒåå‘å…¼å®¹æ€§</p>
<p>æ‚¨å¯å°†å¤šä¸ªææ–™è®¾è®¡åŠŸèƒ½æ·»åŠ è‡³æ‚¨çš„åº”ç”¨ï¼ŒåŒæ—¶ä¿æŒä¸ Android 5.0 ä¹‹å‰çš„ Android ç‰ˆæœ¬çš„å…¼å®¹æ€§ã€‚ å¦‚æœè¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… ä¿æŒå…¼å®¹æ€§ã€‚</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1 id="å…¥é—¨æŒ‡å—">å…¥é—¨æŒ‡å—</h1><p>å¦‚æœè¦ä½¿ç”¨ææ–™è®¾è®¡åˆ›å»ºåº”ç”¨ï¼š</p>
<ol>
<li>è¯·æŸ¥é˜…ææ–™<a href="http://www.google.com/design/spec/material-design/introduction.html" tar]]>
    </summary>
    
      <category term="Meterial design" scheme="http://mzeht.com/tags/Meterial-design/"/>
    
      <category term="ç§»åŠ¨å¼€å‘" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/"/>
    
      <category term="Android" scheme="http://mzeht.com/categories/%E7%A7%BB%E5%8A%A8%E5%BC%80%E5%8F%91/Android/"/>
    
  </entry>
  
</feed>